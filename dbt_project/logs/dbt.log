[0m16:16:31.259586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc91144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc82585e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc8258640>]}


============================== 16:16:31.276981 | 97444c2b-60e5-425c-8e02-103b3cbb4406 ==============================
[0m16:16:31.276981 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:16:31.279978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:16:31.282450 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:16:31.286376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.2018816, "process_in_blocks": "1104", "process_kernel_time": 0.261041, "process_mem_max_rss": "86824", "process_out_blocks": "1032", "process_user_time": 3.443733}
[0m16:16:31.289139 [debug] [MainThread]: Command `dbt run` failed at 16:16:31.288825 after 0.21 seconds
[0m16:16:31.291235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc91144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc82dedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc82de6d0>]}
[0m16:16:31.293366 [debug] [MainThread]: Flushing usage events
[0m16:16:31.994315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:01.536008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282d3a90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e3520>]}


============================== 16:18:01.544445 | 8fefea58-ff38-49b5-9b55-d2cf12126baa ==============================
[0m16:18:01.544445 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:18:01.547708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:18:01.550004 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:18:01.553014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.12771562, "process_in_blocks": "0", "process_kernel_time": 0.089798, "process_mem_max_rss": "85984", "process_out_blocks": "0", "process_user_time": 3.023216}
[0m16:18:01.555422 [debug] [MainThread]: Command `dbt run` failed at 16:18:01.554975 after 0.13 seconds
[0m16:18:01.557616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282d3a90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e34c0>]}
[0m16:18:01.559682 [debug] [MainThread]: Flushing usage events
[0m16:18:02.594803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:58:41.203074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb898163490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8972a6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8972a6760>]}


============================== 07:58:41.216538 | af9c79f8-1977-4ccf-8532-3d6969a95277 ==============================
[0m07:58:41.216538 [info ] [MainThread]: Running with dbt=1.9.3
[0m07:58:41.219653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:58:41.221562 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m07:58:41.226388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.12589283, "process_in_blocks": "256", "process_kernel_time": 0.219928, "process_mem_max_rss": "86476", "process_out_blocks": "1032", "process_user_time": 3.328914}
[0m07:58:41.228134 [debug] [MainThread]: Command `dbt run` failed at 07:58:41.227810 after 0.13 seconds
[0m07:58:41.229626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb898163490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb897274100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8972ec460>]}
[0m07:58:41.231248 [debug] [MainThread]: Flushing usage events
[0m07:58:41.969512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:59:14.345098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c8748070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882bb0>]}


============================== 07:59:14.349845 | 465fedd8-288c-4292-bec5-9c8d4c421c79 ==============================
[0m07:59:14.349845 [info ] [MainThread]: Running with dbt=1.9.3
[0m07:59:14.351606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:59:14.353631 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m07:59:14.356205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08240086, "process_in_blocks": "0", "process_kernel_time": 0.06018, "process_mem_max_rss": "85856", "process_out_blocks": "0", "process_user_time": 1.965887}
[0m07:59:14.357891 [debug] [MainThread]: Command `dbt run` failed at 07:59:14.357676 after 0.08 seconds
[0m07:59:14.358996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c8748070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882c10>]}
[0m07:59:14.360097 [debug] [MainThread]: Flushing usage events
[0m07:59:15.033777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:22.931291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf557e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46baa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46baa60>]}


============================== 08:10:22.935994 | 9dd4aebc-08ea-4897-86f9-68aab2822564 ==============================
[0m08:10:22.935994 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:10:22.937673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:10:22.945073 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:10:22.947300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11184042, "process_in_blocks": "0", "process_kernel_time": 0.169592, "process_mem_max_rss": "85568", "process_out_blocks": "0", "process_user_time": 1.995211}
[0m08:10:22.948484 [debug] [MainThread]: Command `dbt run` failed at 08:10:22.948338 after 0.11 seconds
[0m08:10:22.949363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf557e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46d88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46d87c0>]}
[0m08:10:22.950270 [debug] [MainThread]: Flushing usage events
[0m08:10:23.648070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:14:26.874962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00989dd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b19a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b19a60>]}


============================== 08:14:26.879281 | f6f388fe-f19c-4b28-99ad-223fe2885ec6 ==============================
[0m08:14:26.879281 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:14:26.880943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:14:26.887545 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:14:26.889699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09300243, "process_in_blocks": "0", "process_kernel_time": 0.221808, "process_mem_max_rss": "85672", "process_out_blocks": "0", "process_user_time": 2.318908}
[0m08:14:26.890805 [debug] [MainThread]: Command `dbt run` failed at 08:14:26.890619 after 0.09 seconds
[0m08:14:26.891656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00989dd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b378e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b377c0>]}
[0m08:14:26.892531 [debug] [MainThread]: Flushing usage events
[0m08:14:27.583189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:33.185575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cca7db0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc99179a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc9917a00>]}


============================== 08:21:33.190094 | 4c1a89ae-186d-49bd-85da-8cb3497754bc ==============================
[0m08:21:33.190094 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:21:33.193002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:21:33.201757 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:21:33.204359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11525663, "process_in_blocks": "0", "process_kernel_time": 0.231786, "process_mem_max_rss": "85736", "process_out_blocks": "0", "process_user_time": 2.378335}
[0m08:21:33.205738 [debug] [MainThread]: Command `dbt run` failed at 08:21:33.205538 after 0.12 seconds
[0m08:21:33.206835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cca7db0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc99512b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ccb777c70>]}
[0m08:21:33.208111 [debug] [MainThread]: Flushing usage events
[0m08:21:33.908795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:59.705122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1813661070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181279da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181279daf0>]}


============================== 08:27:59.710776 | 40ecb776-a9d4-48ac-b588-b29d0bb40bcd ==============================
[0m08:27:59.710776 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:27:59.712579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:27:59.721709 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:27:59.724280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11375926, "process_in_blocks": "0", "process_kernel_time": 0.302217, "process_mem_max_rss": "85760", "process_out_blocks": "0", "process_user_time": 2.458032}
[0m08:27:59.725559 [debug] [MainThread]: Command `dbt run` failed at 08:27:59.725343 after 0.12 seconds
[0m08:27:59.726573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1813661070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1812aea9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1812827670>]}
[0m08:27:59.727516 [debug] [MainThread]: Flushing usage events
[0m08:28:00.395052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:03.702290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c71fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c6338a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c6338a90>]}


============================== 08:30:03.706818 | f462f67b-3932-48ae-88bd-18edc1ce40d1 ==============================
[0m08:30:03.706818 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:30:03.708285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:30:03.714778 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:30:03.716943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09467641, "process_in_blocks": "0", "process_kernel_time": 0.177469, "process_mem_max_rss": "85660", "process_out_blocks": "0", "process_user_time": 1.725393}
[0m08:30:03.718105 [debug] [MainThread]: Command `dbt run` failed at 08:30:03.717943 after 0.10 seconds
[0m08:30:03.719047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c71fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c6379190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c63791c0>]}
[0m08:30:03.719953 [debug] [MainThread]: Flushing usage events
[0m08:30:04.454944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:44.473283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d2b75fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cbcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cbcb20>]}


============================== 08:37:44.477571 | 97f53369-3b7c-466b-aa6b-f21a99ab21c7 ==============================
[0m08:37:44.477571 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:37:44.479263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:37:44.485877 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:37:44.488686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09213368, "process_in_blocks": "0", "process_kernel_time": 0.100663, "process_mem_max_rss": "85700", "process_out_blocks": "0", "process_user_time": 1.852211}
[0m08:37:44.490034 [debug] [MainThread]: Command `dbt run` failed at 08:37:44.489832 after 0.09 seconds
[0m08:37:44.490925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d2b75fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cf60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cf6220>]}
[0m08:37:44.491802 [debug] [MainThread]: Flushing usage events
[0m08:37:45.122011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:58.779924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba91b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a5e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a5e790>]}


============================== 08:37:58.791816 | 6beca6c7-dd2c-4008-93cf-fe9bb8b979cb ==============================
[0m08:37:58.791816 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:37:58.794782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:37:58.804857 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:37:58.808661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.17422426, "process_in_blocks": "0", "process_kernel_time": 0.178302, "process_mem_max_rss": "86856", "process_out_blocks": "1032", "process_user_time": 3.338213}
[0m08:37:58.811449 [debug] [MainThread]: Command `dbt run` failed at 08:37:58.811048 after 0.18 seconds
[0m08:37:58.814074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba91b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a7aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a7aeb0>]}
[0m08:37:58.815784 [debug] [MainThread]: Flushing usage events
[0m08:37:59.564264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:38:17.929112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e852ae160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e843eb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e843eb640>]}


============================== 08:38:17.933843 | ae684d70-c5d7-4e8f-982a-23bbbed84e31 ==============================
[0m08:38:17.933843 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:38:17.936414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:38:17.944232 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:38:17.947078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.105101064, "process_in_blocks": "0", "process_kernel_time": 0.109691, "process_mem_max_rss": "85556", "process_out_blocks": "0", "process_user_time": 1.834835}
[0m08:38:17.948665 [debug] [MainThread]: Command `dbt run` failed at 08:38:17.948394 after 0.11 seconds
[0m08:38:17.949946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e852ae160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e843cea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8442b880>]}
[0m08:38:17.951561 [debug] [MainThread]: Flushing usage events
[0m08:38:18.599340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:45:22.585337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a33560d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a24929a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a2492a00>]}


============================== 08:45:22.589400 | 6c05b58e-be40-4550-9952-f4c2f8cfb129 ==============================
[0m08:45:22.589400 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:45:22.591177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:22.598960 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:45:22.601711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09697239, "process_in_blocks": "0", "process_kernel_time": 0.099321, "process_mem_max_rss": "85936", "process_out_blocks": "0", "process_user_time": 1.956633}
[0m08:45:22.603163 [debug] [MainThread]: Command `dbt run` failed at 08:45:22.603011 after 0.10 seconds
[0m08:45:22.604082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a33560d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a24cc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a42f3c70>]}
[0m08:45:22.604970 [debug] [MainThread]: Flushing usage events
[0m08:45:23.284753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:42.861048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdaf056400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae19a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae19a790>]}


============================== 08:57:42.868795 | 65f73dc8-f3da-4336-b2bc-053eddae32b5 ==============================
[0m08:57:42.868795 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:57:42.871029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:57:42.879319 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:57:42.882137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11071657, "process_in_blocks": "0", "process_kernel_time": 0.243418, "process_mem_max_rss": "87020", "process_out_blocks": "1032", "process_user_time": 2.363192}
[0m08:57:42.883822 [debug] [MainThread]: Command `dbt run` failed at 08:57:42.883535 after 0.11 seconds
[0m08:57:42.884996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdaf056400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae83f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae7f4be0>]}
[0m08:57:42.886177 [debug] [MainThread]: Flushing usage events
[0m08:57:43.550051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:02.006091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863e3a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862f0c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862f0c880>]}


============================== 08:59:02.013829 | 6af5ab16-9d77-42f3-a8f7-52945ef89b1b ==============================
[0m08:59:02.013829 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:59:02.015295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:59:02.125524 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m08:59:02.127262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86273ef70>]}
[0m08:59:02.129014 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m08:59:02.130205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86273ebe0>]}
[0m08:59:02.270270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8623f7df0>]}
[0m08:59:02.342371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8627205b0>]}
[0m08:59:02.344807 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:59:02.436338 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m08:59:02.440120 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:59:02.441738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862331eb0>]}
[0m08:59:03.488267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mi_proyecto_dbt
[0m08:59:03.496776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862fc5cd0>]}
[0m08:59:03.561863 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:59:03.568502 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:59:03.604332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8622c85b0>]}
[0m08:59:03.605569 [info ] [MainThread]: Found 433 macros
[0m08:59:03.606923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8622c8400>]}
[0m08:59:03.609523 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:59:03.611765 [debug] [MainThread]: Command end result
[0m08:59:03.646267 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:59:03.650120 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:59:03.657507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:59:03.659102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7357033, "process_in_blocks": "12760", "process_kernel_time": 0.198011, "process_mem_max_rss": "99060", "process_out_blocks": "1104", "process_user_time": 3.514696}
[0m08:59:03.660203 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:03.660062 after 1.74 seconds
[0m08:59:03.661141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863e3a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863cb5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8623230d0>]}
[0m08:59:03.662081 [debug] [MainThread]: Flushing usage events
[0m08:59:04.361259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:00.103368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249efb6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249e0f9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249e0f95e0>]}


============================== 09:06:00.111047 | 5fa34a31-a625-4012-85ab-8e10beb5b9f4 ==============================
[0m09:06:00.111047 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:06:00.113846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:06:00.380380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249daaaee0>]}
[0m09:06:00.456126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249da738e0>]}
[0m09:06:00.458302 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:00.539782 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:06:00.604086 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:06:00.605733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d321250>]}
[0m09:06:01.667691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mi_proyecto_dbt
[0m09:06:01.677227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d298100>]}
[0m09:06:01.745347 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:06:01.753174 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:06:01.771825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249cf262e0>]}
[0m09:06:01.772915 [info ] [MainThread]: Found 433 macros
[0m09:06:01.774313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249cf26280>]}
[0m09:06:01.777167 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:06:01.779357 [debug] [MainThread]: Command end result
[0m09:06:01.814013 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:06:01.818420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:06:01.825320 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m09:06:01.826932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9203933, "process_in_blocks": "0", "process_kernel_time": 0.278849, "process_mem_max_rss": "99056", "process_out_blocks": "0", "process_user_time": 4.152866}
[0m09:06:01.827937 [debug] [MainThread]: Command `dbt run` succeeded at 09:06:01.827796 after 1.92 seconds
[0m09:06:01.828809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249efb6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d7f84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249cf26eb0>]}
[0m09:06:01.829749 [debug] [MainThread]: Flushing usage events
[0m09:06:02.463655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:31.325590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63446be100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63437fca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63437fca90>]}


============================== 09:36:31.332826 | 3940f095-b91f-4bae-ab20-e8200814c0b3 ==============================
[0m09:36:31.332826 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:36:31.336186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:31.655679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3940f095-b91f-4bae-ab20-e8200814c0b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63457a80a0>]}
[0m09:36:31.760502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3940f095-b91f-4bae-ab20-e8200814c0b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6342fb3310>]}
[0m09:36:31.763281 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:36:31.968051 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:36:32.155710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:36:32.158048 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_temp.sql
[0m09:36:32.621139 [error] [MainThread]: Encountered an error:
Compilation Error in model avg_temp (models/avg_temp.sql)
  expected token ',', got 'string'
    line 2
      materialized='table'  -- o 'view', seg√∫n lo que necesites
[0m09:36:32.624936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4591527, "process_in_blocks": "288", "process_kernel_time": 0.393416, "process_mem_max_rss": "100332", "process_out_blocks": "0", "process_user_time": 4.912664}
[0m09:36:32.628079 [debug] [MainThread]: Command `dbt run` failed at 09:36:32.627671 after 1.46 seconds
[0m09:36:32.630654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63446be100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63422d46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63422d4820>]}
[0m09:36:32.634513 [debug] [MainThread]: Flushing usage events
[0m09:36:34.351638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:39:04.512538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b2b76490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1cba700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1cba760>]}


============================== 09:39:04.524839 | f0f31df6-9d0d-4a82-a94c-e99752aba4d7 ==============================
[0m09:39:04.524839 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:39:04.527754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select avg_temp', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:39:04.543444 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m09:39:04.547208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1528543, "process_in_blocks": "0", "process_kernel_time": 0.169306, "process_mem_max_rss": "87052", "process_out_blocks": "1032", "process_user_time": 2.449966}
[0m09:39:04.550333 [debug] [MainThread]: Command `dbt run` failed at 09:39:04.549369 after 0.16 seconds
[0m09:39:04.552927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b2b76490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b3b13580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1d42d30>]}
[0m09:39:04.555630 [debug] [MainThread]: Flushing usage events
[0m09:39:05.600491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:39.590486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdd11e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc25d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc25d5e0>]}


============================== 09:45:39.597971 | 72570eae-9c7b-43b8-9582-9c336f1a50ea ==============================
[0m09:45:39.597971 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:45:39.603293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:45:39.995671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72570eae-9c7b-43b8-9582-9c336f1a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb9837f0>]}
[0m09:45:40.127144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72570eae-9c7b-43b8-9582-9c336f1a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcde0c7f10>]}
[0m09:45:40.129874 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:45:40.370161 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:45:40.582309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:45:40.584521 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_temp.sql
[0m09:45:41.046751 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mi_proyecto_dbt.avg_temp' (models/avg_temp.sql) depends on a node named 'daily_weather' which was not found
[0m09:45:41.051518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6024543, "process_in_blocks": "200", "process_kernel_time": 0.37003, "process_mem_max_rss": "102524", "process_out_blocks": "0", "process_user_time": 5.020419}
[0m09:45:41.055131 [debug] [MainThread]: Command `dbt run` failed at 09:45:41.054907 after 1.61 seconds
[0m09:45:41.057468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdd11e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb1a6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb08d8b0>]}
[0m09:45:41.059678 [debug] [MainThread]: Flushing usage events
[0m09:45:42.297655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:18.715859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4f9d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c40d9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c40d99a0>]}


============================== 09:51:18.723251 | 27e032f6-9268-4034-b651-e4f115c03f5f ==============================
[0m09:51:18.723251 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:51:18.726194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select avg_temp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:51:18.737915 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m09:51:18.741036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.15560716, "process_in_blocks": "0", "process_kernel_time": 0.059823, "process_mem_max_rss": "85628", "process_out_blocks": "0", "process_user_time": 2.333129}
[0m09:51:18.744175 [debug] [MainThread]: Command `dbt run` failed at 09:51:18.743571 after 0.16 seconds
[0m09:51:18.746515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4f9d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4120190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4120a90>]}
[0m09:51:18.747960 [debug] [MainThread]: Flushing usage events
[0m09:51:19.813226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:10.521947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23269400d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325a7a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325a7a9d0>]}


============================== 10:00:10.528263 | c3c754ed-504f-4d44-b5b5-320edc9e66de ==============================
[0m10:00:10.528263 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:00:10.530733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select avg_temp', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:00:10.543499 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m10:00:10.547179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1464722, "process_in_blocks": "0", "process_kernel_time": 0.139476, "process_mem_max_rss": "85736", "process_out_blocks": "0", "process_user_time": 3.008702}
[0m10:00:10.549752 [debug] [MainThread]: Command `dbt run` failed at 10:00:10.549386 after 0.15 seconds
[0m10:00:10.552115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23269400d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325ab9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325a9a2e0>]}
[0m10:00:10.554992 [debug] [MainThread]: Flushing usage events
[0m10:00:11.478482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:23.525280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf73d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf65274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf6527460>]}


============================== 10:05:23.531563 | 8587bc7d-7fad-4d76-ab26-dee69acc6434 ==============================
[0m10:05:23.531563 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:05:23.535210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:05:24.035845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf84dbf70>]}
[0m10:05:24.169797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf5f21a60>]}
[0m10:05:24.172321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:05:24.336426 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:05:24.555818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:05:24.558294 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_temp.sql
[0m10:05:24.560700 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/sources.yml
[0m10:05:25.479416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4ed0eb0>]}
[0m10:05:25.701328 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:05:25.716663 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:05:25.762287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf65701c0>]}
[0m10:05:25.765262 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:05:25.769832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4ee1700>]}
[0m10:05:25.774390 [info ] [MainThread]: 
[0m10:05:25.776890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:05:25.783234 [info ] [MainThread]: 
[0m10:05:25.786761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:25.792243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:05:26.014898 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:05:26.016600 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:05:26.018002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:26.023671 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m10:05:26.026082 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:05:26.027879 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:05:26.029727 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:05:26.031670 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:05:26.033370 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m10:05:26.035953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:26.037822 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m10:05:26.039712 [info ] [MainThread]: 
[0m10:05:26.042284 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m10:05:26.046231 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m10:05:26.051794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6742857, "process_in_blocks": "2336", "process_kernel_time": 0.412087, "process_mem_max_rss": "112636", "process_out_blocks": "0", "process_user_time": 5.698866}
[0m10:05:26.055202 [debug] [MainThread]: Command `dbt run` failed at 10:05:26.054820 after 2.68 seconds
[0m10:05:26.058425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf73d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4b4fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4fec370>]}
[0m10:05:26.062757 [debug] [MainThread]: Flushing usage events
[0m10:05:27.081317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:50.525217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2536100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b1675a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b1675a90>]}


============================== 10:07:50.533586 | 573857a2-2223-4608-a4f2-9ae49fd1667d ==============================
[0m10:07:50.533586 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:07:50.537061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:07:50.836456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b107c5e0>]}
[0m10:07:50.936961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b34d4370>]}
[0m10:07:50.940125 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:07:51.083468 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:07:51.337204 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:07:51.339900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b1d7a670>]}
[0m10:07:53.863441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afde9130>]}
[0m10:07:54.064513 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:07:54.075723 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:07:54.106845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd8d5b0>]}
[0m10:07:54.108980 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:07:54.111294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd8a7f0>]}
[0m10:07:54.121989 [info ] [MainThread]: 
[0m10:07:54.125820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:07:54.128277 [info ] [MainThread]: 
[0m10:07:54.131623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:54.136032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:07:54.248314 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:07:54.250157 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:07:54.251895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:54.278584 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m10:07:54.282202 [debug] [ThreadPool]: On list_airflow: Close
[0m10:07:54.285793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:07:54.300190 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:07:54.301918 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:07:54.303559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:54.311414 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:07:54.318637 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:07:54.321070 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:07:54.330092 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m10:07:54.333728 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:07:54.335963 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:07:54.347101 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.349038 [debug] [MainThread]: On master: BEGIN
[0m10:07:54.351150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:54.357707 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:07:54.365493 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.368316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:54.379158 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m10:07:54.382608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd160d0>]}
[0m10:07:54.384434 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:54.386208 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.388372 [debug] [MainThread]: On master: BEGIN
[0m10:07:54.391230 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:07:54.394275 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.396276 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.397881 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.399819 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:07:54.401372 [debug] [MainThread]: On master: Close
[0m10:07:54.413152 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.415279 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:07:54.418085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_temp)
[0m10:07:54.420729 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.447261 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.464496 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.572389 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.591774 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.593696 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:07:54.595219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:07:54.602088 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m10:07:54.606230 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.608341 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather"  -- Usa la fuente declarada
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:07:54.666782 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.056 seconds
[0m10:07:54.680779 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.682458 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:07:54.685584 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:07:54.736859 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:07:54.739972 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.742490 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:07:54.749784 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:07:54.768157 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:07:54.781612 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.783952 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:07:54.787575 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m10:07:54.795405 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:07:54.801893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37af512e50>]}
[0m10:07:54.804469 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7745[0m in 0.38s]
[0m10:07:54.808664 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.814897 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.816946 [debug] [MainThread]: On master: BEGIN
[0m10:07:54.819146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:54.825811 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:07:54.830435 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.833264 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.835717 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.838040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:07:54.840391 [debug] [MainThread]: On master: Close
[0m10:07:54.842880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:54.844810 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.avg_temp' was properly closed.
[0m10:07:54.846759 [info ] [MainThread]: 
[0m10:07:54.849657 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:07:54.854005 [debug] [MainThread]: Command end result
[0m10:07:55.037280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:07:55.045085 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:07:55.065315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:07:55.067041 [info ] [MainThread]: 
[0m10:07:55.070977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:55.074771 [info ] [MainThread]: 
[0m10:07:55.078041 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:07:55.082710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.743715, "process_in_blocks": "2968", "process_kernel_time": 0.433107, "process_mem_max_rss": "115804", "process_out_blocks": "16", "process_user_time": 7.695213}
[0m10:07:55.084637 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:55.084349 after 4.75 seconds
[0m10:07:55.086284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2536100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b107c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd8d1f0>]}
[0m10:07:55.088032 [debug] [MainThread]: Flushing usage events
[0m10:07:56.078014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:59.839275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd287e58130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f949a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f94a00>]}


============================== 10:16:59.846297 | d2d7e925-b262-4d97-a9bc-4f0d8dd80805 ==============================
[0m10:16:59.846297 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:16:59.848606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select avg_temp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:59.859489 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m10:16:59.863664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.20280935, "process_in_blocks": "0", "process_kernel_time": 0.079806, "process_mem_max_rss": "86036", "process_out_blocks": "0", "process_user_time": 2.384215}
[0m10:16:59.866131 [debug] [MainThread]: Command `dbt run` failed at 10:16:59.865658 after 0.21 seconds
[0m10:16:59.868255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd287e58130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f7b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f7bb80>]}
[0m10:16:59.870023 [debug] [MainThread]: Flushing usage events
[0m10:17:01.060499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:30.193372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d7e234f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d6ef68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d6ef6880>]}


============================== 10:33:30.205170 | 361e14e0-c29e-458f-9694-8020b344869b ==============================
[0m10:33:30.205170 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:33:30.207451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:33:30.236268 [info ] [MainThread]: dbt version: 1.9.3
[0m10:33:30.238443 [info ] [MainThread]: python version: 3.9.21
[0m10:33:30.240779 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m10:33:30.243048 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m10:33:30.375038 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project/.dbt
[0m10:33:30.377549 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/.dbt/profiles.yml
[0m10:33:30.379854 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m10:33:30.382747 [info ] [MainThread]: adapter type: postgres
[0m10:33:30.385391 [info ] [MainThread]: adapter version: 1.9.0
[0m10:33:30.620457 [info ] [MainThread]: Configuration:
[0m10:33:30.623234 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:33:30.625623 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:33:30.627923 [info ] [MainThread]: Required dependencies:
[0m10:33:30.630443 [debug] [MainThread]: Executing "git --help"
[0m10:33:30.639740 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m10:33:30.644210 [info ] [MainThread]: Connection:
[0m10:33:30.648132 [info ] [MainThread]:   host: postgres
[0m10:33:30.651344 [info ] [MainThread]:   port: 5432
[0m10:33:30.653778 [info ] [MainThread]:   user: airflow
[0m10:33:30.656349 [info ] [MainThread]:   database: airflow
[0m10:33:30.658632 [info ] [MainThread]:   schema: pro_raw_api
[0m10:33:30.661843 [info ] [MainThread]:   connect_timeout: 10
[0m10:33:30.666062 [info ] [MainThread]:   role: None
[0m10:33:30.670131 [info ] [MainThread]:   search_path: None
[0m10:33:30.673831 [info ] [MainThread]:   keepalives_idle: 0
[0m10:33:30.676868 [info ] [MainThread]:   sslmode: None
[0m10:33:30.681655 [info ] [MainThread]:   sslcert: None
[0m10:33:30.685622 [info ] [MainThread]:   sslkey: None
[0m10:33:30.688091 [info ] [MainThread]:   sslrootcert: None
[0m10:33:30.690522 [info ] [MainThread]:   application_name: dbt
[0m10:33:30.692956 [info ] [MainThread]:   retries: 1
[0m10:33:30.697026 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:30.882209 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:33:30.936938 [debug] [MainThread]: Using postgres connection "debug"
[0m10:33:30.939164 [debug] [MainThread]: On debug: select 1 as id
[0m10:33:30.941327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:30.953323 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m10:33:30.966970 [debug] [MainThread]: On debug: Close
[0m10:33:30.972124 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:33:30.975501 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:33:30.978563 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m10:33:30.984222 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.9190235, "process_in_blocks": "80", "process_kernel_time": 0.28045, "process_mem_max_rss": "100628", "process_out_blocks": "1048", "process_user_time": 3.08496}
[0m10:33:30.988169 [debug] [MainThread]: Command `dbt debug` failed at 10:33:30.987971 after 0.92 seconds
[0m10:33:30.991555 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:33:30.994490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d7e234f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d6fef880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d69166d0>]}
[0m10:33:31.014136 [debug] [MainThread]: Flushing usage events
[0m10:33:32.901591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:39.553373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f1c020d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d40a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d40a60>]}


============================== 10:33:39.559352 | ec24c457-45be-4bb6-a101-2aa3cac2606c ==============================
[0m10:33:39.559352 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:33:39.562148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select avg_temp', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:33:39.962611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f074f6a0>]}
[0m10:33:40.070514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d7c040>]}
[0m10:33:40.073102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:40.217175 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:33:40.559491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:40.562680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:40.649354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efb48130>]}
[0m10:33:40.856147 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:33:40.868235 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:33:40.906275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efaf12b0>]}
[0m10:33:40.908706 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:33:40.910867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efaf1040>]}
[0m10:33:40.916533 [info ] [MainThread]: 
[0m10:33:40.919308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:40.921915 [info ] [MainThread]: 
[0m10:33:40.925632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:40.930540 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:33:41.012175 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:33:41.014984 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:33:41.016688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:41.024371 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m10:33:41.027956 [debug] [ThreadPool]: On list_airflow: Close
[0m10:33:41.031719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:33:41.045406 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:33:41.047222 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:33:41.048929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:41.054697 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:33:41.058233 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:33:41.061134 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:33:41.068503 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:33:41.072237 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:33:41.074450 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:33:41.085199 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.087230 [debug] [MainThread]: On master: BEGIN
[0m10:33:41.088925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:41.095204 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:33:41.097383 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.099641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:41.106294 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:33:41.110120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7ef312280>]}
[0m10:33:41.112453 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:41.114653 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.116602 [debug] [MainThread]: On master: BEGIN
[0m10:33:41.119367 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:33:41.122602 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.124411 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.126568 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.128949 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:41.130773 [debug] [MainThread]: On master: Close
[0m10:33:41.145565 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.148521 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:33:41.151070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_temp)
[0m10:33:41.153068 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.182240 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.193754 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.293471 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.304230 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.305813 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:33:41.307562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:41.313726 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m10:33:41.316795 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.318659 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather"  -- Usa la fuente declarada
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:33:41.361774 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.040 seconds
[0m10:33:41.374759 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.376609 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m10:33:41.378820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:41.385857 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.387478 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:33:41.389654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:41.427232 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:33:41.428966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.430459 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:33:41.436115 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:33:41.450687 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:33:41.464421 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.466929 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:33:41.475833 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m10:33:41.481732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:33:41.485992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f2d36730>]}
[0m10:33:41.488082 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7745[0m in 0.33s]
[0m10:33:41.490657 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.494627 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.496299 [debug] [MainThread]: On master: BEGIN
[0m10:33:41.498174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:41.505614 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:33:41.508254 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.510507 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.512826 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.515247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:41.517204 [debug] [MainThread]: On master: Close
[0m10:33:41.519717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:41.522604 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.avg_temp' was properly closed.
[0m10:33:41.524816 [info ] [MainThread]: 
[0m10:33:41.527544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m10:33:41.530900 [debug] [MainThread]: Command end result
[0m10:33:41.608275 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:33:41.618332 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:33:41.637773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:33:41.639931 [info ] [MainThread]: 
[0m10:33:41.642675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:41.644819 [info ] [MainThread]: 
[0m10:33:41.647309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:33:41.650925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.245675, "process_in_blocks": "0", "process_kernel_time": 0.24375, "process_mem_max_rss": "108628", "process_out_blocks": "72", "process_user_time": 3.879693}
[0m10:33:41.654685 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:41.654150 after 2.25 seconds
[0m10:33:41.659155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f1c020d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efafb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d7c040>]}
[0m10:33:41.664007 [debug] [MainThread]: Flushing usage events
[0m10:33:42.733891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:36:11.577503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b496050d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b48742a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b48742a60>]}


============================== 10:36:11.587634 | a5df247a-8dcd-4e56-8ad5-9625e9b187a6 ==============================
[0m10:36:11.587634 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:36:11.590200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select avg_hum', 'send_anonymous_usage_stats': 'True'}
[0m10:36:11.896603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b481526a0>]}
[0m10:36:12.040429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b4877f040>]}
[0m10:36:12.044088 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:36:12.211980 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:36:12.626894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:36:12.636278 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_hum.sql
[0m10:36:13.227602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b471b2130>]}
[0m10:36:13.403264 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:36:13.415442 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:36:13.446786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b49854940>]}
[0m10:36:13.449141 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m10:36:13.451713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b471e7100>]}
[0m10:36:13.456138 [info ] [MainThread]: 
[0m10:36:13.458442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:36:13.460854 [info ] [MainThread]: 
[0m10:36:13.464368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:36:13.468234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:36:13.534726 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:36:13.536700 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:36:13.538971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:13.547483 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m10:36:13.551135 [debug] [ThreadPool]: On list_airflow: Close
[0m10:36:13.562421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:36:13.575223 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:36:13.577116 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:36:13.578825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:13.585003 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:36:13.587922 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:36:13.591471 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:36:13.599936 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m10:36:13.603148 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:36:13.605350 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:36:13.616579 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.618608 [debug] [MainThread]: On master: BEGIN
[0m10:36:13.620433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:13.627028 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:36:13.629775 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.631965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:36:13.639678 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:36:13.643357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b4814af10>]}
[0m10:36:13.645133 [debug] [MainThread]: On master: ROLLBACK
[0m10:36:13.646746 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.648084 [debug] [MainThread]: On master: BEGIN
[0m10:36:13.650129 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:36:13.653038 [debug] [MainThread]: On master: COMMIT
[0m10:36:13.655583 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.658226 [debug] [MainThread]: On master: COMMIT
[0m10:36:13.660484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:13.662413 [debug] [MainThread]: On master: Close
[0m10:36:13.667936 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m10:36:13.669849 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m10:36:13.672496 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m10:36:13.674471 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m10:36:13.698481 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.714792 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m10:36:13.875876 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.889746 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.892186 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m10:36:13.894278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:36:13.901258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m10:36:13.903802 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.907996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  -- Usa la fuente declarada
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:36:13.954275 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.043 seconds
[0m10:36:13.970132 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.972993 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m10:36:13.975959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:36:14.027746 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:36:14.029510 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:14.031090 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:36:14.033801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:36:14.048127 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m10:36:14.058844 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:14.060731 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m10:36:14.062749 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m10:36:14.068648 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m10:36:14.073744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b468b8130>]}
[0m10:36:14.076353 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7745[0m in 0.40s]
[0m10:36:14.079231 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m10:36:14.083086 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:14.084728 [debug] [MainThread]: On master: BEGIN
[0m10:36:14.086210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:14.093628 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:36:14.097014 [debug] [MainThread]: On master: COMMIT
[0m10:36:14.099466 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:14.102022 [debug] [MainThread]: On master: COMMIT
[0m10:36:14.104458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:14.107798 [debug] [MainThread]: On master: Close
[0m10:36:14.111183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:14.113579 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.avg_hum' was properly closed.
[0m10:36:14.115446 [info ] [MainThread]: 
[0m10:36:14.117535 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m10:36:14.121497 [debug] [MainThread]: Command end result
[0m10:36:14.221089 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:36:14.230832 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:36:14.250002 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:36:14.251678 [info ] [MainThread]: 
[0m10:36:14.254254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:14.256755 [info ] [MainThread]: 
[0m10:36:14.259399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:36:14.263534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8200166, "process_in_blocks": "0", "process_kernel_time": 0.148276, "process_mem_max_rss": "115144", "process_out_blocks": "0", "process_user_time": 4.547155}
[0m10:36:14.266823 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:14.266397 after 2.82 seconds
[0m10:36:14.269247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b496050d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b495057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b49480b80>]}
[0m10:36:14.271601 [debug] [MainThread]: Flushing usage events
[0m10:36:15.306806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:22.190265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf311b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf2258a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf2258ac0>]}


============================== 11:12:22.197602 | 8e1a6854-d019-4a45-9978-716b014852ee ==============================
[0m11:12:22.197602 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:12:22.199124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select precip_day', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:12:22.410804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4212fd0>]}
[0m11:12:22.481294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf28bb070>]}
[0m11:12:22.483117 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:12:22.569558 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:12:22.774303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:12:22.775934 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/precip_day.sql
[0m11:12:22.777226 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/avg_temp.sql
[0m11:12:22.778495 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/avg_hum.sql
[0m11:12:23.172106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0caf100>]}
[0m11:12:23.317180 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:12:23.323535 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:12:23.341523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0c5d2b0>]}
[0m11:12:23.342854 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m11:12:23.344162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0caf430>]}
[0m11:12:23.347237 [info ] [MainThread]: 
[0m11:12:23.348591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:23.349750 [info ] [MainThread]: 
[0m11:12:23.351598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:23.353903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:12:23.402811 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:12:23.404319 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:12:23.405396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:23.412436 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m11:12:23.414812 [debug] [ThreadPool]: On list_airflow: Close
[0m11:12:23.421923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:12:23.430955 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:12:23.432129 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:12:23.433094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:23.437130 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:12:23.439503 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:12:23.440716 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:12:23.445052 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m11:12:23.447250 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:12:23.448320 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:12:23.454677 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.455791 [debug] [MainThread]: On master: BEGIN
[0m11:12:23.456680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:23.460142 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:12:23.461703 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.462735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:23.466241 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:12:23.468302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf19d1eb0>]}
[0m11:12:23.469285 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:23.470254 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.470962 [debug] [MainThread]: On master: BEGIN
[0m11:12:23.471934 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:12:23.473332 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.474517 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.475327 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.476241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:23.476937 [debug] [MainThread]: On master: Close
[0m11:12:23.479812 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m11:12:23.481379 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m11:12:23.482806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.precip_day)
[0m11:12:23.483872 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m11:12:23.553072 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.561925 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m11:12:23.612252 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.619718 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.621034 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m11:12:23.622192 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:12:23.629041 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:12:23.630991 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.632267 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m11:12:23.663606 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.030 seconds
[0m11:12:23.672243 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.673665 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m11:12:23.675491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:12:23.697853 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:12:23.699381 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.700648 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:12:23.707251 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m11:12:23.715922 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m11:12:23.722119 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.723529 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m11:12:23.725258 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m11:12:23.729095 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m11:12:23.732007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf017f670>]}
[0m11:12:23.733622 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.25s]
[0m11:12:23.735409 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m11:12:23.737819 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.738645 [debug] [MainThread]: On master: BEGIN
[0m11:12:23.739389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:23.742668 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:12:23.744237 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.745752 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.746873 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.748444 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:23.749953 [debug] [MainThread]: On master: Close
[0m11:12:23.751065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:23.751860 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m11:12:23.752771 [info ] [MainThread]: 
[0m11:12:23.753777 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:12:23.755337 [debug] [MainThread]: Command end result
[0m11:12:23.796011 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:12:23.800572 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:12:23.813497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:12:23.814411 [info ] [MainThread]: 
[0m11:12:23.815609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:23.816867 [info ] [MainThread]: 
[0m11:12:23.818124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:12:23.820183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7213558, "process_in_blocks": "0", "process_kernel_time": 0.269373, "process_mem_max_rss": "113488", "process_out_blocks": "0", "process_user_time": 2.723668}
[0m11:12:23.821441 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:23.821290 after 1.72 seconds
[0m11:12:23.822607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf311b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf3637ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf28bb070>]}
[0m11:12:23.823878 [debug] [MainThread]: Flushing usage events
[0m11:12:24.541277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:19.765860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68e2ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68d42e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68d42e610>]}


============================== 11:36:19.770108 | c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65 ==============================
[0m11:36:19.770108 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:36:19.771862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select max_wind', 'send_anonymous_usage_stats': 'True'}
[0m11:36:19.970090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68d449670>]}
[0m11:36:20.041829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68cb82af0>]}
[0m11:36:20.043703 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:36:20.129900 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:36:20.334537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:36:20.335829 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/max_wind.sql
[0m11:36:20.678852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be9fe80>]}
[0m11:36:20.792695 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:36:20.799738 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:36:20.817156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be88700>]}
[0m11:36:20.818369 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:36:20.819526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be88a90>]}
[0m11:36:20.821934 [info ] [MainThread]: 
[0m11:36:20.823284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:20.824345 [info ] [MainThread]: 
[0m11:36:20.826129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:36:20.828990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:36:20.868079 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:36:20.869708 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:36:20.870945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:20.875857 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m11:36:20.878498 [debug] [ThreadPool]: On list_airflow: Close
[0m11:36:20.886101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:36:20.894085 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:36:20.895325 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:36:20.896420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:20.900196 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:36:20.902315 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:36:20.903457 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:36:20.906637 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m11:36:20.908817 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:36:20.909753 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:36:20.916614 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.917665 [debug] [MainThread]: On master: BEGIN
[0m11:36:20.918528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:20.921948 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:36:20.923814 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.924849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:36:20.928262 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:36:20.930501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be808b0>]}
[0m11:36:20.931564 [debug] [MainThread]: On master: ROLLBACK
[0m11:36:20.932560 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.933330 [debug] [MainThread]: On master: BEGIN
[0m11:36:20.934310 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:36:20.935501 [debug] [MainThread]: On master: COMMIT
[0m11:36:20.936656 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.937481 [debug] [MainThread]: On master: COMMIT
[0m11:36:20.938708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:20.939518 [debug] [MainThread]: On master: Close
[0m11:36:20.942551 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:36:20.943845 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:36:20.945626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:36:20.946760 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:36:21.008106 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.017216 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:36:21.076121 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.084150 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.085143 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:36:21.086028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:21.089437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:36:21.091085 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.092412 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT MAX(wind_kph) AS max_wind
    FROM base
)

SELECT b.*
FROM base b
JOIN max_wind m ON b.wind_kph = m.max_wind
  );
  
[0m11:36:21.111448 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.018 seconds
[0m11:36:21.120246 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.121545 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:36:21.122916 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:36:21.144962 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:36:21.146390 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.147628 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:36:21.150186 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:36:21.158419 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:36:21.164626 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.166095 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:36:21.167642 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m11:36:21.171252 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:36:21.174089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68b381c70>]}
[0m11:36:21.175791 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 1[0m in 0.23s]
[0m11:36:21.177375 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:36:21.179813 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.180891 [debug] [MainThread]: On master: BEGIN
[0m11:36:21.181747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:21.185203 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:36:21.187766 [debug] [MainThread]: On master: COMMIT
[0m11:36:21.188766 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.189540 [debug] [MainThread]: On master: COMMIT
[0m11:36:21.190672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:21.191436 [debug] [MainThread]: On master: Close
[0m11:36:21.192493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:21.193336 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:36:21.194359 [info ] [MainThread]: 
[0m11:36:21.196100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:36:21.198361 [debug] [MainThread]: Command end result
[0m11:36:21.237182 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:36:21.241645 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:36:21.253962 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:36:21.254866 [info ] [MainThread]: 
[0m11:36:21.256189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:21.257481 [info ] [MainThread]: 
[0m11:36:21.258658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:36:21.260567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.577967, "process_in_blocks": "0", "process_kernel_time": 0.109662, "process_mem_max_rss": "113004", "process_out_blocks": "0", "process_user_time": 2.601985}
[0m11:36:21.261855 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:21.261656 after 1.58 seconds
[0m11:36:21.262852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68e2ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa690e51880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68e587d30>]}
[0m11:36:21.263846 [debug] [MainThread]: Flushing usage events
[0m11:36:21.947467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:06.097082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8076df9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8075f3c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8075f3c640>]}


============================== 11:37:06.102559 | d1f1b01f-468d-4e71-bf57-b71595e2aa0d ==============================
[0m11:37:06.102559 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:37:06.104196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select max_wind', 'send_anonymous_usage_stats': 'True'}
[0m11:37:06.337547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8075951c70>]}
[0m11:37:06.411915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80799ba8b0>]}
[0m11:37:06.413730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:37:06.497939 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:37:06.677332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:06.678585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:06.728783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d50130>]}
[0m11:37:06.843228 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:06.848971 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:06.867079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d76700>]}
[0m11:37:06.868556 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:37:06.869695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d769a0>]}
[0m11:37:06.872043 [info ] [MainThread]: 
[0m11:37:06.873545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:06.874874 [info ] [MainThread]: 
[0m11:37:06.876632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:37:06.879427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:37:06.920393 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:37:06.922807 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:37:06.925062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:06.930631 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m11:37:06.932964 [debug] [ThreadPool]: On list_airflow: Close
[0m11:37:06.940463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:37:06.949045 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:06.950303 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:37:06.951346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:06.954959 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:37:06.956790 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:06.957863 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:37:06.961153 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m11:37:06.963402 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:37:06.964441 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:37:06.972007 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.973043 [debug] [MainThread]: On master: BEGIN
[0m11:37:06.973882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:06.977451 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m11:37:06.978860 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.980143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:37:06.983534 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:37:06.985486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d4d1f0>]}
[0m11:37:06.986435 [debug] [MainThread]: On master: ROLLBACK
[0m11:37:06.987479 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.988260 [debug] [MainThread]: On master: BEGIN
[0m11:37:06.989359 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:37:06.990701 [debug] [MainThread]: On master: COMMIT
[0m11:37:06.991826 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.992918 [debug] [MainThread]: On master: COMMIT
[0m11:37:06.993903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:06.994777 [debug] [MainThread]: On master: Close
[0m11:37:06.997751 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:37:06.998873 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:37:07.000057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:37:07.001082 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:37:07.013026 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.017953 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:37:07.066559 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.073800 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.074856 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:37:07.075670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:07.079024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:37:07.080735 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.081831 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT MAX(wind_kph) AS max_wind
    FROM base
)

SELECT b.*
FROM base b
JOIN max_wind m ON b.wind_kph = m.max_wind
  );
  
[0m11:37:07.100308 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.017 seconds
[0m11:37:07.108966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.110435 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:37:07.111877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:07.116690 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.117993 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:37:07.119573 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:07.144732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:07.145988 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.147101 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:07.149903 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:37:07.159400 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:37:07.165539 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.166788 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:37:07.170980 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:37:07.174841 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:37:07.177728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8077ee2e50>]}
[0m11:37:07.179319 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 1[0m in 0.18s]
[0m11:37:07.180808 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:37:07.182950 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:07.183863 [debug] [MainThread]: On master: BEGIN
[0m11:37:07.184731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:07.188057 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:37:07.189664 [debug] [MainThread]: On master: COMMIT
[0m11:37:07.190684 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:07.191464 [debug] [MainThread]: On master: COMMIT
[0m11:37:07.192725 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:07.194241 [debug] [MainThread]: On master: Close
[0m11:37:07.196254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:07.197489 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:37:07.198459 [info ] [MainThread]: 
[0m11:37:07.199594 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m11:37:07.201380 [debug] [MainThread]: Command end result
[0m11:37:07.244128 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:07.250168 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:07.267561 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:37:07.269259 [info ] [MainThread]: 
[0m11:37:07.271332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:07.273756 [info ] [MainThread]: 
[0m11:37:07.276090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:37:07.279549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3109016, "process_in_blocks": "0", "process_kernel_time": 0.107261, "process_mem_max_rss": "108728", "process_out_blocks": "0", "process_user_time": 2.554773}
[0m11:37:07.281593 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:07.281292 after 1.31 seconds
[0m11:37:07.283302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8076df9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d50910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80750813d0>]}
[0m11:37:07.284949 [debug] [MainThread]: Flushing usage events
[0m11:37:07.989883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:46.569575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00f5e4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e722970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e7229d0>]}


============================== 11:37:46.573548 | 2d552c37-6dd8-4bd9-88ef-4b54dfec5a92 ==============================
[0m11:37:46.573548 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:37:46.575002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select max_wind', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:46.774115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e1299d0>]}
[0m11:37:46.846061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e700fa0>]}
[0m11:37:46.847715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:37:46.933870 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:37:47.121514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:47.122699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:47.174734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d552130>]}
[0m11:37:47.295845 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:47.302122 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:47.320000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d578880>]}
[0m11:37:47.321290 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:37:47.322307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d578c10>]}
[0m11:37:47.325004 [info ] [MainThread]: 
[0m11:37:47.326396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:47.327492 [info ] [MainThread]: 
[0m11:37:47.329260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:37:47.331952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:37:47.377059 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:37:47.378596 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:37:47.379886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:47.385766 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m11:37:47.388918 [debug] [ThreadPool]: On list_airflow: Close
[0m11:37:47.396802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:37:47.406964 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:47.408895 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:37:47.410519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:47.414940 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:37:47.416726 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:47.418387 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:37:47.422222 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m11:37:47.424915 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:37:47.426365 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:37:47.434232 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.435606 [debug] [MainThread]: On master: BEGIN
[0m11:37:47.436630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:47.440148 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:37:47.442371 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.443563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:37:47.446897 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:37:47.448819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d559b20>]}
[0m11:37:47.449756 [debug] [MainThread]: On master: ROLLBACK
[0m11:37:47.450910 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.452110 [debug] [MainThread]: On master: BEGIN
[0m11:37:47.453306 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:37:47.454611 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.455730 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.456587 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.457637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:47.458836 [debug] [MainThread]: On master: Close
[0m11:37:47.462058 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:37:47.463287 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:37:47.464572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:37:47.465580 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:37:47.477555 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.482904 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:37:47.537078 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.544183 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.545299 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:37:47.546224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:47.549606 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:37:47.552638 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.553800 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT MAX(wind_kph) AS max_wind
    FROM base
)

SELECT b.*
FROM base b
JOIN max_wind m ON b.wind_kph = m.max_wind
  );
  
[0m11:37:47.573691 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.019 seconds
[0m11:37:47.583881 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.585370 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:37:47.587083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:47.592513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.593941 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:37:47.595485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:47.625518 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:47.626740 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.627652 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:47.629830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:37:47.639457 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:37:47.646496 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.647634 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:37:47.650540 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:37:47.654791 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:37:47.657474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0106cde20>]}
[0m11:37:47.659294 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 1[0m in 0.19s]
[0m11:37:47.660619 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:37:47.662570 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.663458 [debug] [MainThread]: On master: BEGIN
[0m11:37:47.664183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:47.667737 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:37:47.669390 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.670480 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.671307 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.672287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:47.673181 [debug] [MainThread]: On master: Close
[0m11:37:47.675150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:47.676983 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:37:47.678127 [info ] [MainThread]: 
[0m11:37:47.679348 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:37:47.681017 [debug] [MainThread]: Command end result
[0m11:37:47.721953 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:47.727646 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:47.743464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:37:47.744586 [info ] [MainThread]: 
[0m11:37:47.746159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:47.747445 [info ] [MainThread]: 
[0m11:37:47.748804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:37:47.751291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2718109, "process_in_blocks": "0", "process_kernel_time": 0.100844, "process_mem_max_rss": "108264", "process_out_blocks": "0", "process_user_time": 2.430356}
[0m11:37:47.753899 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:47.753584 after 1.27 seconds
[0m11:37:47.755561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00f5e4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00f467d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00fb51eb0>]}
[0m11:37:47.757237 [debug] [MainThread]: Flushing usage events
[0m11:37:48.432232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:44.864950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0977080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb096845a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb096845a60>]}


============================== 11:38:44.869291 | 714ded9f-4387-4cc4-899c-de9da1e4a053 ==============================
[0m11:38:44.869291 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:38:44.870525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select max_wind', 'send_anonymous_usage_stats': 'True'}
[0m11:38:45.066359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095fd96a0>]}
[0m11:38:45.136337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb096882040>]}
[0m11:38:45.138524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:38:45.220874 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:38:45.409505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:45.411095 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_wind.sql
[0m11:38:45.740727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0952a1e20>]}
[0m11:38:45.857652 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:38:45.863476 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:38:45.880981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095680130>]}
[0m11:38:45.882161 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:38:45.883397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095651760>]}
[0m11:38:45.885960 [info ] [MainThread]: 
[0m11:38:45.887302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:45.888640 [info ] [MainThread]: 
[0m11:38:45.890360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:45.892269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:38:45.931551 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:38:45.932923 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:38:45.933938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:45.939327 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m11:38:45.942744 [debug] [ThreadPool]: On list_airflow: Close
[0m11:38:45.949983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:38:45.960526 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:38:45.961902 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:38:45.963024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:45.966768 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:38:45.968519 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:38:45.969674 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:38:45.973562 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m11:38:45.976105 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:38:45.977274 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:38:45.984096 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:45.985303 [debug] [MainThread]: On master: BEGIN
[0m11:38:45.986270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:45.989796 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:38:45.991177 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:45.992629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:38:45.995851 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:38:45.997683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095280130>]}
[0m11:38:45.998689 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:45.999647 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.000378 [debug] [MainThread]: On master: BEGIN
[0m11:38:46.001514 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:38:46.002815 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.003983 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.005113 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.006071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:46.006907 [debug] [MainThread]: On master: Close
[0m11:38:46.009702 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:38:46.010839 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:38:46.012022 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:38:46.013089 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:38:46.074957 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.083804 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:38:46.135238 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.143728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.144781 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:38:46.145726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:46.149169 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:38:46.151135 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.152328 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m11:38:46.174526 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.019 seconds
[0m11:38:46.183022 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.184469 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:38:46.186767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:46.191706 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.193014 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:38:46.194628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:38:46.219082 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:38:46.220368 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.221720 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:38:46.224447 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:38:46.232794 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:38:46.239255 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.240780 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:38:46.244472 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:38:46.248541 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:38:46.251436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09478bdc0>]}
[0m11:38:46.253206 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.24s]
[0m11:38:46.254869 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:38:46.257131 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.258048 [debug] [MainThread]: On master: BEGIN
[0m11:38:46.258841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:46.262060 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:38:46.264049 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.265188 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.266264 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.267798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:46.268835 [debug] [MainThread]: On master: Close
[0m11:38:46.269925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:46.271077 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:38:46.272489 [info ] [MainThread]: 
[0m11:38:46.274308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:38:46.276308 [debug] [MainThread]: Command end result
[0m11:38:46.314816 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:38:46.319111 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:38:46.332144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:38:46.333138 [info ] [MainThread]: 
[0m11:38:46.334328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:46.335701 [info ] [MainThread]: 
[0m11:38:46.336953 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:38:46.339420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5541111, "process_in_blocks": "0", "process_kernel_time": 0.100085, "process_mem_max_rss": "113672", "process_out_blocks": "0", "process_user_time": 2.74235}
[0m11:38:46.341275 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:46.341008 after 1.56 seconds
[0m11:38:46.342860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0977080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb097583b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095357310>]}
[0m11:38:46.344323 [debug] [MainThread]: Flushing usage events
[0m11:38:46.991870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:31.856745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78139a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812ae85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812ae8580>]}


============================== 11:56:31.861352 | 5f3120dd-6ed5-4aac-84e5-66d25039b217 ==============================
[0m11:56:31.861352 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:56:31.863052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select min_temp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:32.082178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812554430>]}
[0m11:56:32.153886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78124ea610>]}
[0m11:56:32.155732 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:56:32.239067 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:56:32.436103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:56:32.437329 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/min_temp.sql
[0m11:56:32.764984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7811562100>]}
[0m11:56:32.888484 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:56:32.896872 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:56:32.913443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78118d7730>]}
[0m11:56:32.914705 [info ] [MainThread]: Found 5 models, 1 source, 433 macros
[0m11:56:32.916055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7813c3d040>]}
[0m11:56:32.918763 [info ] [MainThread]: 
[0m11:56:32.920454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:32.921721 [info ] [MainThread]: 
[0m11:56:32.923751 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:56:32.926284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:56:32.977709 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:56:32.979062 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:56:32.980200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:32.988342 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m11:56:32.990908 [debug] [ThreadPool]: On list_airflow: Close
[0m11:56:33.000351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:56:33.014307 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:56:33.015767 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:56:33.016967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:33.021166 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:56:33.023067 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:56:33.024570 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:56:33.028150 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m11:56:33.030543 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:56:33.031869 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:56:33.039123 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.040362 [debug] [MainThread]: On master: BEGIN
[0m11:56:33.042143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:33.046184 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m11:56:33.048171 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.049316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:56:33.052626 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:56:33.054699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7811527520>]}
[0m11:56:33.055777 [debug] [MainThread]: On master: ROLLBACK
[0m11:56:33.056892 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.057881 [debug] [MainThread]: On master: BEGIN
[0m11:56:33.059367 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:56:33.061988 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.063235 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.064305 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.065511 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:56:33.066552 [debug] [MainThread]: On master: Close
[0m11:56:33.069929 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m11:56:33.071167 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m11:56:33.072364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.min_temp)
[0m11:56:33.073669 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m11:56:33.140110 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.150567 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m11:56:33.201595 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.209018 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.210044 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m11:56:33.210901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:56:33.215116 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m11:56:33.217203 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.218422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m11:56:33.239857 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.020 seconds
[0m11:56:33.248995 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.250432 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m11:56:33.251905 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:56:33.274455 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:56:33.275873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.277156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:56:33.280019 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:56:33.288364 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m11:56:33.294608 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.296140 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m11:56:33.297737 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m11:56:33.301450 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m11:56:33.304313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7810cfee80>]}
[0m11:56:33.306040 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.23s]
[0m11:56:33.307518 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m11:56:33.309763 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.310587 [debug] [MainThread]: On master: BEGIN
[0m11:56:33.311378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:33.314665 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:56:33.316260 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.317194 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.317945 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.318994 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:56:33.319787 [debug] [MainThread]: On master: Close
[0m11:56:33.320709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:33.322022 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.min_temp' was properly closed.
[0m11:56:33.323027 [info ] [MainThread]: 
[0m11:56:33.324573 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:56:33.326654 [debug] [MainThread]: Command end result
[0m11:56:33.372962 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:56:33.377896 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:56:33.391938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:56:33.393022 [info ] [MainThread]: 
[0m11:56:33.394446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:33.395755 [info ] [MainThread]: 
[0m11:56:33.397630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:33.400949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6363599, "process_in_blocks": "0", "process_kernel_time": 0.139162, "process_mem_max_rss": "115368", "process_out_blocks": "0", "process_user_time": 2.723602}
[0m11:56:33.402663 [debug] [MainThread]: Command `dbt run` succeeded at 11:56:33.402385 after 1.64 seconds
[0m11:56:33.404651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78139a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7813816730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78121f9f40>]}
[0m11:56:33.406094 [debug] [MainThread]: Flushing usage events
[0m11:56:34.079665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:43.364162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26968f51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695a33940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695a339a0>]}


============================== 13:29:43.371552 | 7b8db37a-f0f2-40b4-a643-c8502a90d760 ==============================
[0m13:29:43.371552 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:29:43.373984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select max_temp_summer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:43.684483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269673d4f0>]}
[0m13:29:43.782142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695ab9ac0>]}
[0m13:29:43.784824 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:29:43.974510 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:29:44.426203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:29:44.428664 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m13:29:44.430956 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/sources.yml
[0m13:29:45.174822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269419e130>]}
[0m13:29:45.372251 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:29:45.385289 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:29:45.423506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2694898820>]}
[0m13:29:45.426069 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m13:29:45.428184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695111c70>]}
[0m13:29:45.431936 [info ] [MainThread]: 
[0m13:29:45.433967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:45.436683 [info ] [MainThread]: 
[0m13:29:45.440172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:45.444879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:29:45.608412 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:29:45.610379 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:29:45.611977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:45.625583 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:29:45.629199 [debug] [ThreadPool]: On list_airflow: Close
[0m13:29:45.639728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m13:29:45.651100 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:29:45.653104 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m13:29:45.655012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:45.661347 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:29:45.664224 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:29:45.666534 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m13:29:45.675107 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m13:29:45.678895 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m13:29:45.681375 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m13:29:45.694107 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.696397 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.698485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:45.705079 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:29:45.708042 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.710978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:29:45.718649 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:29:45.721828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26941fe280>]}
[0m13:29:45.723836 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:45.726154 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.727928 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.730551 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:29:45.733083 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.736071 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.738237 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.741353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:29:45.743244 [debug] [MainThread]: On master: Close
[0m13:29:45.748882 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.750608 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m13:29:45.752687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_temp_summer)
[0m13:29:45.754403 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.773823 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.794309 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.883521 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.900593 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.902798 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m13:29:45.904918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:45.911732 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:29:45.914952 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.917580 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM date) AS year,
        MAX(temp_max) AS max_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM b.date) = m.year
    AND b.temp_max = m.max_temp
  );
  
[0m13:29:45.924563 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function pg_catalog.date_part(unknown, text) does not exist
LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:29:45.941961 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m13:29:45.949766 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m13:29:45.966290 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  function pg_catalog.date_part(unknown, text) does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:29:45.970459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2694d88550>]}
[0m13:29:45.972683 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.22s]
[0m13:29:45.975845 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.978314 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  function pg_catalog.date_part(unknown, text) does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m13:29:45.982072 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.983782 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.985246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:45.990609 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:29:45.993344 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.996015 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.998470 [debug] [MainThread]: On master: COMMIT
[0m13:29:46.002081 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:29:46.005626 [debug] [MainThread]: On master: Close
[0m13:29:46.008045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:46.009989 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_temp_summer' was properly closed.
[0m13:29:46.014618 [info ] [MainThread]: 
[0m13:29:46.018619 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m13:29:46.023158 [debug] [MainThread]: Command end result
[0m13:29:46.142440 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:29:46.152324 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:29:46.174240 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:29:46.176205 [info ] [MainThread]: 
[0m13:29:46.178526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:29:46.180621 [info ] [MainThread]: 
[0m13:29:46.183090 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  function pg_catalog.date_part(unknown, text) does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:29:46.185692 [info ] [MainThread]: 
[0m13:29:46.188916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:29:46.194048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.966617, "process_in_blocks": "432", "process_kernel_time": 0.480688, "process_mem_max_rss": "113656", "process_out_blocks": "0", "process_user_time": 4.376269}
[0m13:29:46.197224 [debug] [MainThread]: Command `dbt run` failed at 13:29:46.196593 after 2.97 seconds
[0m13:29:46.202095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26968f51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695ab9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2696dcc340>]}
[0m13:29:46.205573 [debug] [MainThread]: Flushing usage events
[0m13:29:47.202177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:51.247583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46eff100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4603d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4603da30>]}


============================== 13:31:51.255031 | 967a7b87-fce8-498e-8171-ccef9953b6d9 ==============================
[0m13:31:51.255031 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:31:51.257442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select max_temp_summer', 'send_anonymous_usage_stats': 'True'}
[0m13:31:51.685225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b45782b20>]}
[0m13:31:51.818417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46559dc0>]}
[0m13:31:51.821173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:51.971384 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:31:52.407402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:31:52.410718 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m13:31:53.082926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b44a60130>]}
[0m13:31:53.286517 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:31:53.304060 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:31:53.341545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4714e940>]}
[0m13:31:53.343963 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m13:31:53.346082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4714e790>]}
[0m13:31:53.350114 [info ] [MainThread]: 
[0m13:31:53.353361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:53.356043 [info ] [MainThread]: 
[0m13:31:53.360156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:53.363951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:31:53.443086 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:31:53.445316 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:31:53.447203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:53.454560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m13:31:53.457901 [debug] [ThreadPool]: On list_airflow: Close
[0m13:31:53.468160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m13:31:53.480060 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:31:53.481673 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m13:31:53.483179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:53.488724 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:31:53.490985 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:31:53.493349 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m13:31:53.500484 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m13:31:53.503848 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m13:31:53.505450 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m13:31:53.516825 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.518970 [debug] [MainThread]: On master: BEGIN
[0m13:31:53.520915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:53.527219 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:31:53.530594 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.533077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:53.539714 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:31:53.594776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b44a76310>]}
[0m13:31:53.596968 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:53.599196 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.601057 [debug] [MainThread]: On master: BEGIN
[0m13:31:53.603754 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:31:53.607189 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.609781 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.611830 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.614748 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:53.616734 [debug] [MainThread]: On master: Close
[0m13:31:53.621916 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.623834 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m13:31:53.625949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_temp_summer)
[0m13:31:53.628252 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.648208 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.664515 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.775376 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.789751 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.792527 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m13:31:53.794949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:31:53.803134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:31:53.807436 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.809819 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temp_max) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temp_max = m.max_temp
  );
  
[0m13:31:53.814284 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "temp_max" does not exist
LINE 23:         MAX(temp_max) AS max_temp
                     ^

[0m13:31:53.819705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m13:31:53.831928 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m13:31:53.841522 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "temp_max" does not exist
  LINE 23:         MAX(temp_max) AS max_temp
                       ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:31:53.846127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b470bbeb0>]}
[0m13:31:53.848622 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.22s]
[0m13:31:53.851771 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.854402 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "temp_max" does not exist
  LINE 23:         MAX(temp_max) AS max_temp
                       ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m13:31:53.858368 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.860299 [debug] [MainThread]: On master: BEGIN
[0m13:31:53.861840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:53.868117 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:31:53.873167 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.876963 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.878839 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.880910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:53.883038 [debug] [MainThread]: On master: Close
[0m13:31:53.886552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:53.889499 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_temp_summer' was properly closed.
[0m13:31:53.891531 [info ] [MainThread]: 
[0m13:31:53.894014 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m13:31:53.897671 [debug] [MainThread]: Command end result
[0m13:31:53.971735 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:31:53.979355 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:31:54.004337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:31:54.006332 [info ] [MainThread]: 
[0m13:31:54.009330 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:31:54.011913 [info ] [MainThread]: 
[0m13:31:54.015054 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "temp_max" does not exist
  LINE 23:         MAX(temp_max) AS max_temp
                       ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:31:54.018381 [info ] [MainThread]: 
[0m13:31:54.022377 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:31:54.027099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9366298, "process_in_blocks": "0", "process_kernel_time": 0.282415, "process_mem_max_rss": "113184", "process_out_blocks": "0", "process_user_time": 4.538814}
[0m13:31:54.029945 [debug] [MainThread]: Command `dbt run` failed at 13:31:54.029615 after 2.94 seconds
[0m13:31:54.032379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46eff100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b470b0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b45a83a30>]}
[0m13:31:54.035887 [debug] [MainThread]: Flushing usage events
[0m13:31:55.207909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:58.447524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bdc6b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcda8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcda8a90>]}


============================== 13:32:58.456929 | c91831f1-5c92-4dd9-9b4a-53048cde92bf ==============================
[0m13:32:58.456929 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:32:58.460544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select max_temp_summer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:58.786356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc529bb0>]}
[0m13:32:58.914926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc58d6d0>]}
[0m13:32:58.917590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:59.066973 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:32:59.392590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:59.395047 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m13:33:00.000831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb560130>]}
[0m13:33:00.212852 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:33:00.226876 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:33:00.261183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb99acd0>]}
[0m13:33:00.263332 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m13:33:00.265501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb99a0a0>]}
[0m13:33:00.269770 [info ] [MainThread]: 
[0m13:33:00.273610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:00.276108 [info ] [MainThread]: 
[0m13:33:00.279713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:00.285200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:33:00.371204 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:33:00.373665 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:33:00.375630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:00.384823 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m13:33:00.388649 [debug] [ThreadPool]: On list_airflow: Close
[0m13:33:00.402793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m13:33:00.419447 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:33:00.421786 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m13:33:00.424009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:00.432683 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:33:00.436494 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:33:00.439952 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m13:33:00.449163 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m13:33:00.453711 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m13:33:00.456431 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m13:33:00.480494 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.483627 [debug] [MainThread]: On master: BEGIN
[0m13:33:00.486143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:00.494615 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:33:00.497228 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.503433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:00.512589 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:33:00.617873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb59f9d0>]}
[0m13:33:00.622272 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:00.625426 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.627799 [debug] [MainThread]: On master: BEGIN
[0m13:33:00.630676 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:33:00.634275 [debug] [MainThread]: On master: COMMIT
[0m13:33:00.638258 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.641224 [debug] [MainThread]: On master: COMMIT
[0m13:33:00.644134 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:00.646377 [debug] [MainThread]: On master: Close
[0m13:33:00.653013 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:00.655763 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m13:33:00.658708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_temp_summer)
[0m13:33:00.661015 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:00.690469 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.702326 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:00.808410 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.817905 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.819656 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m13:33:00.821269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:00.827301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:33:00.831840 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.833782 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m13:33:00.925932 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.090 seconds
[0m13:33:00.940837 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.943388 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m13:33:00.946434 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:33:00.995504 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m13:33:00.997634 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.999627 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m13:33:01.003073 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:33:01.019099 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m13:33:01.032128 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:01.034059 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m13:33:01.036743 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:33:01.043210 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m13:33:01.049737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bed9f130>]}
[0m13:33:01.052859 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.39s]
[0m13:33:01.055875 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:01.060146 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:01.061878 [debug] [MainThread]: On master: BEGIN
[0m13:33:01.063496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:01.069159 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:33:01.071530 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.074329 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:01.076471 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.078944 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:01.081622 [debug] [MainThread]: On master: Close
[0m13:33:01.084793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:01.086457 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_temp_summer' was properly closed.
[0m13:33:01.088081 [info ] [MainThread]: 
[0m13:33:01.090093 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m13:33:01.093047 [debug] [MainThread]: Command end result
[0m13:33:01.179280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:33:01.188538 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:33:01.211781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:33:01.213642 [info ] [MainThread]: 
[0m13:33:01.216594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:01.219972 [info ] [MainThread]: 
[0m13:33:01.222264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:33:01.226136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9372945, "process_in_blocks": "0", "process_kernel_time": 0.251008, "process_mem_max_rss": "115408", "process_out_blocks": "0", "process_user_time": 4.648675}
[0m13:33:01.229438 [debug] [MainThread]: Command `dbt run` succeeded at 13:33:01.228888 after 2.94 seconds
[0m13:33:01.232944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bdc6b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb94c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb94cac0>]}
[0m13:33:01.235225 [debug] [MainThread]: Flushing usage events
[0m13:33:02.275743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:24:49.903166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb8e170a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb7f5a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb7f5a550>]}


============================== 06:24:49.913088 | d404546c-0a23-44a2-a383-4c100b57365d ==============================
[0m06:24:49.913088 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:24:49.916303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:24:50.358993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb7f328e0>]}
[0m06:24:50.494639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb73d01c0>]}
[0m06:24:50.498041 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:24:50.681989 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:24:51.187140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:24:51.188460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:24:51.272347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6b1bf10>]}
[0m06:24:51.444940 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:24:51.453822 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:24:51.491668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6b06ac0>]}
[0m06:24:51.493714 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:24:51.495729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb93845e0>]}
[0m06:24:51.501753 [info ] [MainThread]: 
[0m06:24:51.504528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:24:51.506412 [info ] [MainThread]: 
[0m06:24:51.508561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:24:51.520091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:24:51.597672 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:24:51.599158 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:24:51.600312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:51.618002 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m06:24:51.621268 [debug] [ThreadPool]: On list_airflow: Close
[0m06:24:51.625422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_pro_raw_api'
[0m06:24:51.646709 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:24:51.648326 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:24:51.651434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:51.656564 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:24:51.658505 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:24:51.659986 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:24:51.671168 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m06:24:51.674226 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:24:51.675872 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:24:51.689088 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.690538 [debug] [MainThread]: On master: BEGIN
[0m06:24:51.691792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:24:51.696588 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:24:51.698163 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.699547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:24:51.708364 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:24:51.710636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6b3c7f0>]}
[0m06:24:51.712120 [debug] [MainThread]: On master: ROLLBACK
[0m06:24:51.713492 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.714444 [debug] [MainThread]: On master: BEGIN
[0m06:24:51.715809 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:24:51.717325 [debug] [MainThread]: On master: COMMIT
[0m06:24:51.718557 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.719847 [debug] [MainThread]: On master: COMMIT
[0m06:24:51.721168 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:51.722365 [debug] [MainThread]: On master: Close
[0m06:24:51.730444 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:24:51.733137 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:24:51.736008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:24:51.740841 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:24:51.763979 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.773672 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:24:51.872712 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.881128 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.882573 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:24:51.884128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:51.889460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:24:51.892261 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.893874 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:24:51.965102 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.070 seconds
[0m06:24:51.979136 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.981015 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:24:51.983138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:51.992554 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.994179 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:24:51.996302 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.045675 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:24:52.047070 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:52.048514 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:24:52.053349 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:24:52.065870 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:24:52.075857 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:52.077685 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:24:52.085397 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:24:52.092097 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:24:52.100046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6256c10>]}
[0m06:24:52.102257 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7745[0m in 0.36s]
[0m06:24:52.106082 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:24:52.108355 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.110629 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:24:52.113407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:24:52.115091 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.123626 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.131432 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.144380 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.153788 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.155417 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:24:52.157643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.163836 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:24:52.166286 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.167907 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:24:52.208928 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.039 seconds
[0m06:24:52.215898 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.217238 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:24:52.219065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.227014 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.228471 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:24:52.230340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.234275 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:24:52.235731 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.236933 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:24:52.240366 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:24:52.246537 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:24:52.248632 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.250032 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:24:52.253560 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:24:52.256265 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:24:52.258071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6240250>]}
[0m06:24:52.260099 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7745[0m in 0.14s]
[0m06:24:52.262392 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.263821 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.265413 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:24:52.267070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:24:52.268298 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.276951 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.283424 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.383566 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.394801 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.397013 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:24:52.398797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.407380 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:24:52.410052 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.411780 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:24:52.449505 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.036 seconds
[0m06:24:52.455434 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.456946 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:24:52.458940 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:52.466908 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.469199 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:24:52.471160 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.475151 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:24:52.476597 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.478407 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:24:52.481178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:24:52.488595 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:24:52.490995 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.493088 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:24:52.497903 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:24:52.502532 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:24:52.504896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5ee69d0>]}
[0m06:24:52.507710 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.24s]
[0m06:24:52.509887 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.510930 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:24:52.512204 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:24:52.513854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:24:52.515046 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:24:52.520489 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.525938 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:24:52.534545 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.540049 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.541326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:24:52.542553 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.547206 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:24:52.549058 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.550554 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:24:52.580288 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.028 seconds
[0m06:24:52.586312 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.587714 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:24:52.589389 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.596883 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.598181 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:24:52.599860 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.603528 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:24:52.605173 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.606776 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:24:52.610198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:24:52.616781 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:24:52.619310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.620823 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:24:52.624989 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:24:52.629219 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:24:52.631546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5ee69d0>]}
[0m06:24:52.634439 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.12s]
[0m06:24:52.637091 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:24:52.639657 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:24:52.643023 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:24:52.645430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:24:52.647059 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:24:52.653921 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.661049 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:24:52.668606 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.675659 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.676806 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:24:52.677997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.682763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:24:52.684695 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.686217 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:24:52.722722 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.035 seconds
[0m06:24:52.728206 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.729326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:24:52.730759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.736921 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.738213 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:24:52.739898 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.743810 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:24:52.745126 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.746422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:24:52.748612 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:24:52.754192 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:24:52.755984 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.757330 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:24:52.760623 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:24:52.763123 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:24:52.764830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5f0d0a0>]}
[0m06:24:52.766415 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.12s]
[0m06:24:52.768656 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:24:52.769874 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:24:52.771385 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:24:52.773319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:24:52.774738 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:24:52.781982 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.787914 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:24:52.796978 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.803968 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.805301 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:24:52.806491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.812102 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:24:52.813849 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.814970 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:24:52.834102 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.018 seconds
[0m06:24:52.842883 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.846326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:24:52.848631 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:52.866193 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.868099 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:24:52.873234 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.879719 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:24:52.882881 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.885827 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:24:52.894295 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:24:52.902805 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:24:52.906001 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.907970 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:24:52.916462 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m06:24:52.919773 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:24:52.921678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5fcb100>]}
[0m06:24:52.924367 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.15s]
[0m06:24:52.927317 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:24:52.930669 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:52.931971 [debug] [MainThread]: On master: BEGIN
[0m06:24:52.932898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:24:52.937458 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:24:52.939016 [debug] [MainThread]: On master: COMMIT
[0m06:24:52.940632 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:52.941765 [debug] [MainThread]: On master: COMMIT
[0m06:24:52.943337 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:52.944434 [debug] [MainThread]: On master: Close
[0m06:24:52.945578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:24:52.946672 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m06:24:52.947981 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:24:52.949237 [info ] [MainThread]: 
[0m06:24:52.950693 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m06:24:52.954026 [debug] [MainThread]: Command end result
[0m06:24:52.995843 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:24:53.001151 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:24:53.018614 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:24:53.019990 [info ] [MainThread]: 
[0m06:24:53.021625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:24:53.023461 [info ] [MainThread]: 
[0m06:24:53.025064 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:24:53.028682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3312457, "process_in_blocks": "84464", "process_kernel_time": 0.50893, "process_mem_max_rss": "110504", "process_out_blocks": "0", "process_user_time": 5.059945}
[0m06:24:53.030338 [debug] [MainThread]: Command `dbt run` succeeded at 06:24:53.030142 after 3.33 seconds
[0m06:24:53.031820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb8e170a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb72dbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6ac0f10>]}
[0m06:24:53.033252 [debug] [MainThread]: Flushing usage events
[0m06:24:53.829492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:02:30.861171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a706670d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6f7a6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6f7a65e0>]}


============================== 06:02:30.875216 | 06f85405-504b-4745-96a9-5f5f63ea027a ==============================
[0m06:02:30.875216 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:02:30.878847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.942826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a716049d0>]}
[0m06:02:32.204809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6ef40f70>]}
[0m06:02:32.210540 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:02:32.565564 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:02:33.476706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:02:33.479735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:02:33.645178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35bf40>]}
[0m06:02:34.031424 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:02:34.048282 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:02:34.138610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35bf70>]}
[0m06:02:34.141465 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:02:34.144856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a70b9a460>]}
[0m06:02:34.153106 [info ] [MainThread]: 
[0m06:02:34.156308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:02:34.159494 [info ] [MainThread]: 
[0m06:02:34.162777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:02:34.185825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:02:34.351789 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:02:34.354020 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:02:34.355968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:34.381420 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m06:02:34.388252 [debug] [ThreadPool]: On list_airflow: Close
[0m06:02:34.393538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:02:34.417588 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:02:34.420260 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:02:34.422113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:34.429437 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:02:34.432712 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:02:34.436961 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:02:34.455587 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m06:02:34.460250 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:02:34.462036 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:02:34.486574 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.488562 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.490416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:34.498055 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:02:34.501111 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.503863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:02:34.514436 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m06:02:34.519793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e365d60>]}
[0m06:02:34.522241 [debug] [MainThread]: On master: ROLLBACK
[0m06:02:34.524427 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.526054 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.528548 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:02:34.530952 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.540493 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.542536 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.544783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:34.546752 [debug] [MainThread]: On master: Close
[0m06:02:34.561248 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:02:34.563936 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:02:34.568586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:02:34.573477 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:02:34.611106 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.627419 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:02:34.809924 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.905458 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.907727 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:02:34.909880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:34.917984 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:02:34.920769 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.923090 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:02:35.064284 [debug] [Thread-1  ]: SQL status: SELECT 7750 in 0.139 seconds
[0m06:02:35.093828 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.097221 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:02:35.102849 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:02:35.114263 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.120309 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:02:35.123172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.206170 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:02:35.208740 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.210678 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:02:35.216529 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:02:35.241560 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:02:35.260450 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.271522 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:02:35.280973 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:02:35.292507 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:02:35.302370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6da96c10>]}
[0m06:02:35.305678 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7750[0m in 0.73s]
[0m06:02:35.309757 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:02:35.312105 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.314394 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:02:35.320538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:02:35.322434 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.334722 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.345453 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.360505 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.373209 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.375231 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:02:35.377006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:35.383591 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:02:35.387203 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.389721 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:02:35.508415 [debug] [Thread-1  ]: SQL status: SELECT 7750 in 0.116 seconds
[0m06:02:35.520653 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.522776 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:02:35.525301 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.536976 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.538652 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:02:35.540687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.544578 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:02:35.546344 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.547908 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:02:35.554569 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:02:35.563814 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:02:35.567558 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.570571 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:02:35.576177 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:02:35.579793 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:02:35.583082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6da81490>]}
[0m06:02:35.587536 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7750[0m in 0.26s]
[0m06:02:35.590639 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.592850 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.594946 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:02:35.597550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:02:35.601944 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.617352 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.629119 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.725011 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.738491 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.740939 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:02:35.743098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:35.754626 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m06:02:35.756716 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.758629 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:02:35.831170 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.070 seconds
[0m06:02:35.847587 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.854791 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:02:35.857738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.872685 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.875648 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:02:35.878740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.885658 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:02:35.889148 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.891253 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:02:35.895050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:02:35.906062 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:02:35.908902 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.911097 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:02:35.925798 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m06:02:35.931108 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:02:35.938109 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7259d0>]}
[0m06:02:35.941785 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.34s]
[0m06:02:35.945265 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.950985 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:02:35.955445 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:02:35.959176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:02:35.961700 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:02:35.974177 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:02:35.987359 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:02:36.003965 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.016299 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.019579 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:02:36.021720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:36.028505 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:02:36.030889 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.035952 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:02:36.102624 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.064 seconds
[0m06:02:36.116914 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.119341 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:02:36.121789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.133774 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.137074 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:02:36.139650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.143732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:02:36.145349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.147087 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:02:36.151723 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:02:36.158583 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:02:36.161096 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.162809 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:02:36.168454 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:02:36.173377 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:02:36.175725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7259d0>]}
[0m06:02:36.178015 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.22s]
[0m06:02:36.181048 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:02:36.185207 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:02:36.187625 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:02:36.190113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:02:36.192064 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:02:36.204622 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.216395 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:02:36.230973 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.243544 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.245714 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:02:36.248019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:36.256858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:02:36.259499 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.261717 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:02:36.327031 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.062 seconds
[0m06:02:36.337917 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.339613 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:02:36.342316 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.352523 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.354061 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:02:36.355939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:02:36.362577 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:02:36.365086 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.368162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:02:36.371853 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:02:36.384693 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:02:36.387845 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.390027 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:02:36.394420 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:02:36.397968 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:02:36.401819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7259d0>]}
[0m06:02:36.404742 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.21s]
[0m06:02:36.407880 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:02:36.409827 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:02:36.411928 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:02:36.414712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:02:36.418026 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:02:36.427289 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.444247 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:02:36.459895 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.473893 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.476084 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:02:36.477876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:36.485839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:02:36.488326 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.491211 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:02:36.519995 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.026 seconds
[0m06:02:36.528276 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.530109 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:02:36.532868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.545681 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.548749 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:02:36.552751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:02:36.557674 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:02:36.559543 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.560966 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:02:36.567317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m06:02:36.574550 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:02:36.576873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.578698 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:02:36.585339 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:02:36.591118 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:02:36.594368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7364f0>]}
[0m06:02:36.597609 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.18s]
[0m06:02:36.603628 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:02:36.608401 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:36.610213 [debug] [MainThread]: On master: BEGIN
[0m06:02:36.611559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:36.621354 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m06:02:36.623450 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.625179 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:36.626798 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.628585 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:36.630006 [debug] [MainThread]: On master: Close
[0m06:02:36.631854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:36.636377 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:02:36.638467 [info ] [MainThread]: 
[0m06:02:36.641623 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m06:02:36.647766 [debug] [MainThread]: Command end result
[0m06:02:36.758126 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:02:36.769595 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:02:36.850731 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:02:36.864541 [info ] [MainThread]: 
[0m06:02:36.871929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:36.874855 [info ] [MainThread]: 
[0m06:02:36.877388 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:02:36.885905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.358324, "process_in_blocks": "84160", "process_kernel_time": 1.857013, "process_mem_max_rss": "110384", "process_out_blocks": "0", "process_user_time": 9.084308}
[0m06:02:36.888931 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:36.888524 after 6.36 seconds
[0m06:02:36.891066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a706670d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35cd30>]}
[0m06:02:36.893243 [debug] [MainThread]: Flushing usage events
[0m06:02:37.585951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:43:32.928444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7394c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a72a906a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a72a90640>]}


============================== 06:43:32.941232 | 1bad2245-2d5a-4276-bbc4-0496107f6ba3 ==============================
[0m06:43:32.941232 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:43:32.945196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:34.133935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a74a36220>]}
[0m06:43:34.615152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a730eba30>]}
[0m06:43:34.679569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:43:35.043416 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:43:36.097394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:36.099305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:36.266875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7189bfa0>]}
[0m06:43:36.604714 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:43:36.618627 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:43:36.675707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a718db340>]}
[0m06:43:36.678167 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:43:36.681584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7318b460>]}
[0m06:43:36.689369 [info ] [MainThread]: 
[0m06:43:36.692310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:43:36.695396 [info ] [MainThread]: 
[0m06:43:36.698818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:36.716552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:43:36.859729 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:43:36.862936 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:43:36.865183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:36.888268 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m06:43:36.891552 [debug] [ThreadPool]: On list_airflow: Close
[0m06:43:36.900291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_pro_raw_api'
[0m06:43:36.924073 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:43:36.926999 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:43:36.929934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:36.942217 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:43:36.945610 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:43:36.947733 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:43:36.963555 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m06:43:36.968407 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:43:36.970782 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:43:36.989967 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:36.992162 [debug] [MainThread]: On master: BEGIN
[0m06:43:36.994041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:37.002343 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:43:37.004556 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:37.006934 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:37.016654 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:43:37.020295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a72188460>]}
[0m06:43:37.022447 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:37.024461 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:37.026116 [debug] [MainThread]: On master: BEGIN
[0m06:43:37.028637 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:43:37.030746 [debug] [MainThread]: On master: COMMIT
[0m06:43:37.032800 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:37.034496 [debug] [MainThread]: On master: COMMIT
[0m06:43:37.040745 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:43:37.045025 [debug] [MainThread]: On master: Close
[0m06:43:37.055519 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.057907 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:43:37.061130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:43:37.063768 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.092296 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.107695 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.264335 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.282012 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.284970 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:43:37.287491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:37.298032 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:43:37.300407 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.302864 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:43:37.414715 [debug] [Thread-1  ]: SQL status: SELECT 7755 in 0.110 seconds
[0m06:43:37.438237 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.440526 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:43:37.447802 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:43:37.458118 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.460297 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:43:37.463468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:37.554762 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:43:37.563755 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.566115 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:43:37.577136 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m06:43:37.597514 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:43:37.613890 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.616262 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:43:37.623821 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:43:37.632812 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:43:37.639638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70d98ca0>]}
[0m06:43:37.642601 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7755[0m in 0.57s]
[0m06:43:37.646973 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.649782 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.652165 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:43:37.655059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:43:37.657238 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.669011 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.679866 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.696034 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.708608 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.710942 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:43:37.713154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:37.722219 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:43:37.724880 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.726967 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:43:37.786465 [debug] [Thread-1  ]: SQL status: SELECT 7755 in 0.057 seconds
[0m06:43:37.798167 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.800346 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:43:37.803494 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:37.813668 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.815361 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:43:37.817521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:37.822804 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:43:37.824911 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.826905 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:43:37.835279 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m06:43:37.843019 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:43:37.846059 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.847687 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:43:37.853237 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:43:37.857855 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:43:37.860849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70d85250>]}
[0m06:43:37.863907 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7755[0m in 0.21s]
[0m06:43:37.867312 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.869652 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:37.872143 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:43:37.874640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:43:37.876454 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:37.889693 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:37.902454 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:37.993314 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.006806 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.009403 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:43:38.011982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.020566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:43:38.023721 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.026466 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:43:38.092984 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.063 seconds
[0m06:43:38.102091 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.103988 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:43:38.106691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.116847 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.119296 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:43:38.122163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:38.126123 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:43:38.128470 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.130771 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:43:38.134638 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:43:38.142269 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:43:38.145981 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.148023 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:43:38.152211 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:43:38.156198 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:43:38.158712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70c70190>]}
[0m06:43:38.161546 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.28s]
[0m06:43:38.164674 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:38.167256 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:43:38.169228 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:43:38.171496 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:43:38.173164 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:43:38.180864 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.191342 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:43:38.204360 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.214847 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.217381 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:43:38.219676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.227184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:43:38.229986 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.232157 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:43:38.277594 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.043 seconds
[0m06:43:38.287259 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.288999 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:43:38.291284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.298592 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.300167 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:43:38.302261 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:38.306347 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:43:38.308146 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.309850 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:43:38.319977 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m06:43:38.331059 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:43:38.334095 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.335794 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:43:38.344622 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:43:38.350006 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:43:38.352274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70c70190>]}
[0m06:43:38.354722 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.18s]
[0m06:43:38.357976 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:43:38.359820 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:43:38.362140 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:43:38.364353 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:43:38.366137 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:43:38.376239 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.385832 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:43:38.398180 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.407794 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.411392 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:43:38.415025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.428992 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m06:43:38.436310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.441115 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:43:38.579887 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.136 seconds
[0m06:43:38.618197 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.620664 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:43:38.623973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.638979 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.641092 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:43:38.643872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.652732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:43:38.655067 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.657216 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:43:38.661134 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:43:38.678273 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:43:38.682743 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.685694 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:43:38.691272 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:43:38.696974 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:43:38.702246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70c6c820>]}
[0m06:43:38.705810 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.34s]
[0m06:43:38.709115 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:43:38.711872 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:43:38.719426 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:43:38.722747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:43:38.724762 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:43:38.737377 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.752606 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:43:38.766242 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.779873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.782654 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:43:38.785236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.791384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:43:38.793735 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.797427 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:43:38.820358 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.020 seconds
[0m06:43:38.833916 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.835864 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:43:38.838422 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.850466 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.852566 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:43:38.855250 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.861020 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:43:38.864373 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.867315 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:43:38.876950 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m06:43:38.888629 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:43:38.891203 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.893080 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:43:38.902400 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:43:38.906418 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:43:38.908586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70d5fe80>]}
[0m06:43:38.911037 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.19s]
[0m06:43:38.914990 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:43:38.918469 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:38.920112 [debug] [MainThread]: On master: BEGIN
[0m06:43:38.921743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:38.929217 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:43:38.931658 [debug] [MainThread]: On master: COMMIT
[0m06:43:38.933359 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:38.935073 [debug] [MainThread]: On master: COMMIT
[0m06:43:38.937663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:38.939981 [debug] [MainThread]: On master: Close
[0m06:43:38.942083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:38.944432 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m06:43:38.946878 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:43:38.949240 [info ] [MainThread]: 
[0m06:43:38.951767 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m06:43:38.957601 [debug] [MainThread]: Command end result
[0m06:43:39.038122 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:43:39.050305 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:43:39.081020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:43:39.083002 [info ] [MainThread]: 
[0m06:43:39.085537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:39.088105 [info ] [MainThread]: 
[0m06:43:39.091297 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:43:39.096244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.458528, "process_in_blocks": "84264", "process_kernel_time": 0.88783, "process_mem_max_rss": "108180", "process_out_blocks": "0", "process_user_time": 8.545364}
[0m06:43:39.098660 [debug] [MainThread]: Command `dbt run` succeeded at 06:43:39.098366 after 6.46 seconds
[0m06:43:39.101253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7394c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a74a36220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a718982b0>]}
[0m06:43:39.103137 [debug] [MainThread]: Flushing usage events
[0m06:43:40.599899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:04.706970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e1dfefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e0f47af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e0f47b50>]}


============================== 11:09:04.714705 | 66b879ef-1471-47fc-a985-6582844c67c3 ==============================
[0m11:09:04.714705 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:09:04.716042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:09:04.966919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e096fe20>]}
[0m11:09:05.043507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e15e5760>]}
[0m11:09:05.045496 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:05.151508 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:09:05.467120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:05.468560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:05.521855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd5ae80>]}
[0m11:09:05.649097 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:09:05.654926 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:09:05.682501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd9b3d0>]}
[0m11:09:05.683724 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m11:09:05.685020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e05c07c0>]}
[0m11:09:05.688390 [info ] [MainThread]: 
[0m11:09:05.689714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:05.691127 [info ] [MainThread]: 
[0m11:09:05.693022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:05.701060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:09:05.790125 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:09:05.791532 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:09:05.792751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:05.850743 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.058 seconds
[0m11:09:05.853647 [debug] [ThreadPool]: On list_airflow: Close
[0m11:09:05.856928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:09:05.868379 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:09:05.869914 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:09:05.871105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:05.876141 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m11:09:05.878324 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:09:05.879768 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:09:05.890803 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m11:09:05.893705 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:09:05.895337 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:09:05.904014 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.904900 [debug] [MainThread]: On master: BEGIN
[0m11:09:05.905676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:05.910922 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:09:05.912293 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.913409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:09:05.921040 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m11:09:05.922889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd7b580>]}
[0m11:09:05.923776 [debug] [MainThread]: On master: ROLLBACK
[0m11:09:05.924616 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.925314 [debug] [MainThread]: On master: BEGIN
[0m11:09:05.926650 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:09:05.928434 [debug] [MainThread]: On master: COMMIT
[0m11:09:05.929563 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.930328 [debug] [MainThread]: On master: COMMIT
[0m11:09:05.931232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:05.931975 [debug] [MainThread]: On master: Close
[0m11:09:05.936197 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m11:09:05.937295 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m11:09:05.938541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m11:09:05.939504 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m11:09:05.951032 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m11:09:05.957329 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m11:09:06.006603 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.014761 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.015723 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m11:09:06.016616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.024339 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m11:09:06.025491 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.027048 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m11:09:06.153524 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.125 seconds
[0m11:09:06.162987 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.164469 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m11:09:06.167914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:09:06.172735 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.173949 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m11:09:06.175466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.204977 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m11:09:06.206226 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.207371 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m11:09:06.209957 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:09:06.218243 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m11:09:06.224352 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.225662 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m11:09:06.232208 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m11:09:06.235703 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m11:09:06.238322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df496b50>]}
[0m11:09:06.239764 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7760[0m in 0.30s]
[0m11:09:06.241423 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m11:09:06.242609 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.243945 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m11:09:06.245371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m11:09:06.246266 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.250517 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.255249 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.261684 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.266944 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.267917 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m11:09:06.268883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.275179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m11:09:06.276774 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.278016 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m11:09:06.313350 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.034 seconds
[0m11:09:06.318426 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.319854 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m11:09:06.321447 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.326407 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.328112 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m11:09:06.329868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.332720 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m11:09:06.333930 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.334889 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m11:09:06.341384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m11:09:06.346099 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m11:09:06.347651 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.348669 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m11:09:06.352546 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:09:06.354703 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m11:09:06.355971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df49be20>]}
[0m11:09:06.357318 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7760[0m in 0.11s]
[0m11:09:06.358956 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.361354 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.363033 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m11:09:06.365849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m11:09:06.366907 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.372430 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.379826 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.443398 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.453127 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.454517 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m11:09:06.455780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.461343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m11:09:06.463120 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.464723 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m11:09:06.508362 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.042 seconds
[0m11:09:06.513476 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.514615 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m11:09:06.516057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.520377 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.521451 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m11:09:06.522616 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.524750 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m11:09:06.525692 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.527150 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m11:09:06.529809 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:09:06.533947 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m11:09:06.535367 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.536245 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m11:09:06.539278 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:09:06.541200 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m11:09:06.542426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e1c90c10>]}
[0m11:09:06.544239 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.18s]
[0m11:09:06.546131 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.547424 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:09:06.548466 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:09:06.549723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m11:09:06.550685 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:09:06.555079 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.561168 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:09:06.567569 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.573236 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.574188 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:09:06.575007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.581853 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:09:06.583294 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.584458 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m11:09:06.636917 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.051 seconds
[0m11:09:06.644732 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.646596 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:09:06.648492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.653532 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.655156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:09:06.657257 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.661887 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:09:06.663691 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.664978 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:09:06.667730 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:09:06.671920 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:09:06.673555 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.674772 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:09:06.680181 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:09:06.682808 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:09:06.684248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df125970>]}
[0m11:09:06.685537 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.13s]
[0m11:09:06.687039 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:09:06.688077 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m11:09:06.689118 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m11:09:06.690366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m11:09:06.691518 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m11:09:06.696689 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.701705 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m11:09:06.707082 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.713163 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.714277 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m11:09:06.715344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.719848 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m11:09:06.721306 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.722476 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m11:09:06.772064 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.048 seconds
[0m11:09:06.779220 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.780478 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m11:09:06.782026 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.787668 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.789238 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m11:09:06.790923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.795410 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:09:06.797058 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.798626 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:09:06.803454 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m11:09:06.809860 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m11:09:06.811769 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.813119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m11:09:06.817141 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:09:06.819645 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m11:09:06.820904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df125970>]}
[0m11:09:06.822316 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.13s]
[0m11:09:06.823749 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m11:09:06.824754 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m11:09:06.825886 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m11:09:06.827379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m11:09:06.828492 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m11:09:06.833187 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.838428 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m11:09:06.843884 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.849544 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.850572 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m11:09:06.851445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.855416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m11:09:06.856927 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.858197 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m11:09:06.870417 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.011 seconds
[0m11:09:06.874978 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.876522 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m11:09:06.878642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.883552 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.884653 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m11:09:06.886086 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.888792 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:09:06.889871 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.890802 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:09:06.897334 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m11:09:06.902823 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m11:09:06.904694 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.905783 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m11:09:06.911122 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:09:06.913888 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m11:09:06.915252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df52d9a0>]}
[0m11:09:06.916619 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.09s]
[0m11:09:06.918575 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m11:09:06.921233 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:06.922423 [debug] [MainThread]: On master: BEGIN
[0m11:09:06.923485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:06.928067 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:09:06.929499 [debug] [MainThread]: On master: COMMIT
[0m11:09:06.930555 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:06.931503 [debug] [MainThread]: On master: COMMIT
[0m11:09:06.932694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:06.933910 [debug] [MainThread]: On master: Close
[0m11:09:06.935136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:06.936128 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m11:09:06.937293 [info ] [MainThread]: 
[0m11:09:06.938616 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m11:09:06.941550 [debug] [MainThread]: Command end result
[0m11:09:06.983184 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:09:06.988009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:09:07.000519 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:09:07.001460 [info ] [MainThread]: 
[0m11:09:07.002767 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:07.004174 [info ] [MainThread]: 
[0m11:09:07.005458 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:09:07.009239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4250338, "process_in_blocks": "0", "process_kernel_time": 1.068281, "process_mem_max_rss": "108748", "process_out_blocks": "0", "process_user_time": 3.416484}
[0m11:09:07.010558 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:07.010386 after 2.43 seconds
[0m11:09:07.011915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e1dfefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd450d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e15e5760>]}
[0m11:09:07.013001 [debug] [MainThread]: Flushing usage events
[0m11:09:07.847479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:33.803278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c27e56130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c26f996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c26f99640>]}


============================== 06:34:33.810218 | 7ddde0cb-058a-4bcd-9364-e87c25958b13 ==============================
[0m06:34:33.810218 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:34:33.812325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:34:34.240171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28f40220>]}
[0m06:34:34.410053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c275f4a30>]}
[0m06:34:34.412799 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:34.582970 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:34:35.138868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:35.140692 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:35.251465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25b5bfa0>]}
[0m06:34:35.503205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:34:35.514267 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:34:35.563579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25b9b340>]}
[0m06:34:35.565647 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:34:35.568018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c27694460>]}
[0m06:34:35.573137 [info ] [MainThread]: 
[0m06:34:35.574812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:34:35.576659 [info ] [MainThread]: 
[0m06:34:35.578670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:35.588440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:34:35.666575 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:34:35.667983 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:34:35.669328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:35.686645 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:34:35.689668 [debug] [ThreadPool]: On list_airflow: Close
[0m06:34:35.694248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:34:35.715970 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:34:35.754499 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:34:35.756790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:35.762255 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:34:35.763784 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:34:35.764979 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:34:35.777806 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m06:34:35.780373 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:34:35.781499 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:34:35.790610 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.791640 [debug] [MainThread]: On master: BEGIN
[0m06:34:35.792446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:35.795922 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:34:35.797332 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.798412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:35.803228 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:34:35.805909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c26389460>]}
[0m06:34:35.807199 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:35.808275 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.809199 [debug] [MainThread]: On master: BEGIN
[0m06:34:35.810372 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:35.811692 [debug] [MainThread]: On master: COMMIT
[0m06:34:35.812685 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.813535 [debug] [MainThread]: On master: COMMIT
[0m06:34:35.814617 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:35.815580 [debug] [MainThread]: On master: Close
[0m06:34:35.820218 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:34:35.821949 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:34:35.823785 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:34:35.824962 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:34:35.836249 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.842415 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:34:35.895926 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.901349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.902305 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:34:35.903336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:35.907714 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:35.909347 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.910499 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:34:35.965375 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.054 seconds
[0m06:34:35.975349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.976870 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:34:35.979329 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:35.984054 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.985186 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:34:35.986472 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.015846 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:34:36.016996 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:36.018053 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:34:36.022825 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.033072 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:34:36.040986 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:36.042367 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:34:36.047686 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:34:36.051441 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:34:36.055240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25272760>]}
[0m06:34:36.057100 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7760[0m in 0.23s]
[0m06:34:36.059264 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:34:36.060432 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.061453 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:34:36.062753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:34:36.063814 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.068686 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.076123 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.082024 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.087891 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.089563 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:34:36.090806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.094592 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:36.096033 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.096957 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:34:36.121356 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.023 seconds
[0m06:34:36.126470 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.127714 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:34:36.129194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.133704 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.134798 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:34:36.135932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.138904 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:34:36.140138 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.141066 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:34:36.144708 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:34:36.148642 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:34:36.149929 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.150800 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:34:36.153626 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.156438 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:34:36.157834 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28010e20>]}
[0m06:34:36.159304 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7760[0m in 0.10s]
[0m06:34:36.160841 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.161935 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.163056 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:34:36.164625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:34:36.165667 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.172190 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.177978 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.229788 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.236328 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.237893 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:34:36.240193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.244995 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:34:36.246513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.247973 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:34:36.275301 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.026 seconds
[0m06:34:36.280040 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.281323 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:34:36.282695 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.287178 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.288602 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:34:36.290205 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.292686 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:34:36.293604 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.294478 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:34:36.296254 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.300062 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:34:36.301441 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.302332 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:34:36.305581 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.308988 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:34:36.311960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28010e20>]}
[0m06:34:36.314832 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.15s]
[0m06:34:36.317499 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.322480 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:34:36.324105 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:34:36.326035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:34:36.327223 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:34:36.333499 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.342878 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:34:36.349226 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.355624 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.356941 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:34:36.358055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.362351 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:36.364039 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.365373 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:34:36.390585 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.024 seconds
[0m06:34:36.399408 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.400705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:34:36.402342 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.411137 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.412702 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:34:36.414548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:36.417415 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:34:36.418654 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.419909 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:34:36.423017 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.427699 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:34:36.429618 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.431003 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:34:36.434503 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.437784 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:34:36.440134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28010e20>]}
[0m06:34:36.442092 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.11s]
[0m06:34:36.444113 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:34:36.445555 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:34:36.447425 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:34:36.449713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:34:36.451255 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:34:36.458208 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.465444 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:34:36.474191 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.481332 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.482689 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:34:36.483980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.490119 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:34:36.491851 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.493439 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:34:36.523977 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.029 seconds
[0m06:34:36.530803 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.532103 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:34:36.534233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:36.541966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.543263 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:34:36.545169 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.548682 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:34:36.550004 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.551085 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:34:36.553050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.559129 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:34:36.560629 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.561576 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:34:36.564349 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.566596 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:34:36.567869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2532b730>]}
[0m06:34:36.569208 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.12s]
[0m06:34:36.570892 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:34:36.572489 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:34:36.573898 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:34:36.575230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:34:36.576311 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:34:36.580990 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.586588 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:34:36.593408 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.601948 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.603063 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:34:36.604207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.608569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:36.609976 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.611000 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:34:36.621456 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.009 seconds
[0m06:34:36.626638 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.627587 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:34:36.628691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.633135 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.634053 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:34:36.635168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.637554 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:34:36.638931 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.639880 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:34:36.643831 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:34:36.647735 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:34:36.649107 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.649942 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:34:36.653219 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.655874 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:34:36.657217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2532b730>]}
[0m06:34:36.658514 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.08s]
[0m06:34:36.660208 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:34:36.662484 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:36.663399 [debug] [MainThread]: On master: BEGIN
[0m06:34:36.664346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:36.667998 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:34:36.669294 [debug] [MainThread]: On master: COMMIT
[0m06:34:36.670216 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:36.671499 [debug] [MainThread]: On master: COMMIT
[0m06:34:36.673254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:36.674267 [debug] [MainThread]: On master: Close
[0m06:34:36.675428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:36.676377 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:34:36.677401 [info ] [MainThread]: 
[0m06:34:36.678624 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m06:34:36.681940 [debug] [MainThread]: Command end result
[0m06:34:36.727112 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:34:36.732773 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:34:36.751993 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:34:36.753198 [info ] [MainThread]: 
[0m06:34:36.756190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:36.757894 [info ] [MainThread]: 
[0m06:34:36.759443 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:34:36.762848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1195538, "process_in_blocks": "84160", "process_kernel_time": 0.612563, "process_mem_max_rss": "110104", "process_out_blocks": "0", "process_user_time": 5.143585}
[0m06:34:36.764468 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:36.764254 after 3.12 seconds
[0m06:34:36.765997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c27e56130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2631b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25b7fd60>]}
[0m06:34:36.767471 [debug] [MainThread]: Flushing usage events
[0m06:34:37.630433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:25:13.170989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae15d7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0715ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0715b20>]}


============================== 06:25:13.183133 | 65530432-d395-4e71-9c41-a8a5ff19bd70 ==============================
[0m06:25:13.183133 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:25:13.187432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:25:14.020953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0112ee0>]}
[0m06:25:14.280265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0124100>]}
[0m06:25:14.316500 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:25:14.638247 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:25:15.571636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:25:15.574112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:25:15.744123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf51aeb0>]}
[0m06:25:16.218397 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:25:16.236165 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:25:16.307053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf55b850>]}
[0m06:25:16.309531 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:25:16.313802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf5401f0>]}
[0m06:25:16.325145 [info ] [MainThread]: 
[0m06:25:16.328668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:25:16.331273 [info ] [MainThread]: 
[0m06:25:16.335133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:25:16.364435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:25:16.616065 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:25:16.620618 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:25:16.624499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:25:16.660498 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m06:25:16.665365 [debug] [ThreadPool]: On list_airflow: Close
[0m06:25:16.677024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:25:16.705393 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:25:16.707699 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:25:16.709593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:16.719940 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m06:25:16.722673 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:25:16.726072 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:25:16.742778 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m06:25:16.748443 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:25:16.759910 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:25:16.791872 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.793920 [debug] [MainThread]: On master: BEGIN
[0m06:25:16.795749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:25:16.806895 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:25:16.808924 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.810888 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:25:16.825293 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m06:25:16.834224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf53be20>]}
[0m06:25:16.839785 [debug] [MainThread]: On master: ROLLBACK
[0m06:25:16.842615 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.844706 [debug] [MainThread]: On master: BEGIN
[0m06:25:16.847445 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:25:16.852387 [debug] [MainThread]: On master: COMMIT
[0m06:25:16.856686 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.860583 [debug] [MainThread]: On master: COMMIT
[0m06:25:16.864062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:16.873074 [debug] [MainThread]: On master: Close
[0m06:25:16.892241 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:25:16.904869 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:25:16.909492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:25:16.912657 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:25:16.957666 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:25:16.972397 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:25:17.119249 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.131157 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.133352 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:25:17.136903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:17.143733 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:17.146878 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.148644 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:25:17.232654 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.081 seconds
[0m06:25:17.259293 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.260906 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:25:17.263733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:17.281144 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.284199 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:25:17.288444 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:17.356812 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:25:17.358959 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.361096 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:25:17.367970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:25:17.397014 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:25:17.418619 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.420881 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:25:17.428107 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m06:25:17.439569 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:25:17.446012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ade9f5670>]}
[0m06:25:17.449006 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7765[0m in 0.53s]
[0m06:25:17.455091 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:25:17.457327 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.459608 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:25:17.461901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:25:17.464321 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.479021 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.521323 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.556303 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.589296 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.597369 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:25:17.606206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:17.615813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:25:17.618881 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.621290 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:25:17.699034 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.075 seconds
[0m06:25:17.709618 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.711389 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:25:17.713504 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:17.725929 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.727854 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:25:17.729845 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:17.736773 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:25:17.738591 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.740228 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:25:17.744688 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:25:17.753465 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:25:17.755916 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.757557 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:25:17.762926 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:17.768617 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:25:17.775043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae14459a0>]}
[0m06:25:17.778324 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7765[0m in 0.31s]
[0m06:25:17.782033 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.786011 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:17.788042 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:25:17.790271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:25:17.791896 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:17.804318 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.813731 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:17.903143 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.914537 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.917282 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:25:17.921162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:17.927637 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:17.929997 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.932233 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:25:17.981384 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.046 seconds
[0m06:25:17.997016 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.001045 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:25:18.004912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.016061 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.019996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:25:18.023687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.028959 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:25:18.031173 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.035102 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:25:18.039384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:25:18.048161 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:25:18.054057 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.056953 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:25:18.062919 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:18.071376 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:25:18.075601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae14459a0>]}
[0m06:25:18.079365 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.29s]
[0m06:25:18.085401 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:18.088559 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:25:18.091608 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:25:18.095344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:25:18.099208 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:25:18.115723 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.131074 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:25:18.144423 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.157951 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.159718 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:25:18.161402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:18.168254 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:18.170936 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.173075 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:25:18.211226 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.036 seconds
[0m06:25:18.223113 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.224753 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:25:18.226561 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:18.235801 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.237439 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:25:18.239282 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:18.243030 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:25:18.244441 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.245851 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:25:18.249649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:25:18.257939 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:25:18.260364 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.261819 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:25:18.269380 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:25:18.276695 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:25:18.280370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ade8f14f0>]}
[0m06:25:18.285345 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.19s]
[0m06:25:18.290801 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:25:18.293409 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:25:18.296149 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:25:18.299774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:25:18.303391 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:25:18.314278 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.331688 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:25:18.351992 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.373483 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.376558 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:25:18.379384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:18.391747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m06:25:18.395882 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.399792 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:25:18.459564 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.055 seconds
[0m06:25:18.471065 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.473163 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:25:18.475391 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.484172 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.487481 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:25:18.489696 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:18.493693 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:25:18.495479 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.497101 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:25:18.500970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:25:18.513498 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:25:18.517511 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.520944 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:25:18.526542 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:18.531160 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:25:18.535298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adecac580>]}
[0m06:25:18.542508 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.24s]
[0m06:25:18.548644 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:25:18.557668 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:25:18.565867 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:25:18.571619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:25:18.576089 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:25:18.596425 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.608660 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:25:18.623358 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.633617 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.636422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:25:18.637934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:18.643474 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:25:18.645544 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.647781 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:25:18.672488 [debug] [Thread-1  ]: SQL status: SELECT 2416 in 0.022 seconds
[0m06:25:18.688539 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.693969 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:25:18.696970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.711092 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.722292 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:25:18.725591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.729503 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:25:18.731042 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.733626 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:25:18.737392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:25:18.744070 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:25:18.746284 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.747795 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:25:18.754773 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:25:18.760588 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:25:18.763175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ade987e50>]}
[0m06:25:18.766597 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2416[0m in 0.19s]
[0m06:25:18.770391 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:25:18.773869 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:18.775290 [debug] [MainThread]: On master: BEGIN
[0m06:25:18.776571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:25:18.782053 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:25:18.785498 [debug] [MainThread]: On master: COMMIT
[0m06:25:18.788020 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:18.789472 [debug] [MainThread]: On master: COMMIT
[0m06:25:18.791089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:18.792612 [debug] [MainThread]: On master: Close
[0m06:25:18.794611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:18.795942 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:25:18.797682 [info ] [MainThread]: 
[0m06:25:18.801433 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m06:25:18.806667 [debug] [MainThread]: Command end result
[0m06:25:18.885985 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:25:18.894360 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:25:18.920576 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:25:18.922355 [info ] [MainThread]: 
[0m06:25:18.924716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:25:18.927206 [info ] [MainThread]: 
[0m06:25:18.929779 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:25:18.937857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.029662, "process_in_blocks": "83984", "process_kernel_time": 1.182595, "process_mem_max_rss": "108544", "process_out_blocks": "0", "process_user_time": 8.317918}
[0m06:25:18.940529 [debug] [MainThread]: Command `dbt run` succeeded at 06:25:18.940028 after 6.03 seconds
[0m06:25:18.942949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae15d7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf4c0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf4c0f70>]}
[0m06:25:18.944928 [debug] [MainThread]: Flushing usage events
[0m06:25:21.418511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:33:45.919433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ad8500a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac98ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac98eac0>]}


============================== 06:33:45.948139 | c85d3227-babc-43f1-a07c-c1d72d1c3492 ==============================
[0m06:33:45.948139 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:33:45.952651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:33:47.090875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac96b8e0>]}
[0m06:33:47.380774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac1181c0>]}
[0m06:33:47.383135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:33:47.580778 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:33:48.092747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:33:48.094297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:33:48.268310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab55bf10>]}
[0m06:33:48.560049 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:33:48.578297 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:33:48.614086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab546ac0>]}
[0m06:33:48.616673 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:33:48.620065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50addbd5e0>]}
[0m06:33:48.627245 [info ] [MainThread]: 
[0m06:33:48.629836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:33:48.632155 [info ] [MainThread]: 
[0m06:33:48.634775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:48.653296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:33:48.745567 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:33:48.747310 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:33:48.748808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:48.758089 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m06:33:48.763331 [debug] [ThreadPool]: On list_airflow: Close
[0m06:33:48.768987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:33:48.786301 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:33:48.789129 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:33:48.791070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:48.797766 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:33:48.799961 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:33:48.801636 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:33:48.810842 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m06:33:48.814858 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:33:48.816604 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:33:48.836763 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.838835 [debug] [MainThread]: On master: BEGIN
[0m06:33:48.840431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:33:48.847744 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:33:48.850038 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.851919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:33:48.859719 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:33:48.863889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab57c7f0>]}
[0m06:33:48.865903 [debug] [MainThread]: On master: ROLLBACK
[0m06:33:48.867769 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.870231 [debug] [MainThread]: On master: BEGIN
[0m06:33:48.873015 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:33:48.875037 [debug] [MainThread]: On master: COMMIT
[0m06:33:48.876647 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.878343 [debug] [MainThread]: On master: COMMIT
[0m06:33:48.880294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:48.882049 [debug] [MainThread]: On master: Close
[0m06:33:48.889858 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:33:48.892119 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:33:48.894781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:33:48.896719 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:33:48.924473 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:33:48.933748 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:33:49.045891 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.062450 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.065794 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:33:49.068180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.076106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:33:49.078166 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.079955 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:33:49.142309 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.061 seconds
[0m06:33:49.158915 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.161055 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:33:49.163603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.174851 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.176870 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:33:49.179335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.238702 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:33:49.240619 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.242071 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:33:49.246763 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:33:49.262587 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:33:49.276280 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.277900 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:33:49.282696 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:33:49.290209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:33:49.295430 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aac756d0>]}
[0m06:33:49.297684 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7765[0m in 0.40s]
[0m06:33:49.301065 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:33:49.304041 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.307095 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:33:49.309723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:33:49.311941 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.322304 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.331885 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.342285 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.352853 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.355262 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:33:49.357139 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.363537 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:33:49.366603 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.368583 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:33:49.417742 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.046 seconds
[0m06:33:49.427016 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.429209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:33:49.432212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.443796 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.445670 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:33:49.447841 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.452832 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:33:49.455197 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.456943 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:33:49.461314 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:33:49.470789 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:33:49.473267 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.475025 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:33:49.480216 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:33:49.483996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:33:49.487231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:49.490195 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7765[0m in 0.18s]
[0m06:33:49.493170 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.495221 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.497497 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:33:49.500064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:33:49.501887 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.513377 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.523843 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.609180 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.620415 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.622572 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:33:49.624233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.631027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:33:49.633455 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.635532 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:33:49.679516 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.041 seconds
[0m06:33:49.689827 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.691543 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:33:49.693781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.701208 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.703588 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:33:49.706236 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:49.710317 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:33:49.712045 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.713705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:33:49.719529 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:33:49.726872 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:33:49.729468 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.731202 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:33:49.735639 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:33:49.739856 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:33:49.741932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:49.744729 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.24s]
[0m06:33:49.747606 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.750072 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:33:49.752933 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:33:49.756723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:33:49.760328 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:33:49.770715 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.780957 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:33:49.797308 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.809873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.811999 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:33:49.813730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.821170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:33:49.823331 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.825069 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:33:49.889553 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.062 seconds
[0m06:33:49.898904 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.901366 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:33:49.905421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.913071 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.914702 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:33:49.917273 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.922346 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:33:49.924142 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.926272 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:33:49.930892 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:33:49.938518 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:33:49.941234 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.942911 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:33:49.972594 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.025 seconds
[0m06:33:49.976824 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:33:49.978970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:49.981107 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.22s]
[0m06:33:49.984734 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:33:49.987533 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:33:49.989886 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:33:49.993011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:33:49.999178 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:33:50.008774 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.019084 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:33:50.029410 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.040461 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.042224 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:33:50.043996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:50.051568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:33:50.056104 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.059280 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:33:50.099423 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.038 seconds
[0m06:33:50.108085 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.109743 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:33:50.111649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:50.119508 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.121127 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:33:50.123031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:50.126854 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:33:50.128754 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.130627 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:33:50.134070 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:33:50.142851 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:33:50.145167 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.146928 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:33:50.152803 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:33:50.156955 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:33:50.159940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:50.163134 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.17s]
[0m06:33:50.166454 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:33:50.170293 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:33:50.173286 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:33:50.176762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:33:50.179113 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:33:50.190294 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.202817 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:33:50.214355 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.226880 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.228994 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:33:50.230832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:50.238917 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:33:50.241454 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.243635 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:33:50.263861 [debug] [Thread-1  ]: SQL status: SELECT 2416 in 0.018 seconds
[0m06:33:50.277437 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.280279 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:33:50.284326 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:50.296587 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.298807 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:33:50.304339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:50.308917 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:33:50.310889 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.312976 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:33:50.318932 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:33:50.326114 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:33:50.328650 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.330308 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:33:50.335966 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:33:50.340286 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:33:50.342831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aa8db910>]}
[0m06:33:50.345320 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2416[0m in 0.17s]
[0m06:33:50.348229 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:33:50.353195 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:50.354721 [debug] [MainThread]: On master: BEGIN
[0m06:33:50.356057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:33:50.361773 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:33:50.364222 [debug] [MainThread]: On master: COMMIT
[0m06:33:50.366503 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:50.370067 [debug] [MainThread]: On master: COMMIT
[0m06:33:50.371907 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:50.373660 [debug] [MainThread]: On master: Close
[0m06:33:50.376104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:50.378700 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:33:50.380908 [info ] [MainThread]: 
[0m06:33:50.385739 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m06:33:50.393375 [debug] [MainThread]: Command end result
[0m06:33:50.465360 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:33:50.474149 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:33:50.499715 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:33:50.502998 [info ] [MainThread]: 
[0m06:33:50.505999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:33:50.508596 [info ] [MainThread]: 
[0m06:33:50.511143 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:33:50.514287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.941845, "process_in_blocks": "0", "process_kernel_time": 0.783924, "process_mem_max_rss": "108176", "process_out_blocks": "0", "process_user_time": 8.27141}
[0m06:33:50.517545 [debug] [MainThread]: Command `dbt run` succeeded at 06:33:50.516219 after 4.94 seconds
[0m06:33:50.520080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ad8500a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab5bc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50add26880>]}
[0m06:33:50.522020 [debug] [MainThread]: Flushing usage events
[0m06:33:51.883021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:12.663000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6c770d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b5db59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b5db5a30>]}


============================== 14:29:12.676137 | 670d0ce7-1036-42e8-b508-d02c9e590e07 ==============================
[0m14:29:12.676137 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:29:12.678519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:29:13.223519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b7c149d0>]}
[0m14:29:13.404327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b5582f70>]}
[0m14:29:13.407756 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:29:13.693797 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:29:14.369887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:14.371566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:14.473744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499bf40>]}
[0m14:29:14.712042 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:29:14.723421 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:29:14.763039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499bf70>]}
[0m14:29:14.765414 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m14:29:14.767194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b71aa460>]}
[0m14:29:14.772096 [info ] [MainThread]: 
[0m14:29:14.774122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:29:14.775655 [info ] [MainThread]: 
[0m14:29:14.777538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:14.790675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:29:14.866709 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:29:14.868659 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:29:14.870735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:14.880698 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m14:29:14.884233 [debug] [ThreadPool]: On list_airflow: Close
[0m14:29:14.888741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m14:29:14.904575 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m14:29:14.906737 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m14:29:14.908552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:14.914987 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:29:14.916832 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m14:29:14.919357 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m14:29:14.926878 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m14:29:14.931693 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m14:29:14.933735 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m14:29:14.947427 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.949120 [debug] [MainThread]: On master: BEGIN
[0m14:29:14.950503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:14.955997 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:29:14.957493 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.958926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:29:14.965730 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m14:29:14.969177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b49a5d60>]}
[0m14:29:14.970861 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:14.972480 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.973828 [debug] [MainThread]: On master: BEGIN
[0m14:29:14.975768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:29:14.977277 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.979450 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.981650 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.983914 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:14.985736 [debug] [MainThread]: On master: Close
[0m14:29:14.991617 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m14:29:14.993678 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m14:29:14.995566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m14:29:14.997453 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m14:29:15.030552 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.045539 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m14:29:15.156423 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.166522 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.168594 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m14:29:15.170420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.176410 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m14:29:15.178148 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.180250 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m14:29:15.269116 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 0.087 seconds
[0m14:29:15.284033 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.285799 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m14:29:15.288338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.297024 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.299162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m14:29:15.301350 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:15.357150 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m14:29:15.358849 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.360377 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m14:29:15.364688 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m14:29:15.384164 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m14:29:15.396141 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.398615 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m14:29:15.403668 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:15.410130 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m14:29:15.415843 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b40b5700>]}
[0m14:29:15.417954 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7770[0m in 0.42s]
[0m14:29:15.420107 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m14:29:15.421707 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.423433 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m14:29:15.425313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m14:29:15.426787 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.437017 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.447597 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.457257 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.468142 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.469897 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m14:29:15.471593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.478236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:29:15.480744 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.483038 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m14:29:15.524896 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 0.040 seconds
[0m14:29:15.533210 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.535254 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m14:29:15.538069 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.548496 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.550432 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m14:29:15.552655 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:15.557398 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m14:29:15.559297 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.561155 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m14:29:15.566636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m14:29:15.574662 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m14:29:15.577706 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.579591 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m14:29:15.585233 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:15.588744 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m14:29:15.591074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6e32580>]}
[0m14:29:15.593430 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7770[0m in 0.17s]
[0m14:29:15.596419 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.598740 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.600895 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m14:29:15.603198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m14:29:15.605348 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.615506 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.626448 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.696082 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.706458 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.708147 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m14:29:15.709792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.716808 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:29:15.718868 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.720845 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m14:29:15.771823 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.049 seconds
[0m14:29:15.779891 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.781705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m14:29:15.784038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.791728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.793418 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m14:29:15.796280 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.801575 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m14:29:15.803413 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.805366 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m14:29:15.809087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:15.816141 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m14:29:15.818496 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.820181 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m14:29:15.824220 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:29:15.827818 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m14:29:15.830727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6e32580>]}
[0m14:29:15.833045 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.23s]
[0m14:29:15.835136 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.836775 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m14:29:15.838459 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m14:29:15.840169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m14:29:15.841603 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m14:29:15.849772 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.858750 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m14:29:15.868972 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.878750 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.880881 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m14:29:15.882524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.888174 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m14:29:15.890035 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.891823 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m14:29:15.928602 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.035 seconds
[0m14:29:15.941461 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.943406 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m14:29:15.945954 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.954831 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.956586 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m14:29:15.958753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.962996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m14:29:15.965556 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.967358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m14:29:15.970520 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:15.977242 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m14:29:15.980646 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.982429 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m14:29:15.986265 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:29:15.989923 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m14:29:15.991981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b51e8940>]}
[0m14:29:15.994141 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.15s]
[0m14:29:15.996727 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m14:29:15.998782 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m14:29:16.000721 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m14:29:16.002555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m14:29:16.004273 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m14:29:16.012601 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.022378 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m14:29:16.033174 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.043746 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.045670 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m14:29:16.047911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:16.054432 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m14:29:16.056078 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.057982 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m14:29:16.094620 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.035 seconds
[0m14:29:16.103497 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.105307 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m14:29:16.107297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:16.115329 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.116926 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m14:29:16.118950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:16.122864 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m14:29:16.124565 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.126117 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m14:29:16.129974 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:16.138869 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m14:29:16.141591 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.143384 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m14:29:16.148465 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:16.152147 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m14:29:16.154609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b51e8940>]}
[0m14:29:16.157087 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.15s]
[0m14:29:16.159339 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m14:29:16.161166 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m14:29:16.163320 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m14:29:16.165655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m14:29:16.167414 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m14:29:16.174958 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.185400 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m14:29:16.194805 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.209519 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.212168 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m14:29:16.215168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:16.222954 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:29:16.225054 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.226857 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m14:29:16.242424 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.014 seconds
[0m14:29:16.252336 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.254813 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m14:29:16.261510 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:29:16.272158 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.274014 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m14:29:16.276166 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:16.281492 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m14:29:16.283222 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.285043 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m14:29:16.288275 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:16.296006 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m14:29:16.299413 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.301336 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m14:29:16.305950 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:16.309508 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m14:29:16.311608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b48ddd90>]}
[0m14:29:16.314885 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.15s]
[0m14:29:16.317900 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m14:29:16.321263 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:16.322693 [debug] [MainThread]: On master: BEGIN
[0m14:29:16.324018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:16.329941 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:29:16.331709 [debug] [MainThread]: On master: COMMIT
[0m14:29:16.333179 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:16.334687 [debug] [MainThread]: On master: COMMIT
[0m14:29:16.336401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:16.337794 [debug] [MainThread]: On master: Close
[0m14:29:16.339397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:16.340694 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m14:29:16.342125 [info ] [MainThread]: 
[0m14:29:16.343720 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m14:29:16.348475 [debug] [MainThread]: Command end result
[0m14:29:16.418410 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:29:16.426381 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:29:16.449812 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:29:16.451946 [info ] [MainThread]: 
[0m14:29:16.453936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:16.455844 [info ] [MainThread]: 
[0m14:29:16.458239 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:29:16.463686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.06171, "process_in_blocks": "16360", "process_kernel_time": 0.418592, "process_mem_max_rss": "107896", "process_out_blocks": "0", "process_user_time": 6.348655}
[0m14:29:16.466393 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:16.465888 after 4.06 seconds
[0m14:29:16.468667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6c770d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499cd30>]}
[0m14:29:16.470611 [debug] [MainThread]: Flushing usage events
[0m14:29:18.462300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:17:26.001297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ef02040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675e045550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675e0454f0>]}


============================== 06:17:26.047090 | 824cb69d-f2a9-4a74-b710-e00594454ad1 ==============================
[0m06:17:26.047090 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:17:26.058771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:17:28.336686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675d7c7ee0>]}
[0m06:17:28.893644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675d7d9100>]}
[0m06:17:28.910202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:17:29.544619 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:17:32.749788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:17:32.751964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:17:33.068350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce5beb0>]}
[0m06:17:33.843667 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:17:33.903575 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:17:34.208804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce9b850>]}
[0m06:17:34.211672 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:17:34.214288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce98e20>]}
[0m06:17:34.226005 [info ] [MainThread]: 
[0m06:17:34.245337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:17:34.247770 [info ] [MainThread]: 
[0m06:17:34.250730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:17:34.302008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:17:35.092185 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:17:35.109373 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:17:35.115499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:17:35.661439 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.546 seconds
[0m06:17:35.667612 [debug] [ThreadPool]: On list_airflow: Close
[0m06:17:35.692158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:17:35.737710 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:17:35.744703 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:17:35.746691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:17:35.754128 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:17:35.756355 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:17:35.758426 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:17:35.778974 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.018 seconds
[0m06:17:35.787401 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:17:35.790876 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:17:35.819213 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.821331 [debug] [MainThread]: On master: BEGIN
[0m06:17:35.823492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:17:35.847941 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m06:17:35.851103 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.863805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:17:35.879408 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m06:17:35.884287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce7ce20>]}
[0m06:17:35.887651 [debug] [MainThread]: On master: ROLLBACK
[0m06:17:35.890183 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.894291 [debug] [MainThread]: On master: BEGIN
[0m06:17:35.898359 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:17:35.900873 [debug] [MainThread]: On master: COMMIT
[0m06:17:35.902966 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.906224 [debug] [MainThread]: On master: COMMIT
[0m06:17:35.920209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:17:35.924419 [debug] [MainThread]: On master: Close
[0m06:17:35.936095 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:17:35.939065 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:17:35.944016 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:17:35.948928 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:17:35.997879 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.028982 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:17:36.308546 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.333254 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.335659 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:17:36.338311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:36.346157 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:17:36.348829 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.351231 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:17:37.694682 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 1.341 seconds
[0m06:17:37.736531 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:37.754987 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:17:37.758133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:37.773310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:37.786080 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:17:37.788966 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:37.955020 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:17:37.957568 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:37.960442 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:17:37.980823 [debug] [Thread-1  ]: SQL status: COMMIT in 0.018 seconds
[0m06:17:38.035568 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:17:38.060603 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:38.065151 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:17:38.093816 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.023 seconds
[0m06:17:38.112768 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:17:38.187631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675c335670>]}
[0m06:17:38.199566 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7770[0m in 2.21s]
[0m06:17:38.220116 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:17:38.225277 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.231131 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:17:38.241727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:17:38.246867 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.268606 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.307514 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.355473 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.411860 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.431618 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:17:38.434978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:38.458250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m06:17:38.484884 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.494579 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:17:38.700076 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 0.189 seconds
[0m06:17:38.721627 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.724083 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:17:38.728293 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:38.757020 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.764101 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:17:38.771733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:38.779326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:17:38.782341 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.784877 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:17:38.826909 [debug] [Thread-1  ]: SQL status: COMMIT in 0.031 seconds
[0m06:17:38.847788 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:17:38.851633 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.863965 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:17:38.885112 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.019 seconds
[0m06:17:38.890266 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:17:38.893239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:38.898178 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7770[0m in 0.65s]
[0m06:17:38.908578 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.913092 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:38.916470 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:17:38.919539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:17:38.922202 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:38.954590 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:38.986937 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:39.256611 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.286067 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.289903 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:17:39.292874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:39.303036 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m06:17:39.305573 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.308409 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:17:39.496301 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.182 seconds
[0m06:17:39.520823 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.524846 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:17:39.534885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:39.574850 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.581088 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:17:39.587070 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:39.605709 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:17:39.608503 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.611734 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:17:39.644372 [debug] [Thread-1  ]: SQL status: COMMIT in 0.021 seconds
[0m06:17:39.659833 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:17:39.673573 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.676387 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:17:39.689750 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.010 seconds
[0m06:17:39.705630 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:17:39.709191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:39.721738 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.79s]
[0m06:17:39.729502 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:39.732705 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:17:39.735657 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:17:39.744962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:17:39.749793 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:17:39.771101 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.803345 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:17:39.840772 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.856031 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.859003 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:17:39.862019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:39.882150 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m06:17:39.884976 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.887448 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:17:40.055151 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.165 seconds
[0m06:17:40.078212 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.081349 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:17:40.084433 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.103642 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.115568 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:17:40.118775 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.125108 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:17:40.128301 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.130980 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:17:40.151756 [debug] [Thread-1  ]: SQL status: COMMIT in 0.018 seconds
[0m06:17:40.162150 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:17:40.173480 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.176015 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:17:40.196307 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m06:17:40.201986 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:17:40.207001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:40.216674 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.46s]
[0m06:17:40.224388 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:17:40.234729 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:17:40.238695 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:17:40.257266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:17:40.263487 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:17:40.305590 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.331735 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:17:40.348352 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.379402 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.382029 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:17:40.385036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:40.395337 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m06:17:40.398223 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.401145 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:17:40.541647 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.138 seconds
[0m06:17:40.569891 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.597467 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:17:40.606002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.628112 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.630395 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:17:40.640870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.656719 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:17:40.679135 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.682621 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:17:40.701154 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m06:17:40.728575 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:17:40.738071 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.742678 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:17:40.776120 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.031 seconds
[0m06:17:40.781927 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:17:40.791899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:40.795908 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.53s]
[0m06:17:40.813577 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:17:40.816802 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:17:40.822774 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:17:40.832150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:17:40.867657 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:17:40.892913 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.919160 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:17:40.943070 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.961661 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.964881 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:17:40.969490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:40.978575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:17:40.981968 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.985246 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:17:41.023391 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.035 seconds
[0m06:17:41.047679 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.050491 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:17:41.053683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:41.070840 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.073169 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:17:41.085806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:41.092574 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:17:41.096935 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.107747 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:17:41.118989 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m06:17:41.132439 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:17:41.144356 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.148274 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:17:41.157412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:17:41.163448 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:17:41.166709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675cb50ac0>]}
[0m06:17:41.177900 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.33s]
[0m06:17:41.183143 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:17:41.188439 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:41.190593 [debug] [MainThread]: On master: BEGIN
[0m06:17:41.193820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:17:41.210510 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m06:17:41.215927 [debug] [MainThread]: On master: COMMIT
[0m06:17:41.218882 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:41.221147 [debug] [MainThread]: On master: COMMIT
[0m06:17:41.226507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:17:41.228759 [debug] [MainThread]: On master: Close
[0m06:17:41.236525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:17:41.243043 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:17:41.250885 [info ] [MainThread]: 
[0m06:17:41.264585 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m06:17:41.296626 [debug] [MainThread]: Command end result
[0m06:17:41.534932 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:17:41.564783 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:17:41.609376 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:17:41.612053 [info ] [MainThread]: 
[0m06:17:41.615879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:17:41.620103 [info ] [MainThread]: 
[0m06:17:41.626536 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:17:41.644495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.796707, "process_in_blocks": "84160", "process_kernel_time": 3.207221, "process_mem_max_rss": "108056", "process_out_blocks": "0", "process_user_time": 16.776236}
[0m06:17:41.652881 [debug] [MainThread]: Command `dbt run` succeeded at 06:17:41.651582 after 16.81 seconds
[0m06:17:41.658389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ef02040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675cbc0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675cbc0f70>]}
[0m06:17:41.661710 [debug] [MainThread]: Flushing usage events
[0m06:17:42.770525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:57.447273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069d230a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068e665b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068e66550>]}


============================== 10:03:57.455121 | 854c9374-1a52-46f8-a869-63de084ce50d ==============================
[0m10:03:57.455121 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:03:57.462075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:57.849649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068e3e8e0>]}
[0m10:03:57.968638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0688671c0>]}
[0m10:03:57.971160 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:58.135030 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:03:58.788942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:58.790170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:58.933791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c9bf10>]}
[0m10:03:59.173723 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:03:59.209556 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:03:59.258728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c86ac0>]}
[0m10:03:59.260309 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m10:03:59.261727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06a28ca60>]}
[0m10:03:59.267103 [info ] [MainThread]: 
[0m10:03:59.268675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:59.270024 [info ] [MainThread]: 
[0m10:03:59.271953 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:59.283247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:03:59.378270 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:03:59.379927 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:03:59.381350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:59.427800 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.046 seconds
[0m10:03:59.430041 [debug] [ThreadPool]: On list_airflow: Close
[0m10:03:59.433231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:03:59.445678 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:03:59.446719 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:03:59.447613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:59.451555 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:03:59.453069 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:03:59.454414 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:03:59.480560 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.024 seconds
[0m10:03:59.487366 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:03:59.489010 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:03:59.511956 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.515135 [debug] [MainThread]: On master: BEGIN
[0m10:03:59.516196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:59.520231 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:03:59.521997 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.522987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:59.531111 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:03:59.534016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067cbc7f0>]}
[0m10:03:59.535324 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:59.536672 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.537998 [debug] [MainThread]: On master: BEGIN
[0m10:03:59.539716 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:03:59.540969 [debug] [MainThread]: On master: COMMIT
[0m10:03:59.542109 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.543273 [debug] [MainThread]: On master: COMMIT
[0m10:03:59.548368 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:03:59.551671 [debug] [MainThread]: On master: Close
[0m10:03:59.558859 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.560808 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m10:03:59.563779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m10:03:59.565740 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.584792 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.590449 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.653885 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.662989 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.664528 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m10:03:59.665626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:03:59.670366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:03:59.672084 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.673453 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:03:59.756310 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.082 seconds
[0m10:03:59.771045 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.772797 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m10:03:59.775988 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:03:59.785548 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.786734 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m10:03:59.788437 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:03:59.828158 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:03:59.829509 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.830513 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:03:59.832797 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:03:59.844689 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m10:03:59.851822 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.852980 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m10:03:59.858414 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m10:03:59.863301 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m10:03:59.872128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0671776d0>]}
[0m10:03:59.876172 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7775[0m in 0.31s]
[0m10:03:59.877995 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.880539 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:03:59.882147 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:03:59.884104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m10:03:59.885475 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:03:59.893311 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.901568 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:03:59.918270 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.930902 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.948131 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:03:59.949722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:03:59.954533 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:03:59.955980 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.957358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:04:00.010243 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.052 seconds
[0m10:04:00.021692 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.027207 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m10:04:00.029555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:04:00.036330 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.038744 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:04:00.040868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.045491 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:04:00.046875 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.047995 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:04:00.051629 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:04:00.057538 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:04:00.059623 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.061103 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:04:00.069527 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m10:04:00.072087 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:04:00.073585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.075457 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7775[0m in 0.19s]
[0m10:04:00.077205 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:04:00.078435 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.080332 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m10:04:00.081876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m10:04:00.082972 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.089798 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.095524 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.158541 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.165145 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.166497 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m10:04:00.167673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.172167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m10:04:00.173579 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.174964 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m10:04:00.203791 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.028 seconds
[0m10:04:00.208788 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.209751 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m10:04:00.211051 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.216116 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.217151 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m10:04:00.218375 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.221041 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:04:00.222004 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.222929 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:04:00.225157 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:04:00.230363 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m10:04:00.231892 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.232739 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m10:04:00.235258 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.237521 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m10:04:00.238749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.240093 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.16s]
[0m10:04:00.242387 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.244225 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m10:04:00.245596 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m10:04:00.247214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m10:04:00.248251 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m10:04:00.253170 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.258606 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m10:04:00.265925 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.271325 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.272390 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m10:04:00.273235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.276746 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.278052 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.279633 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m10:04:00.302718 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.022 seconds
[0m10:04:00.310027 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.311525 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m10:04:00.313283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.318175 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.319368 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m10:04:00.320702 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.323132 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:04:00.324030 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.324868 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:04:00.327235 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:04:00.332296 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m10:04:00.333788 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.334760 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m10:04:00.337804 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.339982 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m10:04:00.341244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.342664 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.09s]
[0m10:04:00.344385 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m10:04:00.345531 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m10:04:00.346953 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m10:04:00.348544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m10:04:00.349465 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m10:04:00.355714 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.361356 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m10:04:00.367790 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.373356 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.374557 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m10:04:00.375473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.378922 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.380252 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.381156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m10:04:00.404412 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.022 seconds
[0m10:04:00.411201 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.413133 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m10:04:00.414961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:04:00.420997 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.422076 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m10:04:00.423471 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.426016 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:04:00.427101 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.428358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:04:00.430931 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:04:00.437309 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m10:04:00.440966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.442135 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m10:04:00.445304 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.447595 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m10:04:00.448936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.450547 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.10s]
[0m10:04:00.452183 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m10:04:00.453230 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m10:04:00.454321 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m10:04:00.455550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m10:04:00.456506 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m10:04:00.461247 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.467048 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m10:04:00.473779 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.479869 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.480923 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m10:04:00.481784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.485143 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.486267 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.487161 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m10:04:00.497497 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.009 seconds
[0m10:04:00.502144 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.503158 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m10:04:00.504373 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.512728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.513723 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m10:04:00.515154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.517537 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:04:00.518381 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.519240 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:04:00.521874 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m10:04:00.525648 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m10:04:00.526832 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.527642 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m10:04:00.530611 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.533619 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m10:04:00.535487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066df4910>]}
[0m10:04:00.537008 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.08s]
[0m10:04:00.538806 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m10:04:00.540853 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.541707 [debug] [MainThread]: On master: BEGIN
[0m10:04:00.542452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:00.545919 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.547066 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.547937 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.548687 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.549641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:04:00.550382 [debug] [MainThread]: On master: Close
[0m10:04:00.551591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:00.552676 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m10:04:00.554121 [info ] [MainThread]: 
[0m10:04:00.555390 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m10:04:00.558405 [debug] [MainThread]: Command end result
[0m10:04:00.600379 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:04:00.604825 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:04:00.618753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:04:00.619732 [info ] [MainThread]: 
[0m10:04:00.621023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:00.622337 [info ] [MainThread]: 
[0m10:04:00.623590 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:04:00.626339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3383715, "process_in_blocks": "84864", "process_kernel_time": 0.459427, "process_mem_max_rss": "107988", "process_out_blocks": "0", "process_user_time": 4.951602}
[0m10:04:00.627389 [debug] [MainThread]: Command `dbt run` succeeded at 10:04:00.627252 after 3.34 seconds
[0m10:04:00.628477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069d230a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c401c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c40d00>]}
[0m10:04:00.629487 [debug] [MainThread]: Flushing usage events
[0m10:04:01.553981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:29.714441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639ece100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463900da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463900da90>]}


============================== 10:05:29.719376 | 9280a4d3-021c-4678-8d89-55cba31cd400 ==============================
[0m10:05:29.719376 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:05:29.721048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:05:30.109064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463afb80a0>]}
[0m10:05:30.212259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463966dc70>]}
[0m10:05:30.213931 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:05:30.351891 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:05:30.625075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:05:30.626349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:05:30.702862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bdbf70>]}
[0m10:05:30.895254 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:05:30.903579 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:05:30.943156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bdb790>]}
[0m10:05:30.945151 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m10:05:30.946889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a0cda60>]}
[0m10:05:30.951486 [info ] [MainThread]: 
[0m10:05:30.953310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:05:30.954782 [info ] [MainThread]: 
[0m10:05:30.956742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:30.967445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:05:31.015301 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:05:31.017021 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:05:31.018133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:31.023134 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m10:05:31.025096 [debug] [ThreadPool]: On list_airflow: Close
[0m10:05:31.028196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:05:31.037915 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:05:31.039091 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:05:31.040342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:31.043674 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m10:05:31.044938 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:05:31.045929 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:05:31.049577 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m10:05:31.053160 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:05:31.054551 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:05:31.062905 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.064305 [debug] [MainThread]: On master: BEGIN
[0m10:05:31.065527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:31.071045 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:05:31.072863 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.074319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:05:31.079055 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:05:31.082370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bfc610>]}
[0m10:05:31.084254 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:31.085844 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.086953 [debug] [MainThread]: On master: BEGIN
[0m10:05:31.088332 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:05:31.089619 [debug] [MainThread]: On master: COMMIT
[0m10:05:31.090887 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.099400 [debug] [MainThread]: On master: COMMIT
[0m10:05:31.100802 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:05:31.102354 [debug] [MainThread]: On master: Close
[0m10:05:31.106459 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.107965 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m10:05:31.109378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m10:05:31.110746 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.125748 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.130796 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.194076 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.198792 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.200130 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m10:05:31.201093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.204978 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m10:05:31.206506 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.207690 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:05:31.235333 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.026 seconds
[0m10:05:31.243723 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.244741 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m10:05:31.245850 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.250439 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.251621 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m10:05:31.253184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.279278 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:05:31.280533 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.281471 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:05:31.354010 [debug] [Thread-1  ]: SQL status: COMMIT in 0.071 seconds
[0m10:05:31.362065 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m10:05:31.369285 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.370635 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m10:05:31.385436 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m10:05:31.388961 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m10:05:31.391416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46372f7730>]}
[0m10:05:31.393015 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7775[0m in 0.28s]
[0m10:05:31.394662 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.395738 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.396813 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:05:31.398306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m10:05:31.399968 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.406954 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.412565 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.418515 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.424242 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.425897 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:05:31.426971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.430176 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:05:31.431641 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.433211 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:05:31.479901 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.045 seconds
[0m10:05:31.486261 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.487850 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m10:05:31.489495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.494634 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.495810 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:05:31.497174 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.500096 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:05:31.501957 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.503196 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:05:31.570911 [debug] [Thread-1  ]: SQL status: COMMIT in 0.066 seconds
[0m10:05:31.575046 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:05:31.576370 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.577267 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:05:31.580266 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:31.582761 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:05:31.584514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a087eb0>]}
[0m10:05:31.586002 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7775[0m in 0.19s]
[0m10:05:31.587652 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.588696 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.589755 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m10:05:31.591284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m10:05:31.592428 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.598856 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.605229 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.667132 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.676912 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.678288 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m10:05:31.679557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.684407 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:05:31.686426 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.687990 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m10:05:31.740661 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.051 seconds
[0m10:05:31.745679 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.746757 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m10:05:31.748650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:05:31.753845 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.754954 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m10:05:31.756485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.759233 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:05:31.760495 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.761565 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:05:31.763743 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:05:31.768191 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m10:05:31.769766 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.770742 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m10:05:31.773327 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:31.775513 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m10:05:31.776797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a087eb0>]}
[0m10:05:31.778243 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.19s]
[0m10:05:31.780251 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.781519 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m10:05:31.782700 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m10:05:31.784331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m10:05:31.785597 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m10:05:31.790286 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.796015 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m10:05:31.801847 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.806873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.807863 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m10:05:31.808974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.813813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:05:31.815471 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.816506 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m10:05:31.866337 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.049 seconds
[0m10:05:31.873044 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.874473 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m10:05:31.876252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.880744 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.881887 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m10:05:31.883275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.885746 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:05:31.886839 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.887638 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:05:31.889711 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:05:31.893814 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m10:05:31.895441 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.896717 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m10:05:31.920903 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.023 seconds
[0m10:05:31.924209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m10:05:31.925687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463730eeb0>]}
[0m10:05:31.927177 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.14s]
[0m10:05:31.928948 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m10:05:31.930206 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m10:05:31.932018 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m10:05:31.934228 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m10:05:31.935786 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m10:05:31.941396 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.947091 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m10:05:31.953054 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.958466 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.959407 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m10:05:31.960220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.963427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:05:31.964939 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.966190 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m10:05:32.015348 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.048 seconds
[0m10:05:32.020277 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.021589 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m10:05:32.023084 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.028707 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.030171 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m10:05:32.031739 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.034814 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:05:32.036219 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.037490 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:05:32.053263 [debug] [Thread-1  ]: SQL status: COMMIT in 0.014 seconds
[0m10:05:32.059145 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m10:05:32.061103 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.062329 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m10:05:32.065029 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:32.067590 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m10:05:32.069098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a087eb0>]}
[0m10:05:32.070580 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.13s]
[0m10:05:32.072236 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m10:05:32.073514 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m10:05:32.074805 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m10:05:32.076403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m10:05:32.077434 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m10:05:32.082083 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.087519 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m10:05:32.092919 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.098061 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.098997 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m10:05:32.099847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:32.102997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:05:32.104456 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.105574 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m10:05:32.113930 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.007 seconds
[0m10:05:32.139695 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.141059 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m10:05:32.142562 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.146962 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.148148 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m10:05:32.149418 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.152244 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:05:32.153574 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.154453 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:05:32.215987 [debug] [Thread-1  ]: SQL status: COMMIT in 0.061 seconds
[0m10:05:32.220216 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m10:05:32.221749 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.223119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m10:05:32.225823 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:32.227900 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m10:05:32.229123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4636fb7760>]}
[0m10:05:32.230550 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.15s]
[0m10:05:32.232442 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m10:05:32.234807 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:32.235683 [debug] [MainThread]: On master: BEGIN
[0m10:05:32.236484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:05:32.239700 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:05:32.240965 [debug] [MainThread]: On master: COMMIT
[0m10:05:32.241867 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:32.242676 [debug] [MainThread]: On master: COMMIT
[0m10:05:32.243592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:05:32.244485 [debug] [MainThread]: On master: Close
[0m10:05:32.245680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:32.247066 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m10:05:32.248606 [info ] [MainThread]: 
[0m10:05:32.249803 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m10:05:32.252632 [debug] [MainThread]: Command end result
[0m10:05:32.290971 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:05:32.296834 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:05:32.314249 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:05:32.315458 [info ] [MainThread]: 
[0m10:05:32.317184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:05:32.319032 [info ] [MainThread]: 
[0m10:05:32.320891 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:05:32.323725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7129738, "process_in_blocks": "0", "process_kernel_time": 0.282283, "process_mem_max_rss": "108272", "process_out_blocks": "0", "process_user_time": 4.375398}
[0m10:05:32.325447 [debug] [MainThread]: Command `dbt run` succeeded at 10:05:32.325076 after 2.71 seconds
[0m10:05:32.327060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639ece100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463afb80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bff580>]}
[0m10:05:32.328546 [debug] [MainThread]: Flushing usage events
[0m10:05:33.176368 [debug] [MainThread]: An error was encountered while trying to flush usage events
