[0m16:16:31.259586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc91144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc82585e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc8258640>]}


============================== 16:16:31.276981 | 97444c2b-60e5-425c-8e02-103b3cbb4406 ==============================
[0m16:16:31.276981 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:16:31.279978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:16:31.282450 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:16:31.286376 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.2018816, "process_in_blocks": "1104", "process_kernel_time": 0.261041, "process_mem_max_rss": "86824", "process_out_blocks": "1032", "process_user_time": 3.443733}
[0m16:16:31.289139 [debug] [MainThread]: Command `dbt run` failed at 16:16:31.288825 after 0.21 seconds
[0m16:16:31.291235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc91144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc82dedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cc82de6d0>]}
[0m16:16:31.293366 [debug] [MainThread]: Flushing usage events
[0m16:16:31.994315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:01.536008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282d3a90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e3520>]}


============================== 16:18:01.544445 | 8fefea58-ff38-49b5-9b55-d2cf12126baa ==============================
[0m16:18:01.544445 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:18:01.547708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:18:01.550004 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m16:18:01.553014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.12771562, "process_in_blocks": "0", "process_kernel_time": 0.089798, "process_mem_max_rss": "85984", "process_out_blocks": "0", "process_user_time": 3.023216}
[0m16:18:01.555422 [debug] [MainThread]: Command `dbt run` failed at 16:18:01.554975 after 0.13 seconds
[0m16:18:01.557616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282d3a90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c4e34c0>]}
[0m16:18:01.559682 [debug] [MainThread]: Flushing usage events
[0m16:18:02.594803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:58:41.203074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb898163490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8972a6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8972a6760>]}


============================== 07:58:41.216538 | af9c79f8-1977-4ccf-8532-3d6969a95277 ==============================
[0m07:58:41.216538 [info ] [MainThread]: Running with dbt=1.9.3
[0m07:58:41.219653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:58:41.221562 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m07:58:41.226388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.12589283, "process_in_blocks": "256", "process_kernel_time": 0.219928, "process_mem_max_rss": "86476", "process_out_blocks": "1032", "process_user_time": 3.328914}
[0m07:58:41.228134 [debug] [MainThread]: Command `dbt run` failed at 07:58:41.227810 after 0.13 seconds
[0m07:58:41.229626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb898163490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb897274100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8972ec460>]}
[0m07:58:41.231248 [debug] [MainThread]: Flushing usage events
[0m07:58:41.969512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:59:14.345098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c8748070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882bb0>]}


============================== 07:59:14.349845 | 465fedd8-288c-4292-bec5-9c8d4c421c79 ==============================
[0m07:59:14.349845 [info ] [MainThread]: Running with dbt=1.9.3
[0m07:59:14.351606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:59:14.353631 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt_project/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m07:59:14.356205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08240086, "process_in_blocks": "0", "process_kernel_time": 0.06018, "process_mem_max_rss": "85856", "process_out_blocks": "0", "process_user_time": 1.965887}
[0m07:59:14.357891 [debug] [MainThread]: Command `dbt run` failed at 07:59:14.357676 after 0.08 seconds
[0m07:59:14.358996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c8748070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19c7882c10>]}
[0m07:59:14.360097 [debug] [MainThread]: Flushing usage events
[0m07:59:15.033777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:22.931291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf557e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46baa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46baa60>]}


============================== 08:10:22.935994 | 9dd4aebc-08ea-4897-86f9-68aab2822564 ==============================
[0m08:10:22.935994 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:10:22.937673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:10:22.945073 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:10:22.947300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11184042, "process_in_blocks": "0", "process_kernel_time": 0.169592, "process_mem_max_rss": "85568", "process_out_blocks": "0", "process_user_time": 1.995211}
[0m08:10:22.948484 [debug] [MainThread]: Command `dbt run` failed at 08:10:22.948338 after 0.11 seconds
[0m08:10:22.949363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf557e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46d88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaf46d87c0>]}
[0m08:10:22.950270 [debug] [MainThread]: Flushing usage events
[0m08:10:23.648070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:14:26.874962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00989dd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b19a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b19a60>]}


============================== 08:14:26.879281 | f6f388fe-f19c-4b28-99ad-223fe2885ec6 ==============================
[0m08:14:26.879281 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:14:26.880943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:14:26.887545 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:14:26.889699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09300243, "process_in_blocks": "0", "process_kernel_time": 0.221808, "process_mem_max_rss": "85672", "process_out_blocks": "0", "process_user_time": 2.318908}
[0m08:14:26.890805 [debug] [MainThread]: Command `dbt run` failed at 08:14:26.890619 after 0.09 seconds
[0m08:14:26.891656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00989dd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b378e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0097b377c0>]}
[0m08:14:26.892531 [debug] [MainThread]: Flushing usage events
[0m08:14:27.583189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:33.185575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cca7db0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc99179a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc9917a00>]}


============================== 08:21:33.190094 | 4c1a89ae-186d-49bd-85da-8cb3497754bc ==============================
[0m08:21:33.190094 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:21:33.193002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:21:33.201757 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:21:33.204359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11525663, "process_in_blocks": "0", "process_kernel_time": 0.231786, "process_mem_max_rss": "85736", "process_out_blocks": "0", "process_user_time": 2.378335}
[0m08:21:33.205738 [debug] [MainThread]: Command `dbt run` failed at 08:21:33.205538 after 0.12 seconds
[0m08:21:33.206835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cca7db0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc99512b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ccb777c70>]}
[0m08:21:33.208111 [debug] [MainThread]: Flushing usage events
[0m08:21:33.908795 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:27:59.705122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1813661070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181279da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f181279daf0>]}


============================== 08:27:59.710776 | 40ecb776-a9d4-48ac-b588-b29d0bb40bcd ==============================
[0m08:27:59.710776 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:27:59.712579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:27:59.721709 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:27:59.724280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11375926, "process_in_blocks": "0", "process_kernel_time": 0.302217, "process_mem_max_rss": "85760", "process_out_blocks": "0", "process_user_time": 2.458032}
[0m08:27:59.725559 [debug] [MainThread]: Command `dbt run` failed at 08:27:59.725343 after 0.12 seconds
[0m08:27:59.726573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1813661070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1812aea9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1812827670>]}
[0m08:27:59.727516 [debug] [MainThread]: Flushing usage events
[0m08:28:00.395052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:03.702290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c71fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c6338a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c6338a90>]}


============================== 08:30:03.706818 | f462f67b-3932-48ae-88bd-18edc1ce40d1 ==============================
[0m08:30:03.706818 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:30:03.708285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:30:03.714778 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:30:03.716943 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09467641, "process_in_blocks": "0", "process_kernel_time": 0.177469, "process_mem_max_rss": "85660", "process_out_blocks": "0", "process_user_time": 1.725393}
[0m08:30:03.718105 [debug] [MainThread]: Command `dbt run` failed at 08:30:03.717943 after 0.10 seconds
[0m08:30:03.719047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c71fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c6379190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23c63791c0>]}
[0m08:30:03.719953 [debug] [MainThread]: Flushing usage events
[0m08:30:04.454944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:44.473283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d2b75fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cbcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cbcb20>]}


============================== 08:37:44.477571 | 97f53369-3b7c-466b-aa6b-f21a99ab21c7 ==============================
[0m08:37:44.477571 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:37:44.479263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:37:44.485877 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:37:44.488686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09213368, "process_in_blocks": "0", "process_kernel_time": 0.100663, "process_mem_max_rss": "85700", "process_out_blocks": "0", "process_user_time": 1.852211}
[0m08:37:44.490034 [debug] [MainThread]: Command `dbt run` failed at 08:37:44.489832 after 0.09 seconds
[0m08:37:44.490925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d2b75fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cf60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d1cf6220>]}
[0m08:37:44.491802 [debug] [MainThread]: Flushing usage events
[0m08:37:45.122011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:58.779924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba91b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a5e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a5e790>]}


============================== 08:37:58.791816 | 6beca6c7-dd2c-4008-93cf-fe9bb8b979cb ==============================
[0m08:37:58.791816 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:37:58.794782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:37:58.804857 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:37:58.808661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.17422426, "process_in_blocks": "0", "process_kernel_time": 0.178302, "process_mem_max_rss": "86856", "process_out_blocks": "1032", "process_user_time": 3.338213}
[0m08:37:58.811449 [debug] [MainThread]: Command `dbt run` failed at 08:37:58.811048 after 0.18 seconds
[0m08:37:58.814074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccba91b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a7aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccb9a7aeb0>]}
[0m08:37:58.815784 [debug] [MainThread]: Flushing usage events
[0m08:37:59.564264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:38:17.929112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e852ae160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e843eb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e843eb640>]}


============================== 08:38:17.933843 | ae684d70-c5d7-4e8f-982a-23bbbed84e31 ==============================
[0m08:38:17.933843 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:38:17.936414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:38:17.944232 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:38:17.947078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.105101064, "process_in_blocks": "0", "process_kernel_time": 0.109691, "process_mem_max_rss": "85556", "process_out_blocks": "0", "process_user_time": 1.834835}
[0m08:38:17.948665 [debug] [MainThread]: Command `dbt run` failed at 08:38:17.948394 after 0.11 seconds
[0m08:38:17.949946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e852ae160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e843cea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8442b880>]}
[0m08:38:17.951561 [debug] [MainThread]: Flushing usage events
[0m08:38:18.599340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:45:22.585337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a33560d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a24929a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a2492a00>]}


============================== 08:45:22.589400 | 6c05b58e-be40-4550-9952-f4c2f8cfb129 ==============================
[0m08:45:22.589400 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:45:22.591177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:22.598960 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:45:22.601711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09697239, "process_in_blocks": "0", "process_kernel_time": 0.099321, "process_mem_max_rss": "85936", "process_out_blocks": "0", "process_user_time": 1.956633}
[0m08:45:22.603163 [debug] [MainThread]: Command `dbt run` failed at 08:45:22.603011 after 0.10 seconds
[0m08:45:22.604082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a33560d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a24cc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8a42f3c70>]}
[0m08:45:22.604970 [debug] [MainThread]: Flushing usage events
[0m08:45:23.284753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:42.861048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdaf056400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae19a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae19a790>]}


============================== 08:57:42.868795 | 65f73dc8-f3da-4336-b2bc-053eddae32b5 ==============================
[0m08:57:42.868795 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:57:42.871029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:57:42.879319 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m08:57:42.882137 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11071657, "process_in_blocks": "0", "process_kernel_time": 0.243418, "process_mem_max_rss": "87020", "process_out_blocks": "1032", "process_user_time": 2.363192}
[0m08:57:42.883822 [debug] [MainThread]: Command `dbt run` failed at 08:57:42.883535 after 0.11 seconds
[0m08:57:42.884996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdaf056400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae83f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdae7f4be0>]}
[0m08:57:42.886177 [debug] [MainThread]: Flushing usage events
[0m08:57:43.550051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:02.006091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863e3a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862f0c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862f0c880>]}


============================== 08:59:02.013829 | 6af5ab16-9d77-42f3-a8f7-52945ef89b1b ==============================
[0m08:59:02.013829 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:59:02.015295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:59:02.125524 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m08:59:02.127262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86273ef70>]}
[0m08:59:02.129014 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m08:59:02.130205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd86273ebe0>]}
[0m08:59:02.270270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8623f7df0>]}
[0m08:59:02.342371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8627205b0>]}
[0m08:59:02.344807 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:59:02.436338 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m08:59:02.440120 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:59:02.441738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862331eb0>]}
[0m08:59:03.488267 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mi_proyecto_dbt
[0m08:59:03.496776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd862fc5cd0>]}
[0m08:59:03.561863 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:59:03.568502 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:59:03.604332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8622c85b0>]}
[0m08:59:03.605569 [info ] [MainThread]: Found 433 macros
[0m08:59:03.606923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6af5ab16-9d77-42f3-a8f7-52945ef89b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8622c8400>]}
[0m08:59:03.609523 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:59:03.611765 [debug] [MainThread]: Command end result
[0m08:59:03.646267 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:59:03.650120 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:59:03.657507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:59:03.659102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7357033, "process_in_blocks": "12760", "process_kernel_time": 0.198011, "process_mem_max_rss": "99060", "process_out_blocks": "1104", "process_user_time": 3.514696}
[0m08:59:03.660203 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:03.660062 after 1.74 seconds
[0m08:59:03.661141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863e3a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd863cb5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8623230d0>]}
[0m08:59:03.662081 [debug] [MainThread]: Flushing usage events
[0m08:59:04.361259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:00.103368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249efb6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249e0f9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249e0f95e0>]}


============================== 09:06:00.111047 | 5fa34a31-a625-4012-85ab-8e10beb5b9f4 ==============================
[0m09:06:00.111047 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:06:00.113846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:06:00.380380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249daaaee0>]}
[0m09:06:00.456126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249da738e0>]}
[0m09:06:00.458302 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:00.539782 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:06:00.604086 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:06:00.605733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d321250>]}
[0m09:06:01.667691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.mi_proyecto_dbt
[0m09:06:01.677227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d298100>]}
[0m09:06:01.745347 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:06:01.753174 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:06:01.771825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249cf262e0>]}
[0m09:06:01.772915 [info ] [MainThread]: Found 433 macros
[0m09:06:01.774313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa34a31-a625-4012-85ab-8e10beb5b9f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249cf26280>]}
[0m09:06:01.777167 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:06:01.779357 [debug] [MainThread]: Command end result
[0m09:06:01.814013 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m09:06:01.818420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m09:06:01.825320 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m09:06:01.826932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9203933, "process_in_blocks": "0", "process_kernel_time": 0.278849, "process_mem_max_rss": "99056", "process_out_blocks": "0", "process_user_time": 4.152866}
[0m09:06:01.827937 [debug] [MainThread]: Command `dbt run` succeeded at 09:06:01.827796 after 1.92 seconds
[0m09:06:01.828809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249efb6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249d7f84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249cf26eb0>]}
[0m09:06:01.829749 [debug] [MainThread]: Flushing usage events
[0m09:06:02.463655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:36:31.325590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63446be100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63437fca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63437fca90>]}


============================== 09:36:31.332826 | 3940f095-b91f-4bae-ab20-e8200814c0b3 ==============================
[0m09:36:31.332826 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:36:31.336186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:31.655679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3940f095-b91f-4bae-ab20-e8200814c0b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63457a80a0>]}
[0m09:36:31.760502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3940f095-b91f-4bae-ab20-e8200814c0b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6342fb3310>]}
[0m09:36:31.763281 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:36:31.968051 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:36:32.155710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:36:32.158048 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_temp.sql
[0m09:36:32.621139 [error] [MainThread]: Encountered an error:
Compilation Error in model avg_temp (models/avg_temp.sql)
  expected token ',', got 'string'
    line 2
      materialized='table'  -- o 'view', seg√∫n lo que necesites
[0m09:36:32.624936 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4591527, "process_in_blocks": "288", "process_kernel_time": 0.393416, "process_mem_max_rss": "100332", "process_out_blocks": "0", "process_user_time": 4.912664}
[0m09:36:32.628079 [debug] [MainThread]: Command `dbt run` failed at 09:36:32.627671 after 1.46 seconds
[0m09:36:32.630654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63446be100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63422d46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63422d4820>]}
[0m09:36:32.634513 [debug] [MainThread]: Flushing usage events
[0m09:36:34.351638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:39:04.512538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b2b76490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1cba700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1cba760>]}


============================== 09:39:04.524839 | f0f31df6-9d0d-4a82-a94c-e99752aba4d7 ==============================
[0m09:39:04.524839 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:39:04.527754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select avg_temp', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:39:04.543444 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m09:39:04.547208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1528543, "process_in_blocks": "0", "process_kernel_time": 0.169306, "process_mem_max_rss": "87052", "process_out_blocks": "1032", "process_user_time": 2.449966}
[0m09:39:04.550333 [debug] [MainThread]: Command `dbt run` failed at 09:39:04.549369 after 0.16 seconds
[0m09:39:04.552927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b2b76490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b3b13580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b1d42d30>]}
[0m09:39:04.555630 [debug] [MainThread]: Flushing usage events
[0m09:39:05.600491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:39.590486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdd11e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc25d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdc25d5e0>]}


============================== 09:45:39.597971 | 72570eae-9c7b-43b8-9582-9c336f1a50ea ==============================
[0m09:45:39.597971 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:45:39.603293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:45:39.995671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72570eae-9c7b-43b8-9582-9c336f1a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb9837f0>]}
[0m09:45:40.127144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72570eae-9c7b-43b8-9582-9c336f1a50ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcde0c7f10>]}
[0m09:45:40.129874 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:45:40.370161 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:45:40.582309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:45:40.584521 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_temp.sql
[0m09:45:41.046751 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.mi_proyecto_dbt.avg_temp' (models/avg_temp.sql) depends on a node named 'daily_weather' which was not found
[0m09:45:41.051518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6024543, "process_in_blocks": "200", "process_kernel_time": 0.37003, "process_mem_max_rss": "102524", "process_out_blocks": "0", "process_user_time": 5.020419}
[0m09:45:41.055131 [debug] [MainThread]: Command `dbt run` failed at 09:45:41.054907 after 1.61 seconds
[0m09:45:41.057468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdd11e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb1a6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcdb08d8b0>]}
[0m09:45:41.059678 [debug] [MainThread]: Flushing usage events
[0m09:45:42.297655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:18.715859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4f9d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c40d9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c40d99a0>]}


============================== 09:51:18.723251 | 27e032f6-9268-4034-b651-e4f115c03f5f ==============================
[0m09:51:18.723251 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:51:18.726194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select avg_temp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:51:18.737915 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m09:51:18.741036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.15560716, "process_in_blocks": "0", "process_kernel_time": 0.059823, "process_mem_max_rss": "85628", "process_out_blocks": "0", "process_user_time": 2.333129}
[0m09:51:18.744175 [debug] [MainThread]: Command `dbt run` failed at 09:51:18.743571 after 0.16 seconds
[0m09:51:18.746515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4f9d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4120190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c4120a90>]}
[0m09:51:18.747960 [debug] [MainThread]: Flushing usage events
[0m09:51:19.813226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:10.521947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23269400d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325a7a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325a7a9d0>]}


============================== 10:00:10.528263 | c3c754ed-504f-4d44-b5b5-320edc9e66de ==============================
[0m10:00:10.528263 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:00:10.530733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select avg_temp', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:00:10.543499 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m10:00:10.547179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.1464722, "process_in_blocks": "0", "process_kernel_time": 0.139476, "process_mem_max_rss": "85736", "process_out_blocks": "0", "process_user_time": 3.008702}
[0m10:00:10.549752 [debug] [MainThread]: Command `dbt run` failed at 10:00:10.549386 after 0.15 seconds
[0m10:00:10.552115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23269400d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325ab9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2325a9a2e0>]}
[0m10:00:10.554992 [debug] [MainThread]: Flushing usage events
[0m10:00:11.478482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:23.525280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf73d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf65274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf6527460>]}


============================== 10:05:23.531563 | 8587bc7d-7fad-4d76-ab26-dee69acc6434 ==============================
[0m10:05:23.531563 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:05:23.535210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:05:24.035845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf84dbf70>]}
[0m10:05:24.169797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf5f21a60>]}
[0m10:05:24.172321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:05:24.336426 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:05:24.555818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:05:24.558294 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_temp.sql
[0m10:05:24.560700 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/sources.yml
[0m10:05:25.479416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4ed0eb0>]}
[0m10:05:25.701328 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:05:25.716663 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:05:25.762287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf65701c0>]}
[0m10:05:25.765262 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:05:25.769832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8587bc7d-7fad-4d76-ab26-dee69acc6434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4ee1700>]}
[0m10:05:25.774390 [info ] [MainThread]: 
[0m10:05:25.776890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:05:25.783234 [info ] [MainThread]: 
[0m10:05:25.786761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:25.792243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:05:26.014898 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:05:26.016600 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:05:26.018002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:26.023671 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m10:05:26.026082 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:05:26.027879 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:05:26.029727 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m10:05:26.031670 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m10:05:26.033370 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m10:05:26.035953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:26.037822 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m10:05:26.039712 [info ] [MainThread]: 
[0m10:05:26.042284 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m10:05:26.046231 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m10:05:26.051794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6742857, "process_in_blocks": "2336", "process_kernel_time": 0.412087, "process_mem_max_rss": "112636", "process_out_blocks": "0", "process_user_time": 5.698866}
[0m10:05:26.055202 [debug] [MainThread]: Command `dbt run` failed at 10:05:26.054820 after 2.68 seconds
[0m10:05:26.058425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf73d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4b4fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cf4fec370>]}
[0m10:05:26.062757 [debug] [MainThread]: Flushing usage events
[0m10:05:27.081317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:50.525217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2536100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b1675a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b1675a90>]}


============================== 10:07:50.533586 | 573857a2-2223-4608-a4f2-9ae49fd1667d ==============================
[0m10:07:50.533586 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:07:50.537061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:07:50.836456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b107c5e0>]}
[0m10:07:50.936961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b34d4370>]}
[0m10:07:50.940125 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:07:51.083468 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:07:51.337204 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:07:51.339900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b1d7a670>]}
[0m10:07:53.863441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afde9130>]}
[0m10:07:54.064513 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:07:54.075723 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:07:54.106845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd8d5b0>]}
[0m10:07:54.108980 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:07:54.111294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd8a7f0>]}
[0m10:07:54.121989 [info ] [MainThread]: 
[0m10:07:54.125820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:07:54.128277 [info ] [MainThread]: 
[0m10:07:54.131623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:54.136032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:07:54.248314 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:07:54.250157 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:07:54.251895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:54.278584 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.027 seconds
[0m10:07:54.282202 [debug] [ThreadPool]: On list_airflow: Close
[0m10:07:54.285793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:07:54.300190 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:07:54.301918 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:07:54.303559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:54.311414 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:07:54.318637 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:07:54.321070 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:07:54.330092 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m10:07:54.333728 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:07:54.335963 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:07:54.347101 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.349038 [debug] [MainThread]: On master: BEGIN
[0m10:07:54.351150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:54.357707 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:07:54.365493 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.368316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:54.379158 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m10:07:54.382608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd160d0>]}
[0m10:07:54.384434 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:54.386208 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.388372 [debug] [MainThread]: On master: BEGIN
[0m10:07:54.391230 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:07:54.394275 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.396276 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.397881 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.399819 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:07:54.401372 [debug] [MainThread]: On master: Close
[0m10:07:54.413152 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.415279 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:07:54.418085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_temp)
[0m10:07:54.420729 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.447261 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.464496 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.572389 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.591774 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.593696 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:07:54.595219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:07:54.602088 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m10:07:54.606230 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.608341 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather"  -- Usa la fuente declarada
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:07:54.666782 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.056 seconds
[0m10:07:54.680779 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.682458 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:07:54.685584 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:07:54.736859 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:07:54.739972 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.742490 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:07:54.749784 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m10:07:54.768157 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:07:54.781612 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:07:54.783952 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:07:54.787575 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m10:07:54.795405 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:07:54.801893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573857a2-2223-4608-a4f2-9ae49fd1667d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37af512e50>]}
[0m10:07:54.804469 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7745[0m in 0.38s]
[0m10:07:54.808664 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:07:54.814897 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.816946 [debug] [MainThread]: On master: BEGIN
[0m10:07:54.819146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:54.825811 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:07:54.830435 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.833264 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:54.835717 [debug] [MainThread]: On master: COMMIT
[0m10:07:54.838040 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:07:54.840391 [debug] [MainThread]: On master: Close
[0m10:07:54.842880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:54.844810 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.avg_temp' was properly closed.
[0m10:07:54.846759 [info ] [MainThread]: 
[0m10:07:54.849657 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:07:54.854005 [debug] [MainThread]: Command end result
[0m10:07:55.037280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:07:55.045085 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:07:55.065315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:07:55.067041 [info ] [MainThread]: 
[0m10:07:55.070977 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:55.074771 [info ] [MainThread]: 
[0m10:07:55.078041 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:07:55.082710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.743715, "process_in_blocks": "2968", "process_kernel_time": 0.433107, "process_mem_max_rss": "115804", "process_out_blocks": "16", "process_user_time": 7.695213}
[0m10:07:55.084637 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:55.084349 after 4.75 seconds
[0m10:07:55.086284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b2536100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b107c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37afd8d1f0>]}
[0m10:07:55.088032 [debug] [MainThread]: Flushing usage events
[0m10:07:56.078014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:59.839275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd287e58130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f949a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f94a00>]}


============================== 10:16:59.846297 | d2d7e925-b262-4d97-a9bc-4f0d8dd80805 ==============================
[0m10:16:59.846297 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:16:59.848606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select avg_temp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:59.859489 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'mi_perfil'
[0m10:16:59.863664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.20280935, "process_in_blocks": "0", "process_kernel_time": 0.079806, "process_mem_max_rss": "86036", "process_out_blocks": "0", "process_user_time": 2.384215}
[0m10:16:59.866131 [debug] [MainThread]: Command `dbt run` failed at 10:16:59.865658 after 0.21 seconds
[0m10:16:59.868255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd287e58130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f7b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd286f7bb80>]}
[0m10:16:59.870023 [debug] [MainThread]: Flushing usage events
[0m10:17:01.060499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:30.193372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d7e234f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d6ef68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d6ef6880>]}


============================== 10:33:30.205170 | 361e14e0-c29e-458f-9694-8020b344869b ==============================
[0m10:33:30.205170 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:33:30.207451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:33:30.236268 [info ] [MainThread]: dbt version: 1.9.3
[0m10:33:30.238443 [info ] [MainThread]: python version: 3.9.21
[0m10:33:30.240779 [info ] [MainThread]: python path: /usr/local/bin/python3.9
[0m10:33:30.243048 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m10:33:30.375038 [info ] [MainThread]: Using profiles dir at /usr/app/dbt_project/.dbt
[0m10:33:30.377549 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt_project/.dbt/profiles.yml
[0m10:33:30.379854 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project/dbt_project.yml
[0m10:33:30.382747 [info ] [MainThread]: adapter type: postgres
[0m10:33:30.385391 [info ] [MainThread]: adapter version: 1.9.0
[0m10:33:30.620457 [info ] [MainThread]: Configuration:
[0m10:33:30.623234 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:33:30.625623 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:33:30.627923 [info ] [MainThread]: Required dependencies:
[0m10:33:30.630443 [debug] [MainThread]: Executing "git --help"
[0m10:33:30.639740 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m10:33:30.644210 [info ] [MainThread]: Connection:
[0m10:33:30.648132 [info ] [MainThread]:   host: postgres
[0m10:33:30.651344 [info ] [MainThread]:   port: 5432
[0m10:33:30.653778 [info ] [MainThread]:   user: airflow
[0m10:33:30.656349 [info ] [MainThread]:   database: airflow
[0m10:33:30.658632 [info ] [MainThread]:   schema: pro_raw_api
[0m10:33:30.661843 [info ] [MainThread]:   connect_timeout: 10
[0m10:33:30.666062 [info ] [MainThread]:   role: None
[0m10:33:30.670131 [info ] [MainThread]:   search_path: None
[0m10:33:30.673831 [info ] [MainThread]:   keepalives_idle: 0
[0m10:33:30.676868 [info ] [MainThread]:   sslmode: None
[0m10:33:30.681655 [info ] [MainThread]:   sslcert: None
[0m10:33:30.685622 [info ] [MainThread]:   sslkey: None
[0m10:33:30.688091 [info ] [MainThread]:   sslrootcert: None
[0m10:33:30.690522 [info ] [MainThread]:   application_name: dbt
[0m10:33:30.692956 [info ] [MainThread]:   retries: 1
[0m10:33:30.697026 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:30.882209 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:33:30.936938 [debug] [MainThread]: Using postgres connection "debug"
[0m10:33:30.939164 [debug] [MainThread]: On debug: select 1 as id
[0m10:33:30.941327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:30.953323 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m10:33:30.966970 [debug] [MainThread]: On debug: Close
[0m10:33:30.972124 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:33:30.975501 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:33:30.978563 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m10:33:30.984222 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.9190235, "process_in_blocks": "80", "process_kernel_time": 0.28045, "process_mem_max_rss": "100628", "process_out_blocks": "1048", "process_user_time": 3.08496}
[0m10:33:30.988169 [debug] [MainThread]: Command `dbt debug` failed at 10:33:30.987971 after 0.92 seconds
[0m10:33:30.991555 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:33:30.994490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d7e234f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d6fef880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02d69166d0>]}
[0m10:33:31.014136 [debug] [MainThread]: Flushing usage events
[0m10:33:32.901591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:39.553373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f1c020d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d40a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d40a60>]}


============================== 10:33:39.559352 | ec24c457-45be-4bb6-a101-2aa3cac2606c ==============================
[0m10:33:39.559352 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:33:39.562148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select avg_temp', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:33:39.962611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f074f6a0>]}
[0m10:33:40.070514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d7c040>]}
[0m10:33:40.073102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:40.217175 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:33:40.559491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:40.562680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:40.649354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efb48130>]}
[0m10:33:40.856147 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:33:40.868235 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:33:40.906275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efaf12b0>]}
[0m10:33:40.908706 [info ] [MainThread]: Found 1 model, 1 source, 433 macros
[0m10:33:40.910867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efaf1040>]}
[0m10:33:40.916533 [info ] [MainThread]: 
[0m10:33:40.919308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:40.921915 [info ] [MainThread]: 
[0m10:33:40.925632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:40.930540 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:33:41.012175 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:33:41.014984 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:33:41.016688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:41.024371 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m10:33:41.027956 [debug] [ThreadPool]: On list_airflow: Close
[0m10:33:41.031719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:33:41.045406 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:33:41.047222 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:33:41.048929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:33:41.054697 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:33:41.058233 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:33:41.061134 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:33:41.068503 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m10:33:41.072237 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:33:41.074450 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:33:41.085199 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.087230 [debug] [MainThread]: On master: BEGIN
[0m10:33:41.088925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:41.095204 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m10:33:41.097383 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.099641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:41.106294 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:33:41.110120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7ef312280>]}
[0m10:33:41.112453 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:41.114653 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.116602 [debug] [MainThread]: On master: BEGIN
[0m10:33:41.119367 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:33:41.122602 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.124411 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.126568 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.128949 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:41.130773 [debug] [MainThread]: On master: Close
[0m10:33:41.145565 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.148521 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:33:41.151070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_temp)
[0m10:33:41.153068 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.182240 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.193754 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.293471 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.304230 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.305813 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:33:41.307562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:41.313726 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m10:33:41.316795 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.318659 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather"  -- Usa la fuente declarada
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:33:41.361774 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.040 seconds
[0m10:33:41.374759 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.376609 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m10:33:41.378820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:41.385857 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.387478 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:33:41.389654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:41.427232 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:33:41.428966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.430459 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:33:41.436115 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m10:33:41.450687 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:33:41.464421 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:33:41.466929 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:33:41.475833 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m10:33:41.481732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:33:41.485992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec24c457-45be-4bb6-a101-2aa3cac2606c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f2d36730>]}
[0m10:33:41.488082 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7745[0m in 0.33s]
[0m10:33:41.490657 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:33:41.494627 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.496299 [debug] [MainThread]: On master: BEGIN
[0m10:33:41.498174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:41.505614 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:33:41.508254 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.510507 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:41.512826 [debug] [MainThread]: On master: COMMIT
[0m10:33:41.515247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:41.517204 [debug] [MainThread]: On master: Close
[0m10:33:41.519717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:41.522604 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.avg_temp' was properly closed.
[0m10:33:41.524816 [info ] [MainThread]: 
[0m10:33:41.527544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m10:33:41.530900 [debug] [MainThread]: Command end result
[0m10:33:41.608275 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:33:41.618332 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:33:41.637773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:33:41.639931 [info ] [MainThread]: 
[0m10:33:41.642675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:41.644819 [info ] [MainThread]: 
[0m10:33:41.647309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:33:41.650925 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.245675, "process_in_blocks": "0", "process_kernel_time": 0.24375, "process_mem_max_rss": "108628", "process_out_blocks": "72", "process_user_time": 3.879693}
[0m10:33:41.654685 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:41.654150 after 2.25 seconds
[0m10:33:41.659155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f1c020d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7efafb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7f0d7c040>]}
[0m10:33:41.664007 [debug] [MainThread]: Flushing usage events
[0m10:33:42.733891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:36:11.577503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b496050d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b48742a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b48742a60>]}


============================== 10:36:11.587634 | a5df247a-8dcd-4e56-8ad5-9625e9b187a6 ==============================
[0m10:36:11.587634 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:36:11.590200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select avg_hum', 'send_anonymous_usage_stats': 'True'}
[0m10:36:11.896603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b481526a0>]}
[0m10:36:12.040429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b4877f040>]}
[0m10:36:12.044088 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:36:12.211980 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:36:12.626894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:36:12.636278 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/avg_hum.sql
[0m10:36:13.227602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b471b2130>]}
[0m10:36:13.403264 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:36:13.415442 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:36:13.446786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b49854940>]}
[0m10:36:13.449141 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m10:36:13.451713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b471e7100>]}
[0m10:36:13.456138 [info ] [MainThread]: 
[0m10:36:13.458442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:36:13.460854 [info ] [MainThread]: 
[0m10:36:13.464368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:36:13.468234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:36:13.534726 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:36:13.536700 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:36:13.538971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:36:13.547483 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m10:36:13.551135 [debug] [ThreadPool]: On list_airflow: Close
[0m10:36:13.562421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:36:13.575223 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:36:13.577116 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:36:13.578825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:36:13.585003 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:36:13.587922 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:36:13.591471 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:36:13.599936 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m10:36:13.603148 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:36:13.605350 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:36:13.616579 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.618608 [debug] [MainThread]: On master: BEGIN
[0m10:36:13.620433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:36:13.627028 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:36:13.629775 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.631965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:36:13.639678 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m10:36:13.643357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b4814af10>]}
[0m10:36:13.645133 [debug] [MainThread]: On master: ROLLBACK
[0m10:36:13.646746 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.648084 [debug] [MainThread]: On master: BEGIN
[0m10:36:13.650129 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:36:13.653038 [debug] [MainThread]: On master: COMMIT
[0m10:36:13.655583 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:13.658226 [debug] [MainThread]: On master: COMMIT
[0m10:36:13.660484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:13.662413 [debug] [MainThread]: On master: Close
[0m10:36:13.667936 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m10:36:13.669849 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m10:36:13.672496 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m10:36:13.674471 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m10:36:13.698481 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.714792 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m10:36:13.875876 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.889746 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.892186 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m10:36:13.894278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:36:13.901258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m10:36:13.903802 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.907996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  -- Usa la fuente declarada
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:36:13.954275 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.043 seconds
[0m10:36:13.970132 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:13.972993 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m10:36:13.975959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:36:14.027746 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:36:14.029510 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:14.031090 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:36:14.033801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:36:14.048127 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m10:36:14.058844 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:36:14.060731 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m10:36:14.062749 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m10:36:14.068648 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m10:36:14.073744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5df247a-8dcd-4e56-8ad5-9625e9b187a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b468b8130>]}
[0m10:36:14.076353 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7745[0m in 0.40s]
[0m10:36:14.079231 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m10:36:14.083086 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:14.084728 [debug] [MainThread]: On master: BEGIN
[0m10:36:14.086210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:36:14.093628 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:36:14.097014 [debug] [MainThread]: On master: COMMIT
[0m10:36:14.099466 [debug] [MainThread]: Using postgres connection "master"
[0m10:36:14.102022 [debug] [MainThread]: On master: COMMIT
[0m10:36:14.104458 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:36:14.107798 [debug] [MainThread]: On master: Close
[0m10:36:14.111183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:36:14.113579 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.avg_hum' was properly closed.
[0m10:36:14.115446 [info ] [MainThread]: 
[0m10:36:14.117535 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m10:36:14.121497 [debug] [MainThread]: Command end result
[0m10:36:14.221089 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:36:14.230832 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:36:14.250002 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:36:14.251678 [info ] [MainThread]: 
[0m10:36:14.254254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:36:14.256755 [info ] [MainThread]: 
[0m10:36:14.259399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:36:14.263534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8200166, "process_in_blocks": "0", "process_kernel_time": 0.148276, "process_mem_max_rss": "115144", "process_out_blocks": "0", "process_user_time": 4.547155}
[0m10:36:14.266823 [debug] [MainThread]: Command `dbt run` succeeded at 10:36:14.266397 after 2.82 seconds
[0m10:36:14.269247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b496050d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b495057f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b49480b80>]}
[0m10:36:14.271601 [debug] [MainThread]: Flushing usage events
[0m10:36:15.306806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:22.190265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf311b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf2258a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf2258ac0>]}


============================== 11:12:22.197602 | 8e1a6854-d019-4a45-9978-716b014852ee ==============================
[0m11:12:22.197602 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:12:22.199124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select precip_day', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:12:22.410804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf4212fd0>]}
[0m11:12:22.481294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf28bb070>]}
[0m11:12:22.483117 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:12:22.569558 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:12:22.774303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m11:12:22.775934 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/precip_day.sql
[0m11:12:22.777226 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/avg_temp.sql
[0m11:12:22.778495 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/avg_hum.sql
[0m11:12:23.172106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0caf100>]}
[0m11:12:23.317180 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:12:23.323535 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:12:23.341523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0c5d2b0>]}
[0m11:12:23.342854 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m11:12:23.344162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf0caf430>]}
[0m11:12:23.347237 [info ] [MainThread]: 
[0m11:12:23.348591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:23.349750 [info ] [MainThread]: 
[0m11:12:23.351598 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:23.353903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:12:23.402811 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:12:23.404319 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:12:23.405396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:23.412436 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m11:12:23.414812 [debug] [ThreadPool]: On list_airflow: Close
[0m11:12:23.421923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:12:23.430955 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:12:23.432129 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:12:23.433094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:23.437130 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:12:23.439503 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:12:23.440716 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:12:23.445052 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m11:12:23.447250 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:12:23.448320 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:12:23.454677 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.455791 [debug] [MainThread]: On master: BEGIN
[0m11:12:23.456680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:23.460142 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:12:23.461703 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.462735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:23.466241 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:12:23.468302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf19d1eb0>]}
[0m11:12:23.469285 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:23.470254 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.470962 [debug] [MainThread]: On master: BEGIN
[0m11:12:23.471934 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:12:23.473332 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.474517 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.475327 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.476241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:23.476937 [debug] [MainThread]: On master: Close
[0m11:12:23.479812 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m11:12:23.481379 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m11:12:23.482806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.precip_day)
[0m11:12:23.483872 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m11:12:23.553072 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.561925 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m11:12:23.612252 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.619718 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.621034 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m11:12:23.622192 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:12:23.629041 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:12:23.630991 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.632267 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m11:12:23.663606 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.030 seconds
[0m11:12:23.672243 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.673665 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m11:12:23.675491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:12:23.697853 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:12:23.699381 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.700648 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:12:23.707251 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m11:12:23.715922 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m11:12:23.722119 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:12:23.723529 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m11:12:23.725258 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m11:12:23.729095 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m11:12:23.732007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e1a6854-d019-4a45-9978-716b014852ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf017f670>]}
[0m11:12:23.733622 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.25s]
[0m11:12:23.735409 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m11:12:23.737819 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.738645 [debug] [MainThread]: On master: BEGIN
[0m11:12:23.739389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:23.742668 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:12:23.744237 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.745752 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:23.746873 [debug] [MainThread]: On master: COMMIT
[0m11:12:23.748444 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:23.749953 [debug] [MainThread]: On master: Close
[0m11:12:23.751065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:23.751860 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m11:12:23.752771 [info ] [MainThread]: 
[0m11:12:23.753777 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:12:23.755337 [debug] [MainThread]: Command end result
[0m11:12:23.796011 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:12:23.800572 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:12:23.813497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:12:23.814411 [info ] [MainThread]: 
[0m11:12:23.815609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:23.816867 [info ] [MainThread]: 
[0m11:12:23.818124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:12:23.820183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7213558, "process_in_blocks": "0", "process_kernel_time": 0.269373, "process_mem_max_rss": "113488", "process_out_blocks": "0", "process_user_time": 2.723668}
[0m11:12:23.821441 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:23.821290 after 1.72 seconds
[0m11:12:23.822607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf311b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf3637ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf28bb070>]}
[0m11:12:23.823878 [debug] [MainThread]: Flushing usage events
[0m11:12:24.541277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:19.765860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68e2ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68d42e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68d42e610>]}


============================== 11:36:19.770108 | c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65 ==============================
[0m11:36:19.770108 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:36:19.771862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select max_wind', 'send_anonymous_usage_stats': 'True'}
[0m11:36:19.970090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68d449670>]}
[0m11:36:20.041829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68cb82af0>]}
[0m11:36:20.043703 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:36:20.129900 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:36:20.334537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:36:20.335829 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/max_wind.sql
[0m11:36:20.678852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be9fe80>]}
[0m11:36:20.792695 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:36:20.799738 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:36:20.817156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be88700>]}
[0m11:36:20.818369 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:36:20.819526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be88a90>]}
[0m11:36:20.821934 [info ] [MainThread]: 
[0m11:36:20.823284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:20.824345 [info ] [MainThread]: 
[0m11:36:20.826129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:36:20.828990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:36:20.868079 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:36:20.869708 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:36:20.870945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:20.875857 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m11:36:20.878498 [debug] [ThreadPool]: On list_airflow: Close
[0m11:36:20.886101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:36:20.894085 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:36:20.895325 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:36:20.896420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:20.900196 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:36:20.902315 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:36:20.903457 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:36:20.906637 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m11:36:20.908817 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:36:20.909753 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:36:20.916614 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.917665 [debug] [MainThread]: On master: BEGIN
[0m11:36:20.918528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:20.921948 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:36:20.923814 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.924849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:36:20.928262 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:36:20.930501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68be808b0>]}
[0m11:36:20.931564 [debug] [MainThread]: On master: ROLLBACK
[0m11:36:20.932560 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.933330 [debug] [MainThread]: On master: BEGIN
[0m11:36:20.934310 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:36:20.935501 [debug] [MainThread]: On master: COMMIT
[0m11:36:20.936656 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:20.937481 [debug] [MainThread]: On master: COMMIT
[0m11:36:20.938708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:20.939518 [debug] [MainThread]: On master: Close
[0m11:36:20.942551 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:36:20.943845 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:36:20.945626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:36:20.946760 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:36:21.008106 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.017216 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:36:21.076121 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.084150 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.085143 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:36:21.086028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:36:21.089437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:36:21.091085 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.092412 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT MAX(wind_kph) AS max_wind
    FROM base
)

SELECT b.*
FROM base b
JOIN max_wind m ON b.wind_kph = m.max_wind
  );
  
[0m11:36:21.111448 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.018 seconds
[0m11:36:21.120246 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.121545 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:36:21.122916 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:36:21.144962 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:36:21.146390 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.147628 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:36:21.150186 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:36:21.158419 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:36:21.164626 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:36:21.166095 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:36:21.167642 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m11:36:21.171252 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:36:21.174089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6fc987c-bfc2-4e0a-8ff4-44f4aed74a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68b381c70>]}
[0m11:36:21.175791 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 1[0m in 0.23s]
[0m11:36:21.177375 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:36:21.179813 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.180891 [debug] [MainThread]: On master: BEGIN
[0m11:36:21.181747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:21.185203 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:36:21.187766 [debug] [MainThread]: On master: COMMIT
[0m11:36:21.188766 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.189540 [debug] [MainThread]: On master: COMMIT
[0m11:36:21.190672 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:36:21.191436 [debug] [MainThread]: On master: Close
[0m11:36:21.192493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:21.193336 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:36:21.194359 [info ] [MainThread]: 
[0m11:36:21.196100 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:36:21.198361 [debug] [MainThread]: Command end result
[0m11:36:21.237182 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:36:21.241645 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:36:21.253962 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:36:21.254866 [info ] [MainThread]: 
[0m11:36:21.256189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:21.257481 [info ] [MainThread]: 
[0m11:36:21.258658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:36:21.260567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.577967, "process_in_blocks": "0", "process_kernel_time": 0.109662, "process_mem_max_rss": "113004", "process_out_blocks": "0", "process_user_time": 2.601985}
[0m11:36:21.261855 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:21.261656 after 1.58 seconds
[0m11:36:21.262852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68e2ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa690e51880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68e587d30>]}
[0m11:36:21.263846 [debug] [MainThread]: Flushing usage events
[0m11:36:21.947467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:06.097082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8076df9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8075f3c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8075f3c640>]}


============================== 11:37:06.102559 | d1f1b01f-468d-4e71-bf57-b71595e2aa0d ==============================
[0m11:37:06.102559 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:37:06.104196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select max_wind', 'send_anonymous_usage_stats': 'True'}
[0m11:37:06.337547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8075951c70>]}
[0m11:37:06.411915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80799ba8b0>]}
[0m11:37:06.413730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:37:06.497939 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:37:06.677332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:06.678585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:06.728783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d50130>]}
[0m11:37:06.843228 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:06.848971 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:06.867079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d76700>]}
[0m11:37:06.868556 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:37:06.869695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d769a0>]}
[0m11:37:06.872043 [info ] [MainThread]: 
[0m11:37:06.873545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:06.874874 [info ] [MainThread]: 
[0m11:37:06.876632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:37:06.879427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:37:06.920393 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:37:06.922807 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:37:06.925062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:06.930631 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m11:37:06.932964 [debug] [ThreadPool]: On list_airflow: Close
[0m11:37:06.940463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:37:06.949045 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:06.950303 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:37:06.951346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:06.954959 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:37:06.956790 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:06.957863 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:37:06.961153 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m11:37:06.963402 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:37:06.964441 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:37:06.972007 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.973043 [debug] [MainThread]: On master: BEGIN
[0m11:37:06.973882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:06.977451 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m11:37:06.978860 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.980143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:37:06.983534 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:37:06.985486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d4d1f0>]}
[0m11:37:06.986435 [debug] [MainThread]: On master: ROLLBACK
[0m11:37:06.987479 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.988260 [debug] [MainThread]: On master: BEGIN
[0m11:37:06.989359 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:37:06.990701 [debug] [MainThread]: On master: COMMIT
[0m11:37:06.991826 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:06.992918 [debug] [MainThread]: On master: COMMIT
[0m11:37:06.993903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:06.994777 [debug] [MainThread]: On master: Close
[0m11:37:06.997751 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:37:06.998873 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:37:07.000057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:37:07.001082 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:37:07.013026 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.017953 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:37:07.066559 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.073800 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.074856 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:37:07.075670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:07.079024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:37:07.080735 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.081831 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT MAX(wind_kph) AS max_wind
    FROM base
)

SELECT b.*
FROM base b
JOIN max_wind m ON b.wind_kph = m.max_wind
  );
  
[0m11:37:07.100308 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.017 seconds
[0m11:37:07.108966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.110435 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:37:07.111877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:07.116690 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.117993 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:37:07.119573 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:07.144732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:07.145988 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.147101 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:07.149903 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:37:07.159400 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:37:07.165539 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:07.166788 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:37:07.170980 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:37:07.174841 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:37:07.177728 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f1b01f-468d-4e71-bf57-b71595e2aa0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8077ee2e50>]}
[0m11:37:07.179319 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 1[0m in 0.18s]
[0m11:37:07.180808 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:37:07.182950 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:07.183863 [debug] [MainThread]: On master: BEGIN
[0m11:37:07.184731 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:07.188057 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:37:07.189664 [debug] [MainThread]: On master: COMMIT
[0m11:37:07.190684 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:07.191464 [debug] [MainThread]: On master: COMMIT
[0m11:37:07.192725 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:07.194241 [debug] [MainThread]: On master: Close
[0m11:37:07.196254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:07.197489 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:37:07.198459 [info ] [MainThread]: 
[0m11:37:07.199594 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m11:37:07.201380 [debug] [MainThread]: Command end result
[0m11:37:07.244128 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:07.250168 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:07.267561 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:37:07.269259 [info ] [MainThread]: 
[0m11:37:07.271332 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:07.273756 [info ] [MainThread]: 
[0m11:37:07.276090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:37:07.279549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3109016, "process_in_blocks": "0", "process_kernel_time": 0.107261, "process_mem_max_rss": "108728", "process_out_blocks": "0", "process_user_time": 2.554773}
[0m11:37:07.281593 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:07.281292 after 1.31 seconds
[0m11:37:07.283302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8076df9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8074d50910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80750813d0>]}
[0m11:37:07.284949 [debug] [MainThread]: Flushing usage events
[0m11:37:07.989883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:46.569575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00f5e4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e722970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e7229d0>]}


============================== 11:37:46.573548 | 2d552c37-6dd8-4bd9-88ef-4b54dfec5a92 ==============================
[0m11:37:46.573548 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:37:46.575002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select max_wind', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:46.774115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e1299d0>]}
[0m11:37:46.846061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00e700fa0>]}
[0m11:37:46.847715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:37:46.933870 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:37:47.121514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:37:47.122699 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:37:47.174734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d552130>]}
[0m11:37:47.295845 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:47.302122 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:47.320000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d578880>]}
[0m11:37:47.321290 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:37:47.322307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d578c10>]}
[0m11:37:47.325004 [info ] [MainThread]: 
[0m11:37:47.326396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:47.327492 [info ] [MainThread]: 
[0m11:37:47.329260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:37:47.331952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:37:47.377059 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:37:47.378596 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:37:47.379886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:47.385766 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m11:37:47.388918 [debug] [ThreadPool]: On list_airflow: Close
[0m11:37:47.396802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:37:47.406964 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:47.408895 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:37:47.410519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:47.414940 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:37:47.416726 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:37:47.418387 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:37:47.422222 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m11:37:47.424915 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:37:47.426365 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:37:47.434232 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.435606 [debug] [MainThread]: On master: BEGIN
[0m11:37:47.436630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:47.440148 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:37:47.442371 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.443563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:37:47.446897 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:37:47.448819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00d559b20>]}
[0m11:37:47.449756 [debug] [MainThread]: On master: ROLLBACK
[0m11:37:47.450910 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.452110 [debug] [MainThread]: On master: BEGIN
[0m11:37:47.453306 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:37:47.454611 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.455730 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.456587 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.457637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:47.458836 [debug] [MainThread]: On master: Close
[0m11:37:47.462058 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:37:47.463287 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:37:47.464572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:37:47.465580 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:37:47.477555 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.482904 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:37:47.537078 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.544183 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.545299 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:37:47.546224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:37:47.549606 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:37:47.552638 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.553800 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT MAX(wind_kph) AS max_wind
    FROM base
)

SELECT b.*
FROM base b
JOIN max_wind m ON b.wind_kph = m.max_wind
  );
  
[0m11:37:47.573691 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.019 seconds
[0m11:37:47.583881 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.585370 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:37:47.587083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:47.592513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.593941 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:37:47.595485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:37:47.625518 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:47.626740 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.627652 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:37:47.629830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:37:47.639457 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:37:47.646496 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:37:47.647634 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:37:47.650540 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:37:47.654791 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:37:47.657474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d552c37-6dd8-4bd9-88ef-4b54dfec5a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0106cde20>]}
[0m11:37:47.659294 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 1[0m in 0.19s]
[0m11:37:47.660619 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:37:47.662570 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.663458 [debug] [MainThread]: On master: BEGIN
[0m11:37:47.664183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:37:47.667737 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:37:47.669390 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.670480 [debug] [MainThread]: Using postgres connection "master"
[0m11:37:47.671307 [debug] [MainThread]: On master: COMMIT
[0m11:37:47.672287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:37:47.673181 [debug] [MainThread]: On master: Close
[0m11:37:47.675150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:47.676983 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:37:47.678127 [info ] [MainThread]: 
[0m11:37:47.679348 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:37:47.681017 [debug] [MainThread]: Command end result
[0m11:37:47.721953 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:37:47.727646 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:37:47.743464 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:37:47.744586 [info ] [MainThread]: 
[0m11:37:47.746159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:47.747445 [info ] [MainThread]: 
[0m11:37:47.748804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:37:47.751291 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2718109, "process_in_blocks": "0", "process_kernel_time": 0.100844, "process_mem_max_rss": "108264", "process_out_blocks": "0", "process_user_time": 2.430356}
[0m11:37:47.753899 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:47.753584 after 1.27 seconds
[0m11:37:47.755561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00f5e4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00f467d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00fb51eb0>]}
[0m11:37:47.757237 [debug] [MainThread]: Flushing usage events
[0m11:37:48.432232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:44.864950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0977080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb096845a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb096845a60>]}


============================== 11:38:44.869291 | 714ded9f-4387-4cc4-899c-de9da1e4a053 ==============================
[0m11:38:44.869291 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:38:44.870525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select max_wind', 'send_anonymous_usage_stats': 'True'}
[0m11:38:45.066359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095fd96a0>]}
[0m11:38:45.136337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb096882040>]}
[0m11:38:45.138524 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:38:45.220874 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:38:45.409505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:45.411095 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_wind.sql
[0m11:38:45.740727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0952a1e20>]}
[0m11:38:45.857652 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:38:45.863476 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:38:45.880981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095680130>]}
[0m11:38:45.882161 [info ] [MainThread]: Found 4 models, 1 source, 433 macros
[0m11:38:45.883397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095651760>]}
[0m11:38:45.885960 [info ] [MainThread]: 
[0m11:38:45.887302 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:45.888640 [info ] [MainThread]: 
[0m11:38:45.890360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:45.892269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:38:45.931551 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:38:45.932923 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:38:45.933938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:45.939327 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m11:38:45.942744 [debug] [ThreadPool]: On list_airflow: Close
[0m11:38:45.949983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:38:45.960526 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:38:45.961902 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:38:45.963024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:45.966768 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:38:45.968519 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:38:45.969674 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:38:45.973562 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m11:38:45.976105 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:38:45.977274 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:38:45.984096 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:45.985303 [debug] [MainThread]: On master: BEGIN
[0m11:38:45.986270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:45.989796 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:38:45.991177 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:45.992629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:38:45.995851 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:38:45.997683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095280130>]}
[0m11:38:45.998689 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:45.999647 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.000378 [debug] [MainThread]: On master: BEGIN
[0m11:38:46.001514 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:38:46.002815 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.003983 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.005113 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.006071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:46.006907 [debug] [MainThread]: On master: Close
[0m11:38:46.009702 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:38:46.010839 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:38:46.012022 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_wind)
[0m11:38:46.013089 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:38:46.074957 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.083804 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:38:46.135238 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.143728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.144781 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:38:46.145726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:38:46.149169 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m11:38:46.151135 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.152328 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m11:38:46.174526 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.019 seconds
[0m11:38:46.183022 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.184469 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:38:46.186767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:38:46.191706 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.193014 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:38:46.194628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:38:46.219082 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:38:46.220368 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.221720 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:38:46.224447 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:38:46.232794 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:38:46.239255 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:38:46.240780 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:38:46.244472 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:38:46.248541 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:38:46.251436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '714ded9f-4387-4cc4-899c-de9da1e4a053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb09478bdc0>]}
[0m11:38:46.253206 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.24s]
[0m11:38:46.254869 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:38:46.257131 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.258048 [debug] [MainThread]: On master: BEGIN
[0m11:38:46.258841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:46.262060 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:38:46.264049 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.265188 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:46.266264 [debug] [MainThread]: On master: COMMIT
[0m11:38:46.267798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:38:46.268835 [debug] [MainThread]: On master: Close
[0m11:38:46.269925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:46.271077 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_wind' was properly closed.
[0m11:38:46.272489 [info ] [MainThread]: 
[0m11:38:46.274308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:38:46.276308 [debug] [MainThread]: Command end result
[0m11:38:46.314816 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:38:46.319111 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:38:46.332144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:38:46.333138 [info ] [MainThread]: 
[0m11:38:46.334328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:46.335701 [info ] [MainThread]: 
[0m11:38:46.336953 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:38:46.339420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5541111, "process_in_blocks": "0", "process_kernel_time": 0.100085, "process_mem_max_rss": "113672", "process_out_blocks": "0", "process_user_time": 2.74235}
[0m11:38:46.341275 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:46.341008 after 1.56 seconds
[0m11:38:46.342860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0977080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb097583b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb095357310>]}
[0m11:38:46.344323 [debug] [MainThread]: Flushing usage events
[0m11:38:46.991870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:31.856745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78139a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812ae85e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812ae8580>]}


============================== 11:56:31.861352 | 5f3120dd-6ed5-4aac-84e5-66d25039b217 ==============================
[0m11:56:31.861352 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:56:31.863052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select min_temp', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:32.082178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7812554430>]}
[0m11:56:32.153886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78124ea610>]}
[0m11:56:32.155732 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:56:32.239067 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:56:32.436103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:56:32.437329 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/min_temp.sql
[0m11:56:32.764984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7811562100>]}
[0m11:56:32.888484 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:56:32.896872 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:56:32.913443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78118d7730>]}
[0m11:56:32.914705 [info ] [MainThread]: Found 5 models, 1 source, 433 macros
[0m11:56:32.916055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7813c3d040>]}
[0m11:56:32.918763 [info ] [MainThread]: 
[0m11:56:32.920454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:32.921721 [info ] [MainThread]: 
[0m11:56:32.923751 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:56:32.926284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:56:32.977709 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:56:32.979062 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:56:32.980200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:32.988342 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m11:56:32.990908 [debug] [ThreadPool]: On list_airflow: Close
[0m11:56:33.000351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:56:33.014307 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:56:33.015767 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:56:33.016967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:33.021166 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m11:56:33.023067 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:56:33.024570 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:56:33.028150 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m11:56:33.030543 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:56:33.031869 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:56:33.039123 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.040362 [debug] [MainThread]: On master: BEGIN
[0m11:56:33.042143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:33.046184 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m11:56:33.048171 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.049316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:56:33.052626 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m11:56:33.054699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7811527520>]}
[0m11:56:33.055777 [debug] [MainThread]: On master: ROLLBACK
[0m11:56:33.056892 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.057881 [debug] [MainThread]: On master: BEGIN
[0m11:56:33.059367 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:56:33.061988 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.063235 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.064305 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.065511 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:56:33.066552 [debug] [MainThread]: On master: Close
[0m11:56:33.069929 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m11:56:33.071167 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m11:56:33.072364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.min_temp)
[0m11:56:33.073669 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m11:56:33.140110 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.150567 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m11:56:33.201595 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.209018 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.210044 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m11:56:33.210901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:56:33.215116 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m11:56:33.217203 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.218422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m11:56:33.239857 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.020 seconds
[0m11:56:33.248995 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.250432 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m11:56:33.251905 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:56:33.274455 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:56:33.275873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.277156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:56:33.280019 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:56:33.288364 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m11:56:33.294608 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:56:33.296140 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m11:56:33.297737 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m11:56:33.301450 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m11:56:33.304313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f3120dd-6ed5-4aac-84e5-66d25039b217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7810cfee80>]}
[0m11:56:33.306040 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.23s]
[0m11:56:33.307518 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m11:56:33.309763 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.310587 [debug] [MainThread]: On master: BEGIN
[0m11:56:33.311378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:33.314665 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m11:56:33.316260 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.317194 [debug] [MainThread]: Using postgres connection "master"
[0m11:56:33.317945 [debug] [MainThread]: On master: COMMIT
[0m11:56:33.318994 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:56:33.319787 [debug] [MainThread]: On master: Close
[0m11:56:33.320709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:33.322022 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.min_temp' was properly closed.
[0m11:56:33.323027 [info ] [MainThread]: 
[0m11:56:33.324573 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:56:33.326654 [debug] [MainThread]: Command end result
[0m11:56:33.372962 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:56:33.377896 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:56:33.391938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:56:33.393022 [info ] [MainThread]: 
[0m11:56:33.394446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:33.395755 [info ] [MainThread]: 
[0m11:56:33.397630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:33.400949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6363599, "process_in_blocks": "0", "process_kernel_time": 0.139162, "process_mem_max_rss": "115368", "process_out_blocks": "0", "process_user_time": 2.723602}
[0m11:56:33.402663 [debug] [MainThread]: Command `dbt run` succeeded at 11:56:33.402385 after 1.64 seconds
[0m11:56:33.404651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78139a5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7813816730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78121f9f40>]}
[0m11:56:33.406094 [debug] [MainThread]: Flushing usage events
[0m11:56:34.079665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:43.364162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26968f51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695a33940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695a339a0>]}


============================== 13:29:43.371552 | 7b8db37a-f0f2-40b4-a643-c8502a90d760 ==============================
[0m13:29:43.371552 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:29:43.373984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select max_temp_summer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:29:43.684483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269673d4f0>]}
[0m13:29:43.782142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695ab9ac0>]}
[0m13:29:43.784824 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:29:43.974510 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:29:44.426203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:29:44.428664 [debug] [MainThread]: Partial parsing: added file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m13:29:44.430956 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/sources.yml
[0m13:29:45.174822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269419e130>]}
[0m13:29:45.372251 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:29:45.385289 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:29:45.423506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2694898820>]}
[0m13:29:45.426069 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m13:29:45.428184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695111c70>]}
[0m13:29:45.431936 [info ] [MainThread]: 
[0m13:29:45.433967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:45.436683 [info ] [MainThread]: 
[0m13:29:45.440172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:45.444879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:29:45.608412 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:29:45.610379 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:29:45.611977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:45.625583 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:29:45.629199 [debug] [ThreadPool]: On list_airflow: Close
[0m13:29:45.639728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m13:29:45.651100 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:29:45.653104 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m13:29:45.655012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:45.661347 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:29:45.664224 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:29:45.666534 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m13:29:45.675107 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m13:29:45.678895 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m13:29:45.681375 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m13:29:45.694107 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.696397 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.698485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:45.705079 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:29:45.708042 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.710978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:29:45.718649 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:29:45.721828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26941fe280>]}
[0m13:29:45.723836 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:45.726154 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.727928 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.730551 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:29:45.733083 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.736071 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.738237 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.741353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:29:45.743244 [debug] [MainThread]: On master: Close
[0m13:29:45.748882 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.750608 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m13:29:45.752687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_temp_summer)
[0m13:29:45.754403 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.773823 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.794309 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.883521 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.900593 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.902798 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m13:29:45.904918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:45.911732 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:29:45.914952 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:29:45.917580 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM date) AS year,
        MAX(temp_max) AS max_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM b.date) = m.year
    AND b.temp_max = m.max_temp
  );
  
[0m13:29:45.924563 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function pg_catalog.date_part(unknown, text) does not exist
LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:29:45.941961 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m13:29:45.949766 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m13:29:45.966290 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  function pg_catalog.date_part(unknown, text) does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:29:45.970459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8db37a-f0f2-40b4-a643-c8502a90d760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2694d88550>]}
[0m13:29:45.972683 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.22s]
[0m13:29:45.975845 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m13:29:45.978314 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  function pg_catalog.date_part(unknown, text) does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m13:29:45.982072 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.983782 [debug] [MainThread]: On master: BEGIN
[0m13:29:45.985246 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:45.990609 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:29:45.993344 [debug] [MainThread]: On master: COMMIT
[0m13:29:45.996015 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:45.998470 [debug] [MainThread]: On master: COMMIT
[0m13:29:46.002081 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:29:46.005626 [debug] [MainThread]: On master: Close
[0m13:29:46.008045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:46.009989 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_temp_summer' was properly closed.
[0m13:29:46.014618 [info ] [MainThread]: 
[0m13:29:46.018619 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m13:29:46.023158 [debug] [MainThread]: Command end result
[0m13:29:46.142440 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:29:46.152324 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:29:46.174240 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:29:46.176205 [info ] [MainThread]: 
[0m13:29:46.178526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:29:46.180621 [info ] [MainThread]: 
[0m13:29:46.183090 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  function pg_catalog.date_part(unknown, text) does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM date) IN (6, 7, 8)
                     ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:29:46.185692 [info ] [MainThread]: 
[0m13:29:46.188916 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:29:46.194048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.966617, "process_in_blocks": "432", "process_kernel_time": 0.480688, "process_mem_max_rss": "113656", "process_out_blocks": "0", "process_user_time": 4.376269}
[0m13:29:46.197224 [debug] [MainThread]: Command `dbt run` failed at 13:29:46.196593 after 2.97 seconds
[0m13:29:46.202095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26968f51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695ab9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2696dcc340>]}
[0m13:29:46.205573 [debug] [MainThread]: Flushing usage events
[0m13:29:47.202177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:51.247583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46eff100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4603d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4603da30>]}


============================== 13:31:51.255031 | 967a7b87-fce8-498e-8171-ccef9953b6d9 ==============================
[0m13:31:51.255031 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:31:51.257442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select max_temp_summer', 'send_anonymous_usage_stats': 'True'}
[0m13:31:51.685225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b45782b20>]}
[0m13:31:51.818417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46559dc0>]}
[0m13:31:51.821173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:51.971384 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:31:52.407402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:31:52.410718 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m13:31:53.082926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b44a60130>]}
[0m13:31:53.286517 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:31:53.304060 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:31:53.341545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4714e940>]}
[0m13:31:53.343963 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m13:31:53.346082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4714e790>]}
[0m13:31:53.350114 [info ] [MainThread]: 
[0m13:31:53.353361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:53.356043 [info ] [MainThread]: 
[0m13:31:53.360156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:53.363951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:31:53.443086 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:31:53.445316 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:31:53.447203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:53.454560 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m13:31:53.457901 [debug] [ThreadPool]: On list_airflow: Close
[0m13:31:53.468160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m13:31:53.480060 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:31:53.481673 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m13:31:53.483179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:31:53.488724 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:31:53.490985 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:31:53.493349 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m13:31:53.500484 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m13:31:53.503848 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m13:31:53.505450 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m13:31:53.516825 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.518970 [debug] [MainThread]: On master: BEGIN
[0m13:31:53.520915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:53.527219 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:31:53.530594 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.533077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:53.539714 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:31:53.594776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b44a76310>]}
[0m13:31:53.596968 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:53.599196 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.601057 [debug] [MainThread]: On master: BEGIN
[0m13:31:53.603754 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:31:53.607189 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.609781 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.611830 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.614748 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:53.616734 [debug] [MainThread]: On master: Close
[0m13:31:53.621916 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.623834 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m13:31:53.625949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_temp_summer)
[0m13:31:53.628252 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.648208 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.664515 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.775376 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.789751 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.792527 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m13:31:53.794949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:31:53.803134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:31:53.807436 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:31:53.809819 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temp_max) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temp_max = m.max_temp
  );
  
[0m13:31:53.814284 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "temp_max" does not exist
LINE 23:         MAX(temp_max) AS max_temp
                     ^

[0m13:31:53.819705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m13:31:53.831928 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m13:31:53.841522 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "temp_max" does not exist
  LINE 23:         MAX(temp_max) AS max_temp
                       ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:31:53.846127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '967a7b87-fce8-498e-8171-ccef9953b6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b470bbeb0>]}
[0m13:31:53.848622 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.22s]
[0m13:31:53.851771 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m13:31:53.854402 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "temp_max" does not exist
  LINE 23:         MAX(temp_max) AS max_temp
                       ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m13:31:53.858368 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.860299 [debug] [MainThread]: On master: BEGIN
[0m13:31:53.861840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:53.868117 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:31:53.873167 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.876963 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:53.878839 [debug] [MainThread]: On master: COMMIT
[0m13:31:53.880910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:31:53.883038 [debug] [MainThread]: On master: Close
[0m13:31:53.886552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:53.889499 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_temp_summer' was properly closed.
[0m13:31:53.891531 [info ] [MainThread]: 
[0m13:31:53.894014 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m13:31:53.897671 [debug] [MainThread]: Command end result
[0m13:31:53.971735 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:31:53.979355 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:31:54.004337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:31:54.006332 [info ] [MainThread]: 
[0m13:31:54.009330 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:31:54.011913 [info ] [MainThread]: 
[0m13:31:54.015054 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "temp_max" does not exist
  LINE 23:         MAX(temp_max) AS max_temp
                       ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m13:31:54.018381 [info ] [MainThread]: 
[0m13:31:54.022377 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:31:54.027099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9366298, "process_in_blocks": "0", "process_kernel_time": 0.282415, "process_mem_max_rss": "113184", "process_out_blocks": "0", "process_user_time": 4.538814}
[0m13:31:54.029945 [debug] [MainThread]: Command `dbt run` failed at 13:31:54.029615 after 2.94 seconds
[0m13:31:54.032379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46eff100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b470b0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b45a83a30>]}
[0m13:31:54.035887 [debug] [MainThread]: Flushing usage events
[0m13:31:55.207909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:58.447524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bdc6b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcda8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bcda8a90>]}


============================== 13:32:58.456929 | c91831f1-5c92-4dd9-9b4a-53048cde92bf ==============================
[0m13:32:58.456929 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:32:58.460544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select max_temp_summer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:32:58.786356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc529bb0>]}
[0m13:32:58.914926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc58d6d0>]}
[0m13:32:58.917590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:59.066973 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:32:59.392590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:59.395047 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m13:33:00.000831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb560130>]}
[0m13:33:00.212852 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:33:00.226876 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:33:00.261183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb99acd0>]}
[0m13:33:00.263332 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m13:33:00.265501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb99a0a0>]}
[0m13:33:00.269770 [info ] [MainThread]: 
[0m13:33:00.273610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:00.276108 [info ] [MainThread]: 
[0m13:33:00.279713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:00.285200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:33:00.371204 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:33:00.373665 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:33:00.375630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:00.384823 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m13:33:00.388649 [debug] [ThreadPool]: On list_airflow: Close
[0m13:33:00.402793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m13:33:00.419447 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:33:00.421786 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m13:33:00.424009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:00.432683 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:33:00.436494 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m13:33:00.439952 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m13:33:00.449163 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m13:33:00.453711 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m13:33:00.456431 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m13:33:00.480494 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.483627 [debug] [MainThread]: On master: BEGIN
[0m13:33:00.486143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:00.494615 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:33:00.497228 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.503433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:00.512589 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:33:00.617873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb59f9d0>]}
[0m13:33:00.622272 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:00.625426 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.627799 [debug] [MainThread]: On master: BEGIN
[0m13:33:00.630676 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:33:00.634275 [debug] [MainThread]: On master: COMMIT
[0m13:33:00.638258 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:00.641224 [debug] [MainThread]: On master: COMMIT
[0m13:33:00.644134 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:00.646377 [debug] [MainThread]: On master: Close
[0m13:33:00.653013 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:00.655763 [info ] [Thread-1  ]: 1 of 1 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m13:33:00.658708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.max_temp_summer)
[0m13:33:00.661015 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:00.690469 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.702326 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:00.808410 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.817905 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.819656 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m13:33:00.821269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:00.827301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:33:00.831840 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.833782 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m13:33:00.925932 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.090 seconds
[0m13:33:00.940837 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.943388 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m13:33:00.946434 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:33:00.995504 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m13:33:00.997634 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:00.999627 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m13:33:01.003073 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:33:01.019099 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m13:33:01.032128 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m13:33:01.034059 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m13:33:01.036743 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:33:01.043210 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m13:33:01.049737 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c91831f1-5c92-4dd9-9b4a-53048cde92bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bed9f130>]}
[0m13:33:01.052859 [info ] [Thread-1  ]: 1 of 1 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.39s]
[0m13:33:01.055875 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m13:33:01.060146 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:01.061878 [debug] [MainThread]: On master: BEGIN
[0m13:33:01.063496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:01.069159 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:33:01.071530 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.074329 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:01.076471 [debug] [MainThread]: On master: COMMIT
[0m13:33:01.078944 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:01.081622 [debug] [MainThread]: On master: Close
[0m13:33:01.084793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:01.086457 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.max_temp_summer' was properly closed.
[0m13:33:01.088081 [info ] [MainThread]: 
[0m13:33:01.090093 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m13:33:01.093047 [debug] [MainThread]: Command end result
[0m13:33:01.179280 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m13:33:01.188538 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m13:33:01.211781 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m13:33:01.213642 [info ] [MainThread]: 
[0m13:33:01.216594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:01.219972 [info ] [MainThread]: 
[0m13:33:01.222264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:33:01.226136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9372945, "process_in_blocks": "0", "process_kernel_time": 0.251008, "process_mem_max_rss": "115408", "process_out_blocks": "0", "process_user_time": 4.648675}
[0m13:33:01.229438 [debug] [MainThread]: Command `dbt run` succeeded at 13:33:01.228888 after 2.94 seconds
[0m13:33:01.232944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bdc6b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb94c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb94cac0>]}
[0m13:33:01.235225 [debug] [MainThread]: Flushing usage events
[0m13:33:02.275743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:24:49.903166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb8e170a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb7f5a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb7f5a550>]}


============================== 06:24:49.913088 | d404546c-0a23-44a2-a383-4c100b57365d ==============================
[0m06:24:49.913088 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:24:49.916303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:24:50.358993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb7f328e0>]}
[0m06:24:50.494639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb73d01c0>]}
[0m06:24:50.498041 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:24:50.681989 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:24:51.187140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:24:51.188460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:24:51.272347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6b1bf10>]}
[0m06:24:51.444940 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:24:51.453822 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:24:51.491668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6b06ac0>]}
[0m06:24:51.493714 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:24:51.495729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb93845e0>]}
[0m06:24:51.501753 [info ] [MainThread]: 
[0m06:24:51.504528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:24:51.506412 [info ] [MainThread]: 
[0m06:24:51.508561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:24:51.520091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:24:51.597672 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:24:51.599158 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:24:51.600312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:51.618002 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m06:24:51.621268 [debug] [ThreadPool]: On list_airflow: Close
[0m06:24:51.625422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_pro_raw_api'
[0m06:24:51.646709 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:24:51.648326 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:24:51.651434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:51.656564 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:24:51.658505 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:24:51.659986 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:24:51.671168 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m06:24:51.674226 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:24:51.675872 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:24:51.689088 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.690538 [debug] [MainThread]: On master: BEGIN
[0m06:24:51.691792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:24:51.696588 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:24:51.698163 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.699547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:24:51.708364 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:24:51.710636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6b3c7f0>]}
[0m06:24:51.712120 [debug] [MainThread]: On master: ROLLBACK
[0m06:24:51.713492 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.714444 [debug] [MainThread]: On master: BEGIN
[0m06:24:51.715809 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:24:51.717325 [debug] [MainThread]: On master: COMMIT
[0m06:24:51.718557 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:51.719847 [debug] [MainThread]: On master: COMMIT
[0m06:24:51.721168 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:51.722365 [debug] [MainThread]: On master: Close
[0m06:24:51.730444 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:24:51.733137 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:24:51.736008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:24:51.740841 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:24:51.763979 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.773672 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:24:51.872712 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.881128 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.882573 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:24:51.884128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:51.889460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:24:51.892261 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.893874 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:24:51.965102 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.070 seconds
[0m06:24:51.979136 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.981015 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:24:51.983138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:51.992554 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:51.994179 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:24:51.996302 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.045675 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:24:52.047070 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:52.048514 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:24:52.053349 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:24:52.065870 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:24:52.075857 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:24:52.077685 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:24:52.085397 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:24:52.092097 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:24:52.100046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6256c10>]}
[0m06:24:52.102257 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7745[0m in 0.36s]
[0m06:24:52.106082 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:24:52.108355 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.110629 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:24:52.113407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:24:52.115091 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.123626 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.131432 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.144380 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.153788 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.155417 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:24:52.157643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.163836 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:24:52.166286 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.167907 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:24:52.208928 [debug] [Thread-1  ]: SQL status: SELECT 7745 in 0.039 seconds
[0m06:24:52.215898 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.217238 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:24:52.219065 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.227014 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.228471 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:24:52.230340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.234275 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:24:52.235731 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.236933 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:24:52.240366 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:24:52.246537 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:24:52.248632 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:24:52.250032 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:24:52.253560 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:24:52.256265 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:24:52.258071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6240250>]}
[0m06:24:52.260099 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7745[0m in 0.14s]
[0m06:24:52.262392 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:24:52.263821 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.265413 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:24:52.267070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:24:52.268298 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.276951 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.283424 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.383566 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.394801 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.397013 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:24:52.398797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.407380 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:24:52.410052 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.411780 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:24:52.449505 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.036 seconds
[0m06:24:52.455434 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.456946 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:24:52.458940 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:52.466908 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.469199 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:24:52.471160 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.475151 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:24:52.476597 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.478407 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:24:52.481178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:24:52.488595 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:24:52.490995 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:24:52.493088 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:24:52.497903 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:24:52.502532 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:24:52.504896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5ee69d0>]}
[0m06:24:52.507710 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.24s]
[0m06:24:52.509887 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:24:52.510930 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:24:52.512204 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:24:52.513854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:24:52.515046 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:24:52.520489 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.525938 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:24:52.534545 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.540049 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.541326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:24:52.542553 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.547206 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:24:52.549058 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.550554 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:24:52.580288 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.028 seconds
[0m06:24:52.586312 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.587714 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:24:52.589389 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.596883 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.598181 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:24:52.599860 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.603528 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:24:52.605173 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.606776 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:24:52.610198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:24:52.616781 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:24:52.619310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:24:52.620823 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:24:52.624989 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:24:52.629219 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:24:52.631546 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5ee69d0>]}
[0m06:24:52.634439 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.12s]
[0m06:24:52.637091 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:24:52.639657 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:24:52.643023 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:24:52.645430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:24:52.647059 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:24:52.653921 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.661049 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:24:52.668606 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.675659 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.676806 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:24:52.677997 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.682763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:24:52.684695 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.686217 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:24:52.722722 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.035 seconds
[0m06:24:52.728206 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.729326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:24:52.730759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.736921 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.738213 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:24:52.739898 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.743810 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:24:52.745126 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.746422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:24:52.748612 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:24:52.754192 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:24:52.755984 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:24:52.757330 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:24:52.760623 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:24:52.763123 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:24:52.764830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5f0d0a0>]}
[0m06:24:52.766415 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.12s]
[0m06:24:52.768656 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:24:52.769874 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:24:52.771385 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:24:52.773319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:24:52.774738 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:24:52.781982 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.787914 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:24:52.796978 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.803968 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.805301 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:24:52.806491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:52.812102 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:24:52.813849 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.814970 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:24:52.834102 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.018 seconds
[0m06:24:52.842883 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.846326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:24:52.848631 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:52.866193 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.868099 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:24:52.873234 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:52.879719 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:24:52.882881 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.885827 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:24:52.894295 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:24:52.902805 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:24:52.906001 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:24:52.907970 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:24:52.916462 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m06:24:52.919773 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:24:52.921678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404546c-0a23-44a2-a383-4c100b57365d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb5fcb100>]}
[0m06:24:52.924367 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.15s]
[0m06:24:52.927317 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:24:52.930669 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:52.931971 [debug] [MainThread]: On master: BEGIN
[0m06:24:52.932898 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:24:52.937458 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:24:52.939016 [debug] [MainThread]: On master: COMMIT
[0m06:24:52.940632 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:52.941765 [debug] [MainThread]: On master: COMMIT
[0m06:24:52.943337 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:52.944434 [debug] [MainThread]: On master: Close
[0m06:24:52.945578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:24:52.946672 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m06:24:52.947981 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:24:52.949237 [info ] [MainThread]: 
[0m06:24:52.950693 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m06:24:52.954026 [debug] [MainThread]: Command end result
[0m06:24:52.995843 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:24:53.001151 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:24:53.018614 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:24:53.019990 [info ] [MainThread]: 
[0m06:24:53.021625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:24:53.023461 [info ] [MainThread]: 
[0m06:24:53.025064 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:24:53.028682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3312457, "process_in_blocks": "84464", "process_kernel_time": 0.50893, "process_mem_max_rss": "110504", "process_out_blocks": "0", "process_user_time": 5.059945}
[0m06:24:53.030338 [debug] [MainThread]: Command `dbt run` succeeded at 06:24:53.030142 after 3.33 seconds
[0m06:24:53.031820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb8e170a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb72dbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fb6ac0f10>]}
[0m06:24:53.033252 [debug] [MainThread]: Flushing usage events
[0m06:24:53.829492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:02:30.861171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a706670d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6f7a6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6f7a65e0>]}


============================== 06:02:30.875216 | 06f85405-504b-4745-96a9-5f5f63ea027a ==============================
[0m06:02:30.875216 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:02:30.878847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:02:31.942826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a716049d0>]}
[0m06:02:32.204809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6ef40f70>]}
[0m06:02:32.210540 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:02:32.565564 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:02:33.476706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:02:33.479735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:02:33.645178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35bf40>]}
[0m06:02:34.031424 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:02:34.048282 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:02:34.138610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35bf70>]}
[0m06:02:34.141465 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:02:34.144856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a70b9a460>]}
[0m06:02:34.153106 [info ] [MainThread]: 
[0m06:02:34.156308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:02:34.159494 [info ] [MainThread]: 
[0m06:02:34.162777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:02:34.185825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:02:34.351789 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:02:34.354020 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:02:34.355968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:34.381420 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m06:02:34.388252 [debug] [ThreadPool]: On list_airflow: Close
[0m06:02:34.393538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:02:34.417588 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:02:34.420260 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:02:34.422113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:34.429437 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:02:34.432712 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:02:34.436961 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:02:34.455587 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m06:02:34.460250 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:02:34.462036 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:02:34.486574 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.488562 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.490416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:02:34.498055 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:02:34.501111 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.503863 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:02:34.514436 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m06:02:34.519793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e365d60>]}
[0m06:02:34.522241 [debug] [MainThread]: On master: ROLLBACK
[0m06:02:34.524427 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.526054 [debug] [MainThread]: On master: BEGIN
[0m06:02:34.528548 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:02:34.530952 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.540493 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:34.542536 [debug] [MainThread]: On master: COMMIT
[0m06:02:34.544783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:34.546752 [debug] [MainThread]: On master: Close
[0m06:02:34.561248 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:02:34.563936 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:02:34.568586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:02:34.573477 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:02:34.611106 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.627419 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:02:34.809924 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.905458 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.907727 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:02:34.909880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:34.917984 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:02:34.920769 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:34.923090 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:02:35.064284 [debug] [Thread-1  ]: SQL status: SELECT 7750 in 0.139 seconds
[0m06:02:35.093828 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.097221 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:02:35.102849 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:02:35.114263 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.120309 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:02:35.123172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.206170 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:02:35.208740 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.210678 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:02:35.216529 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:02:35.241560 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:02:35.260450 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:02:35.271522 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:02:35.280973 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:02:35.292507 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:02:35.302370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6da96c10>]}
[0m06:02:35.305678 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7750[0m in 0.73s]
[0m06:02:35.309757 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:02:35.312105 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.314394 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:02:35.320538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:02:35.322434 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.334722 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.345453 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.360505 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.373209 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.375231 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:02:35.377006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:35.383591 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:02:35.387203 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.389721 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:02:35.508415 [debug] [Thread-1  ]: SQL status: SELECT 7750 in 0.116 seconds
[0m06:02:35.520653 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.522776 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:02:35.525301 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.536976 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.538652 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:02:35.540687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.544578 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:02:35.546344 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.547908 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:02:35.554569 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:02:35.563814 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:02:35.567558 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:02:35.570571 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:02:35.576177 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:02:35.579793 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:02:35.583082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6da81490>]}
[0m06:02:35.587536 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7750[0m in 0.26s]
[0m06:02:35.590639 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:02:35.592850 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.594946 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:02:35.597550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:02:35.601944 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.617352 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.629119 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.725011 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.738491 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.740939 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:02:35.743098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:35.754626 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m06:02:35.756716 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.758629 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:02:35.831170 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.070 seconds
[0m06:02:35.847587 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.854791 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:02:35.857738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.872685 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.875648 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:02:35.878740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:35.885658 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:02:35.889148 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.891253 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:02:35.895050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:02:35.906062 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:02:35.908902 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:02:35.911097 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:02:35.925798 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m06:02:35.931108 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:02:35.938109 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7259d0>]}
[0m06:02:35.941785 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.34s]
[0m06:02:35.945265 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:02:35.950985 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:02:35.955445 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:02:35.959176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:02:35.961700 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:02:35.974177 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:02:35.987359 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:02:36.003965 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.016299 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.019579 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:02:36.021720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:36.028505 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:02:36.030889 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.035952 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:02:36.102624 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.064 seconds
[0m06:02:36.116914 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.119341 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:02:36.121789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.133774 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.137074 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:02:36.139650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.143732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:02:36.145349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.147087 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:02:36.151723 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:02:36.158583 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:02:36.161096 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:02:36.162809 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:02:36.168454 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:02:36.173377 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:02:36.175725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7259d0>]}
[0m06:02:36.178015 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.22s]
[0m06:02:36.181048 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:02:36.185207 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:02:36.187625 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:02:36.190113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:02:36.192064 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:02:36.204622 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.216395 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:02:36.230973 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.243544 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.245714 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:02:36.248019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:36.256858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:02:36.259499 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.261717 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:02:36.327031 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.062 seconds
[0m06:02:36.337917 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.339613 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:02:36.342316 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.352523 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.354061 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:02:36.355939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:02:36.362577 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:02:36.365086 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.368162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:02:36.371853 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:02:36.384693 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:02:36.387845 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:02:36.390027 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:02:36.394420 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:02:36.397968 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:02:36.401819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7259d0>]}
[0m06:02:36.404742 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.21s]
[0m06:02:36.407880 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:02:36.409827 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:02:36.411928 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:02:36.414712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:02:36.418026 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:02:36.427289 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.444247 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:02:36.459895 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.473893 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.476084 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:02:36.477876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:02:36.485839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:02:36.488326 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.491211 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:02:36.519995 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.026 seconds
[0m06:02:36.528276 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.530109 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:02:36.532868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:02:36.545681 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.548749 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:02:36.552751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:02:36.557674 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:02:36.559543 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.560966 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:02:36.567317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m06:02:36.574550 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:02:36.576873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:02:36.578698 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:02:36.585339 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:02:36.591118 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:02:36.594368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06f85405-504b-4745-96a9-5f5f63ea027a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6d7364f0>]}
[0m06:02:36.597609 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.18s]
[0m06:02:36.603628 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:02:36.608401 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:36.610213 [debug] [MainThread]: On master: BEGIN
[0m06:02:36.611559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:02:36.621354 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m06:02:36.623450 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.625179 [debug] [MainThread]: Using postgres connection "master"
[0m06:02:36.626798 [debug] [MainThread]: On master: COMMIT
[0m06:02:36.628585 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:02:36.630006 [debug] [MainThread]: On master: Close
[0m06:02:36.631854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:36.636377 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:02:36.638467 [info ] [MainThread]: 
[0m06:02:36.641623 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m06:02:36.647766 [debug] [MainThread]: Command end result
[0m06:02:36.758126 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:02:36.769595 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:02:36.850731 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:02:36.864541 [info ] [MainThread]: 
[0m06:02:36.871929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:02:36.874855 [info ] [MainThread]: 
[0m06:02:36.877388 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:02:36.885905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.358324, "process_in_blocks": "84160", "process_kernel_time": 1.857013, "process_mem_max_rss": "110384", "process_out_blocks": "0", "process_user_time": 9.084308}
[0m06:02:36.888931 [debug] [MainThread]: Command `dbt run` succeeded at 06:02:36.888524 after 6.36 seconds
[0m06:02:36.891066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a706670d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6e35cd30>]}
[0m06:02:36.893243 [debug] [MainThread]: Flushing usage events
[0m06:02:37.585951 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:43:32.928444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7394c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a72a906a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a72a90640>]}


============================== 06:43:32.941232 | 1bad2245-2d5a-4276-bbc4-0496107f6ba3 ==============================
[0m06:43:32.941232 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:43:32.945196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:43:34.133935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a74a36220>]}
[0m06:43:34.615152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a730eba30>]}
[0m06:43:34.679569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:43:35.043416 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:43:36.097394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:36.099305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:36.266875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7189bfa0>]}
[0m06:43:36.604714 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:43:36.618627 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:43:36.675707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a718db340>]}
[0m06:43:36.678167 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:43:36.681584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7318b460>]}
[0m06:43:36.689369 [info ] [MainThread]: 
[0m06:43:36.692310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:43:36.695396 [info ] [MainThread]: 
[0m06:43:36.698818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:36.716552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:43:36.859729 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:43:36.862936 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:43:36.865183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:36.888268 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m06:43:36.891552 [debug] [ThreadPool]: On list_airflow: Close
[0m06:43:36.900291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_pro_raw_api'
[0m06:43:36.924073 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:43:36.926999 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:43:36.929934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:36.942217 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:43:36.945610 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:43:36.947733 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:43:36.963555 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m06:43:36.968407 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:43:36.970782 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:43:36.989967 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:36.992162 [debug] [MainThread]: On master: BEGIN
[0m06:43:36.994041 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:37.002343 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:43:37.004556 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:37.006934 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:37.016654 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m06:43:37.020295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a72188460>]}
[0m06:43:37.022447 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:37.024461 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:37.026116 [debug] [MainThread]: On master: BEGIN
[0m06:43:37.028637 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:43:37.030746 [debug] [MainThread]: On master: COMMIT
[0m06:43:37.032800 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:37.034496 [debug] [MainThread]: On master: COMMIT
[0m06:43:37.040745 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:43:37.045025 [debug] [MainThread]: On master: Close
[0m06:43:37.055519 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.057907 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:43:37.061130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:43:37.063768 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.092296 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.107695 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.264335 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.282012 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.284970 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:43:37.287491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:37.298032 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:43:37.300407 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.302864 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:43:37.414715 [debug] [Thread-1  ]: SQL status: SELECT 7755 in 0.110 seconds
[0m06:43:37.438237 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.440526 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:43:37.447802 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m06:43:37.458118 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.460297 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:43:37.463468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:37.554762 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:43:37.563755 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.566115 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:43:37.577136 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m06:43:37.597514 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:43:37.613890 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:43:37.616262 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:43:37.623821 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:43:37.632812 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:43:37.639638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70d98ca0>]}
[0m06:43:37.642601 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7755[0m in 0.57s]
[0m06:43:37.646973 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:43:37.649782 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.652165 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:43:37.655059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:43:37.657238 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.669011 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.679866 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.696034 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.708608 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.710942 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:43:37.713154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:37.722219 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:43:37.724880 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.726967 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:43:37.786465 [debug] [Thread-1  ]: SQL status: SELECT 7755 in 0.057 seconds
[0m06:43:37.798167 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.800346 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:43:37.803494 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:37.813668 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.815361 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:43:37.817521 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:37.822804 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:43:37.824911 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.826905 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:43:37.835279 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m06:43:37.843019 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:43:37.846059 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:43:37.847687 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:43:37.853237 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:43:37.857855 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:43:37.860849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70d85250>]}
[0m06:43:37.863907 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7755[0m in 0.21s]
[0m06:43:37.867312 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:43:37.869652 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:37.872143 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:43:37.874640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:43:37.876454 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:37.889693 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:37.902454 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:37.993314 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.006806 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.009403 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:43:38.011982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.020566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:43:38.023721 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.026466 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:43:38.092984 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.063 seconds
[0m06:43:38.102091 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.103988 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:43:38.106691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.116847 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.119296 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:43:38.122163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:38.126123 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:43:38.128470 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.130771 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:43:38.134638 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:43:38.142269 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:43:38.145981 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:43:38.148023 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:43:38.152211 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:43:38.156198 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:43:38.158712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70c70190>]}
[0m06:43:38.161546 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.28s]
[0m06:43:38.164674 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:43:38.167256 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:43:38.169228 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:43:38.171496 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:43:38.173164 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:43:38.180864 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.191342 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:43:38.204360 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.214847 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.217381 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:43:38.219676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.227184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:43:38.229986 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.232157 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:43:38.277594 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.043 seconds
[0m06:43:38.287259 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.288999 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:43:38.291284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.298592 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.300167 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:43:38.302261 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:43:38.306347 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:43:38.308146 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.309850 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:43:38.319977 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m06:43:38.331059 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:43:38.334095 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:43:38.335794 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:43:38.344622 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:43:38.350006 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:43:38.352274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70c70190>]}
[0m06:43:38.354722 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.18s]
[0m06:43:38.357976 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:43:38.359820 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:43:38.362140 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:43:38.364353 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:43:38.366137 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:43:38.376239 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.385832 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:43:38.398180 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.407794 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.411392 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:43:38.415025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.428992 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m06:43:38.436310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.441115 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:43:38.579887 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.136 seconds
[0m06:43:38.618197 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.620664 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:43:38.623973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.638979 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.641092 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:43:38.643872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.652732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:43:38.655067 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.657216 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:43:38.661134 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:43:38.678273 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:43:38.682743 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:43:38.685694 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:43:38.691272 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:43:38.696974 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:43:38.702246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70c6c820>]}
[0m06:43:38.705810 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.34s]
[0m06:43:38.709115 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:43:38.711872 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:43:38.719426 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:43:38.722747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:43:38.724762 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:43:38.737377 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.752606 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:43:38.766242 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.779873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.782654 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:43:38.785236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:38.791384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:43:38.793735 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.797427 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:43:38.820358 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.020 seconds
[0m06:43:38.833916 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.835864 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:43:38.838422 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.850466 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.852566 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:43:38.855250 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:43:38.861020 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:43:38.864373 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.867315 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:43:38.876950 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m06:43:38.888629 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:43:38.891203 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:43:38.893080 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:43:38.902400 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:43:38.906418 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:43:38.908586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bad2245-2d5a-4276-bbc4-0496107f6ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a70d5fe80>]}
[0m06:43:38.911037 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.19s]
[0m06:43:38.914990 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:43:38.918469 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:38.920112 [debug] [MainThread]: On master: BEGIN
[0m06:43:38.921743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:38.929217 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:43:38.931658 [debug] [MainThread]: On master: COMMIT
[0m06:43:38.933359 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:38.935073 [debug] [MainThread]: On master: COMMIT
[0m06:43:38.937663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:43:38.939981 [debug] [MainThread]: On master: Close
[0m06:43:38.942083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:38.944432 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m06:43:38.946878 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:43:38.949240 [info ] [MainThread]: 
[0m06:43:38.951767 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m06:43:38.957601 [debug] [MainThread]: Command end result
[0m06:43:39.038122 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:43:39.050305 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:43:39.081020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:43:39.083002 [info ] [MainThread]: 
[0m06:43:39.085537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:39.088105 [info ] [MainThread]: 
[0m06:43:39.091297 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:43:39.096244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.458528, "process_in_blocks": "84264", "process_kernel_time": 0.88783, "process_mem_max_rss": "108180", "process_out_blocks": "0", "process_user_time": 8.545364}
[0m06:43:39.098660 [debug] [MainThread]: Command `dbt run` succeeded at 06:43:39.098366 after 6.46 seconds
[0m06:43:39.101253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a7394c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a74a36220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a718982b0>]}
[0m06:43:39.103137 [debug] [MainThread]: Flushing usage events
[0m06:43:40.599899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:04.706970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e1dfefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e0f47af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e0f47b50>]}


============================== 11:09:04.714705 | 66b879ef-1471-47fc-a985-6582844c67c3 ==============================
[0m11:09:04.714705 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:09:04.716042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:09:04.966919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e096fe20>]}
[0m11:09:05.043507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e15e5760>]}
[0m11:09:05.045496 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:09:05.151508 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:09:05.467120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:05.468560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:05.521855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd5ae80>]}
[0m11:09:05.649097 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:09:05.654926 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:09:05.682501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd9b3d0>]}
[0m11:09:05.683724 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m11:09:05.685020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e05c07c0>]}
[0m11:09:05.688390 [info ] [MainThread]: 
[0m11:09:05.689714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:05.691127 [info ] [MainThread]: 
[0m11:09:05.693022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:05.701060 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:09:05.790125 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:09:05.791532 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:09:05.792751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:05.850743 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.058 seconds
[0m11:09:05.853647 [debug] [ThreadPool]: On list_airflow: Close
[0m11:09:05.856928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:09:05.868379 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:09:05.869914 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:09:05.871105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:05.876141 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m11:09:05.878324 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:09:05.879768 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:09:05.890803 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m11:09:05.893705 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:09:05.895337 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:09:05.904014 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.904900 [debug] [MainThread]: On master: BEGIN
[0m11:09:05.905676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:05.910922 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:09:05.912293 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.913409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:09:05.921040 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m11:09:05.922889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd7b580>]}
[0m11:09:05.923776 [debug] [MainThread]: On master: ROLLBACK
[0m11:09:05.924616 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.925314 [debug] [MainThread]: On master: BEGIN
[0m11:09:05.926650 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:09:05.928434 [debug] [MainThread]: On master: COMMIT
[0m11:09:05.929563 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:05.930328 [debug] [MainThread]: On master: COMMIT
[0m11:09:05.931232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:05.931975 [debug] [MainThread]: On master: Close
[0m11:09:05.936197 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m11:09:05.937295 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m11:09:05.938541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m11:09:05.939504 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m11:09:05.951032 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m11:09:05.957329 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m11:09:06.006603 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.014761 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.015723 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m11:09:06.016616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.024339 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m11:09:06.025491 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.027048 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m11:09:06.153524 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.125 seconds
[0m11:09:06.162987 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.164469 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m11:09:06.167914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:09:06.172735 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.173949 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m11:09:06.175466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.204977 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m11:09:06.206226 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.207371 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m11:09:06.209957 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:09:06.218243 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m11:09:06.224352 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:09:06.225662 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m11:09:06.232208 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m11:09:06.235703 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m11:09:06.238322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df496b50>]}
[0m11:09:06.239764 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7760[0m in 0.30s]
[0m11:09:06.241423 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m11:09:06.242609 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.243945 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m11:09:06.245371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m11:09:06.246266 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.250517 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.255249 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.261684 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.266944 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.267917 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m11:09:06.268883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.275179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m11:09:06.276774 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.278016 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m11:09:06.313350 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.034 seconds
[0m11:09:06.318426 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.319854 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m11:09:06.321447 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.326407 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.328112 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m11:09:06.329868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.332720 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m11:09:06.333930 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.334889 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m11:09:06.341384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m11:09:06.346099 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m11:09:06.347651 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:09:06.348669 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m11:09:06.352546 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:09:06.354703 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m11:09:06.355971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df49be20>]}
[0m11:09:06.357318 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7760[0m in 0.11s]
[0m11:09:06.358956 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m11:09:06.361354 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.363033 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m11:09:06.365849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m11:09:06.366907 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.372430 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.379826 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.443398 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.453127 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.454517 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m11:09:06.455780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.461343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m11:09:06.463120 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.464723 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m11:09:06.508362 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.042 seconds
[0m11:09:06.513476 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.514615 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m11:09:06.516057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.520377 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.521451 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m11:09:06.522616 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.524750 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m11:09:06.525692 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.527150 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m11:09:06.529809 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:09:06.533947 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m11:09:06.535367 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:09:06.536245 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m11:09:06.539278 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:09:06.541200 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m11:09:06.542426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e1c90c10>]}
[0m11:09:06.544239 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.18s]
[0m11:09:06.546131 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m11:09:06.547424 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:09:06.548466 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:09:06.549723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m11:09:06.550685 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:09:06.555079 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.561168 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:09:06.567569 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.573236 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.574188 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:09:06.575007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.581853 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:09:06.583294 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.584458 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m11:09:06.636917 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.051 seconds
[0m11:09:06.644732 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.646596 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:09:06.648492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.653532 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.655156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:09:06.657257 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.661887 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:09:06.663691 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.664978 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:09:06.667730 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:09:06.671920 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:09:06.673555 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:09:06.674772 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:09:06.680181 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:09:06.682808 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:09:06.684248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df125970>]}
[0m11:09:06.685537 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.13s]
[0m11:09:06.687039 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:09:06.688077 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m11:09:06.689118 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m11:09:06.690366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m11:09:06.691518 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m11:09:06.696689 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.701705 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m11:09:06.707082 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.713163 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.714277 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m11:09:06.715344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.719848 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m11:09:06.721306 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.722476 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m11:09:06.772064 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.048 seconds
[0m11:09:06.779220 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.780478 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m11:09:06.782026 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.787668 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.789238 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m11:09:06.790923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.795410 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:09:06.797058 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.798626 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:09:06.803454 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m11:09:06.809860 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m11:09:06.811769 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:09:06.813119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m11:09:06.817141 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:09:06.819645 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m11:09:06.820904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df125970>]}
[0m11:09:06.822316 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.13s]
[0m11:09:06.823749 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m11:09:06.824754 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m11:09:06.825886 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m11:09:06.827379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m11:09:06.828492 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m11:09:06.833187 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.838428 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m11:09:06.843884 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.849544 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.850572 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m11:09:06.851445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:06.855416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m11:09:06.856927 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.858197 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m11:09:06.870417 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.011 seconds
[0m11:09:06.874978 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.876522 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m11:09:06.878642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.883552 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.884653 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m11:09:06.886086 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:09:06.888792 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:09:06.889871 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.890802 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:09:06.897334 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m11:09:06.902823 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m11:09:06.904694 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:09:06.905783 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m11:09:06.911122 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:09:06.913888 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m11:09:06.915252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66b879ef-1471-47fc-a985-6582844c67c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63df52d9a0>]}
[0m11:09:06.916619 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.09s]
[0m11:09:06.918575 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m11:09:06.921233 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:06.922423 [debug] [MainThread]: On master: BEGIN
[0m11:09:06.923485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:06.928067 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:09:06.929499 [debug] [MainThread]: On master: COMMIT
[0m11:09:06.930555 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:06.931503 [debug] [MainThread]: On master: COMMIT
[0m11:09:06.932694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:09:06.933910 [debug] [MainThread]: On master: Close
[0m11:09:06.935136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:06.936128 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m11:09:06.937293 [info ] [MainThread]: 
[0m11:09:06.938616 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m11:09:06.941550 [debug] [MainThread]: Command end result
[0m11:09:06.983184 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:09:06.988009 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:09:07.000519 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:09:07.001460 [info ] [MainThread]: 
[0m11:09:07.002767 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:09:07.004174 [info ] [MainThread]: 
[0m11:09:07.005458 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:09:07.009239 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4250338, "process_in_blocks": "0", "process_kernel_time": 1.068281, "process_mem_max_rss": "108748", "process_out_blocks": "0", "process_user_time": 3.416484}
[0m11:09:07.010558 [debug] [MainThread]: Command `dbt run` succeeded at 11:09:07.010386 after 2.43 seconds
[0m11:09:07.011915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e1dfefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63dfd450d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e15e5760>]}
[0m11:09:07.013001 [debug] [MainThread]: Flushing usage events
[0m11:09:07.847479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:33.803278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c27e56130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c26f996a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c26f99640>]}


============================== 06:34:33.810218 | 7ddde0cb-058a-4bcd-9364-e87c25958b13 ==============================
[0m06:34:33.810218 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:34:33.812325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:34:34.240171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28f40220>]}
[0m06:34:34.410053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c275f4a30>]}
[0m06:34:34.412799 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:34:34.582970 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:34:35.138868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:35.140692 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:35.251465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25b5bfa0>]}
[0m06:34:35.503205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:34:35.514267 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:34:35.563579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25b9b340>]}
[0m06:34:35.565647 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:34:35.568018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c27694460>]}
[0m06:34:35.573137 [info ] [MainThread]: 
[0m06:34:35.574812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:34:35.576659 [info ] [MainThread]: 
[0m06:34:35.578670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:35.588440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:34:35.666575 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:34:35.667983 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:34:35.669328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:35.686645 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:34:35.689668 [debug] [ThreadPool]: On list_airflow: Close
[0m06:34:35.694248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:34:35.715970 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:34:35.754499 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:34:35.756790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:34:35.762255 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:34:35.763784 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:34:35.764979 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:34:35.777806 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m06:34:35.780373 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:34:35.781499 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:34:35.790610 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.791640 [debug] [MainThread]: On master: BEGIN
[0m06:34:35.792446 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:35.795922 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:34:35.797332 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.798412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:34:35.803228 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m06:34:35.805909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c26389460>]}
[0m06:34:35.807199 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:35.808275 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.809199 [debug] [MainThread]: On master: BEGIN
[0m06:34:35.810372 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:35.811692 [debug] [MainThread]: On master: COMMIT
[0m06:34:35.812685 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:35.813535 [debug] [MainThread]: On master: COMMIT
[0m06:34:35.814617 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:35.815580 [debug] [MainThread]: On master: Close
[0m06:34:35.820218 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:34:35.821949 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:34:35.823785 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:34:35.824962 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:34:35.836249 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.842415 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:34:35.895926 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.901349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.902305 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:34:35.903336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:35.907714 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:35.909347 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.910499 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:34:35.965375 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.054 seconds
[0m06:34:35.975349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.976870 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:34:35.979329 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:35.984054 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:35.985186 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:34:35.986472 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.015846 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:34:36.016996 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:36.018053 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:34:36.022825 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.033072 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:34:36.040986 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:34:36.042367 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:34:36.047686 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:34:36.051441 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:34:36.055240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25272760>]}
[0m06:34:36.057100 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7760[0m in 0.23s]
[0m06:34:36.059264 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:34:36.060432 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.061453 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:34:36.062753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:34:36.063814 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.068686 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.076123 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.082024 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.087891 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.089563 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:34:36.090806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.094592 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:36.096033 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.096957 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:34:36.121356 [debug] [Thread-1  ]: SQL status: SELECT 7760 in 0.023 seconds
[0m06:34:36.126470 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.127714 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:34:36.129194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.133704 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.134798 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:34:36.135932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.138904 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:34:36.140138 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.141066 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:34:36.144708 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:34:36.148642 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:34:36.149929 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:34:36.150800 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:34:36.153626 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.156438 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:34:36.157834 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28010e20>]}
[0m06:34:36.159304 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7760[0m in 0.10s]
[0m06:34:36.160841 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:34:36.161935 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.163056 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:34:36.164625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:34:36.165667 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.172190 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.177978 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.229788 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.236328 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.237893 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:34:36.240193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.244995 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:34:36.246513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.247973 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:34:36.275301 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.026 seconds
[0m06:34:36.280040 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.281323 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:34:36.282695 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.287178 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.288602 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:34:36.290205 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.292686 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:34:36.293604 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.294478 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:34:36.296254 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.300062 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:34:36.301441 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:34:36.302332 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:34:36.305581 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.308988 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:34:36.311960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28010e20>]}
[0m06:34:36.314832 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.15s]
[0m06:34:36.317499 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:34:36.322480 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:34:36.324105 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:34:36.326035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:34:36.327223 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:34:36.333499 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.342878 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:34:36.349226 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.355624 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.356941 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:34:36.358055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.362351 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:36.364039 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.365373 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:34:36.390585 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.024 seconds
[0m06:34:36.399408 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.400705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:34:36.402342 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.411137 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.412702 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:34:36.414548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:36.417415 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:34:36.418654 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.419909 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:34:36.423017 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.427699 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:34:36.429618 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:34:36.431003 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:34:36.434503 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.437784 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:34:36.440134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c28010e20>]}
[0m06:34:36.442092 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.11s]
[0m06:34:36.444113 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:34:36.445555 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:34:36.447425 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:34:36.449713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:34:36.451255 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:34:36.458208 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.465444 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:34:36.474191 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.481332 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.482689 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:34:36.483980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.490119 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:34:36.491851 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.493439 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:34:36.523977 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.029 seconds
[0m06:34:36.530803 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.532103 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:34:36.534233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:36.541966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.543263 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:34:36.545169 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.548682 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:34:36.550004 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.551085 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:34:36.553050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:34:36.559129 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:34:36.560629 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:34:36.561576 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:34:36.564349 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.566596 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:34:36.567869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2532b730>]}
[0m06:34:36.569208 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.12s]
[0m06:34:36.570892 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:34:36.572489 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:34:36.573898 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:34:36.575230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:34:36.576311 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:34:36.580990 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.586588 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:34:36.593408 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.601948 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.603063 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:34:36.604207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:36.608569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:34:36.609976 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.611000 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:34:36.621456 [debug] [Thread-1  ]: SQL status: SELECT 2415 in 0.009 seconds
[0m06:34:36.626638 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.627587 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:34:36.628691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.633135 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.634053 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:34:36.635168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:36.637554 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:34:36.638931 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.639880 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:34:36.643831 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:34:36.647735 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:34:36.649107 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:34:36.649942 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:34:36.653219 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:34:36.655874 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:34:36.657217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ddde0cb-058a-4bcd-9364-e87c25958b13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2532b730>]}
[0m06:34:36.658514 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2415[0m in 0.08s]
[0m06:34:36.660208 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:34:36.662484 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:36.663399 [debug] [MainThread]: On master: BEGIN
[0m06:34:36.664346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:36.667998 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:34:36.669294 [debug] [MainThread]: On master: COMMIT
[0m06:34:36.670216 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:36.671499 [debug] [MainThread]: On master: COMMIT
[0m06:34:36.673254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:36.674267 [debug] [MainThread]: On master: Close
[0m06:34:36.675428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:36.676377 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:34:36.677401 [info ] [MainThread]: 
[0m06:34:36.678624 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m06:34:36.681940 [debug] [MainThread]: Command end result
[0m06:34:36.727112 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:34:36.732773 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:34:36.751993 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:34:36.753198 [info ] [MainThread]: 
[0m06:34:36.756190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:36.757894 [info ] [MainThread]: 
[0m06:34:36.759443 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:34:36.762848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1195538, "process_in_blocks": "84160", "process_kernel_time": 0.612563, "process_mem_max_rss": "110104", "process_out_blocks": "0", "process_user_time": 5.143585}
[0m06:34:36.764468 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:36.764254 after 3.12 seconds
[0m06:34:36.765997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c27e56130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c2631b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c25b7fd60>]}
[0m06:34:36.767471 [debug] [MainThread]: Flushing usage events
[0m06:34:37.630433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:25:13.170989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae15d7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0715ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0715b20>]}


============================== 06:25:13.183133 | 65530432-d395-4e71-9c41-a8a5ff19bd70 ==============================
[0m06:25:13.183133 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:25:13.187432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:25:14.020953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0112ee0>]}
[0m06:25:14.280265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae0124100>]}
[0m06:25:14.316500 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:25:14.638247 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:25:15.571636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:25:15.574112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:25:15.744123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf51aeb0>]}
[0m06:25:16.218397 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:25:16.236165 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:25:16.307053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf55b850>]}
[0m06:25:16.309531 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:25:16.313802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf5401f0>]}
[0m06:25:16.325145 [info ] [MainThread]: 
[0m06:25:16.328668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:25:16.331273 [info ] [MainThread]: 
[0m06:25:16.335133 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:25:16.364435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:25:16.616065 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:25:16.620618 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:25:16.624499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:25:16.660498 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m06:25:16.665365 [debug] [ThreadPool]: On list_airflow: Close
[0m06:25:16.677024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:25:16.705393 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:25:16.707699 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:25:16.709593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:16.719940 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m06:25:16.722673 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:25:16.726072 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:25:16.742778 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m06:25:16.748443 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:25:16.759910 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:25:16.791872 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.793920 [debug] [MainThread]: On master: BEGIN
[0m06:25:16.795749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:25:16.806895 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:25:16.808924 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.810888 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:25:16.825293 [debug] [MainThread]: SQL status: SELECT 0 in 0.012 seconds
[0m06:25:16.834224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf53be20>]}
[0m06:25:16.839785 [debug] [MainThread]: On master: ROLLBACK
[0m06:25:16.842615 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.844706 [debug] [MainThread]: On master: BEGIN
[0m06:25:16.847445 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:25:16.852387 [debug] [MainThread]: On master: COMMIT
[0m06:25:16.856686 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:16.860583 [debug] [MainThread]: On master: COMMIT
[0m06:25:16.864062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:16.873074 [debug] [MainThread]: On master: Close
[0m06:25:16.892241 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:25:16.904869 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:25:16.909492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:25:16.912657 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:25:16.957666 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:25:16.972397 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:25:17.119249 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.131157 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.133352 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:25:17.136903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:17.143733 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:17.146878 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.148644 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:25:17.232654 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.081 seconds
[0m06:25:17.259293 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.260906 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:25:17.263733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:17.281144 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.284199 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:25:17.288444 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:17.356812 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:25:17.358959 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.361096 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:25:17.367970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:25:17.397014 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:25:17.418619 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:17.420881 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:25:17.428107 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m06:25:17.439569 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:25:17.446012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ade9f5670>]}
[0m06:25:17.449006 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7765[0m in 0.53s]
[0m06:25:17.455091 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:25:17.457327 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.459608 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:25:17.461901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:25:17.464321 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.479021 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.521323 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.556303 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.589296 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.597369 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:25:17.606206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:17.615813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:25:17.618881 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.621290 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:25:17.699034 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.075 seconds
[0m06:25:17.709618 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.711389 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:25:17.713504 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:17.725929 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.727854 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:25:17.729845 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:17.736773 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:25:17.738591 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.740228 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:25:17.744688 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:25:17.753465 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:25:17.755916 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:17.757557 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:25:17.762926 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:17.768617 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:25:17.775043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae14459a0>]}
[0m06:25:17.778324 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7765[0m in 0.31s]
[0m06:25:17.782033 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:25:17.786011 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:17.788042 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:25:17.790271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:25:17.791896 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:17.804318 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.813731 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:17.903143 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.914537 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.917282 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:25:17.921162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:17.927637 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:17.929997 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:17.932233 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:25:17.981384 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.046 seconds
[0m06:25:17.997016 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.001045 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:25:18.004912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.016061 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.019996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:25:18.023687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.028959 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:25:18.031173 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.035102 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:25:18.039384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:25:18.048161 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:25:18.054057 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:18.056953 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:25:18.062919 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:18.071376 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:25:18.075601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae14459a0>]}
[0m06:25:18.079365 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.29s]
[0m06:25:18.085401 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:18.088559 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:25:18.091608 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:25:18.095344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:25:18.099208 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:25:18.115723 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.131074 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:25:18.144423 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.157951 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.159718 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:25:18.161402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:18.168254 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:18.170936 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.173075 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:25:18.211226 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.036 seconds
[0m06:25:18.223113 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.224753 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:25:18.226561 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:18.235801 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.237439 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:25:18.239282 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:18.243030 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:25:18.244441 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.245851 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:25:18.249649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:25:18.257939 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:25:18.260364 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:18.261819 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:25:18.269380 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:25:18.276695 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:25:18.280370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ade8f14f0>]}
[0m06:25:18.285345 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.19s]
[0m06:25:18.290801 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:25:18.293409 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:25:18.296149 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:25:18.299774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:25:18.303391 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:25:18.314278 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.331688 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:25:18.351992 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.373483 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.376558 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:25:18.379384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:18.391747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m06:25:18.395882 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.399792 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:25:18.459564 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.055 seconds
[0m06:25:18.471065 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.473163 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:25:18.475391 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.484172 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.487481 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:25:18.489696 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:18.493693 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:25:18.495479 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.497101 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:25:18.500970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:25:18.513498 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:25:18.517511 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:18.520944 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:25:18.526542 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:18.531160 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:25:18.535298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adecac580>]}
[0m06:25:18.542508 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.24s]
[0m06:25:18.548644 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:25:18.557668 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:25:18.565867 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:25:18.571619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:25:18.576089 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:25:18.596425 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.608660 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:25:18.623358 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.633617 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.636422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:25:18.637934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:18.643474 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:25:18.645544 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.647781 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:25:18.672488 [debug] [Thread-1  ]: SQL status: SELECT 2416 in 0.022 seconds
[0m06:25:18.688539 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.693969 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:25:18.696970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.711092 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.722292 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:25:18.725591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:18.729503 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:25:18.731042 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.733626 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:25:18.737392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:25:18.744070 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:25:18.746284 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:18.747795 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:25:18.754773 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:25:18.760588 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:25:18.763175 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65530432-d395-4e71-9c41-a8a5ff19bd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ade987e50>]}
[0m06:25:18.766597 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2416[0m in 0.19s]
[0m06:25:18.770391 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:25:18.773869 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:18.775290 [debug] [MainThread]: On master: BEGIN
[0m06:25:18.776571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:25:18.782053 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:25:18.785498 [debug] [MainThread]: On master: COMMIT
[0m06:25:18.788020 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:18.789472 [debug] [MainThread]: On master: COMMIT
[0m06:25:18.791089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:18.792612 [debug] [MainThread]: On master: Close
[0m06:25:18.794611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:18.795942 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:25:18.797682 [info ] [MainThread]: 
[0m06:25:18.801433 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m06:25:18.806667 [debug] [MainThread]: Command end result
[0m06:25:18.885985 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:25:18.894360 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:25:18.920576 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:25:18.922355 [info ] [MainThread]: 
[0m06:25:18.924716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:25:18.927206 [info ] [MainThread]: 
[0m06:25:18.929779 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:25:18.937857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.029662, "process_in_blocks": "83984", "process_kernel_time": 1.182595, "process_mem_max_rss": "108544", "process_out_blocks": "0", "process_user_time": 8.317918}
[0m06:25:18.940529 [debug] [MainThread]: Command `dbt run` succeeded at 06:25:18.940028 after 6.03 seconds
[0m06:25:18.942949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ae15d7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf4c0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9adf4c0f70>]}
[0m06:25:18.944928 [debug] [MainThread]: Flushing usage events
[0m06:25:21.418511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:33:45.919433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ad8500a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac98ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac98eac0>]}


============================== 06:33:45.948139 | c85d3227-babc-43f1-a07c-c1d72d1c3492 ==============================
[0m06:33:45.948139 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:33:45.952651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:33:47.090875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac96b8e0>]}
[0m06:33:47.380774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ac1181c0>]}
[0m06:33:47.383135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:33:47.580778 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:33:48.092747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:33:48.094297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:33:48.268310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab55bf10>]}
[0m06:33:48.560049 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:33:48.578297 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:33:48.614086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab546ac0>]}
[0m06:33:48.616673 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:33:48.620065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50addbd5e0>]}
[0m06:33:48.627245 [info ] [MainThread]: 
[0m06:33:48.629836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:33:48.632155 [info ] [MainThread]: 
[0m06:33:48.634775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:33:48.653296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:33:48.745567 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:33:48.747310 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:33:48.748808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:48.758089 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m06:33:48.763331 [debug] [ThreadPool]: On list_airflow: Close
[0m06:33:48.768987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:33:48.786301 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:33:48.789129 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:33:48.791070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:48.797766 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:33:48.799961 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:33:48.801636 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:33:48.810842 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m06:33:48.814858 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:33:48.816604 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:33:48.836763 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.838835 [debug] [MainThread]: On master: BEGIN
[0m06:33:48.840431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:33:48.847744 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:33:48.850038 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.851919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:33:48.859719 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m06:33:48.863889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab57c7f0>]}
[0m06:33:48.865903 [debug] [MainThread]: On master: ROLLBACK
[0m06:33:48.867769 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.870231 [debug] [MainThread]: On master: BEGIN
[0m06:33:48.873015 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:33:48.875037 [debug] [MainThread]: On master: COMMIT
[0m06:33:48.876647 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:48.878343 [debug] [MainThread]: On master: COMMIT
[0m06:33:48.880294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:48.882049 [debug] [MainThread]: On master: Close
[0m06:33:48.889858 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:33:48.892119 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:33:48.894781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:33:48.896719 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:33:48.924473 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:33:48.933748 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:33:49.045891 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.062450 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.065794 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:33:49.068180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.076106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:33:49.078166 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.079955 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:33:49.142309 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.061 seconds
[0m06:33:49.158915 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.161055 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:33:49.163603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.174851 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.176870 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:33:49.179335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.238702 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:33:49.240619 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.242071 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:33:49.246763 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:33:49.262587 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:33:49.276280 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:33:49.277900 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:33:49.282696 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:33:49.290209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:33:49.295430 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aac756d0>]}
[0m06:33:49.297684 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7765[0m in 0.40s]
[0m06:33:49.301065 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:33:49.304041 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.307095 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:33:49.309723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:33:49.311941 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.322304 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.331885 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.342285 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.352853 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.355262 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:33:49.357139 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.363537 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:33:49.366603 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.368583 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:33:49.417742 [debug] [Thread-1  ]: SQL status: SELECT 7765 in 0.046 seconds
[0m06:33:49.427016 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.429209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:33:49.432212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.443796 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.445670 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:33:49.447841 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.452832 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:33:49.455197 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.456943 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:33:49.461314 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:33:49.470789 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:33:49.473267 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:33:49.475025 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:33:49.480216 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:33:49.483996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:33:49.487231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:49.490195 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7765[0m in 0.18s]
[0m06:33:49.493170 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:33:49.495221 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.497497 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:33:49.500064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:33:49.501887 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.513377 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.523843 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.609180 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.620415 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.622572 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:33:49.624233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.631027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:33:49.633455 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.635532 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:33:49.679516 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.041 seconds
[0m06:33:49.689827 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.691543 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:33:49.693781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.701208 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.703588 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:33:49.706236 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:49.710317 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:33:49.712045 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.713705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:33:49.719529 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:33:49.726872 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:33:49.729468 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:33:49.731202 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:33:49.735639 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:33:49.739856 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:33:49.741932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:49.744729 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.24s]
[0m06:33:49.747606 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:33:49.750072 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:33:49.752933 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:33:49.756723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:33:49.760328 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:33:49.770715 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.780957 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:33:49.797308 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.809873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.811999 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:33:49.813730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:49.821170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:33:49.823331 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.825069 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:33:49.889553 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.062 seconds
[0m06:33:49.898904 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.901366 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:33:49.905421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.913071 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.914702 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:33:49.917273 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:49.922346 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:33:49.924142 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.926272 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:33:49.930892 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:33:49.938518 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:33:49.941234 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:33:49.942911 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:33:49.972594 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.025 seconds
[0m06:33:49.976824 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:33:49.978970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:49.981107 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.22s]
[0m06:33:49.984734 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:33:49.987533 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:33:49.989886 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:33:49.993011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:33:49.999178 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:33:50.008774 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.019084 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:33:50.029410 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.040461 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.042224 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:33:50.043996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:50.051568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:33:50.056104 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.059280 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:33:50.099423 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.038 seconds
[0m06:33:50.108085 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.109743 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:33:50.111649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:50.119508 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.121127 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:33:50.123031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:33:50.126854 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:33:50.128754 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.130627 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:33:50.134070 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:33:50.142851 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:33:50.145167 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:33:50.146928 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:33:50.152803 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:33:50.156955 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:33:50.159940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ada22df0>]}
[0m06:33:50.163134 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.17s]
[0m06:33:50.166454 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:33:50.170293 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:33:50.173286 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:33:50.176762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:33:50.179113 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:33:50.190294 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.202817 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:33:50.214355 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.226880 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.228994 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:33:50.230832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:33:50.238917 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:33:50.241454 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.243635 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:33:50.263861 [debug] [Thread-1  ]: SQL status: SELECT 2416 in 0.018 seconds
[0m06:33:50.277437 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.280279 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:33:50.284326 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:50.296587 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.298807 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:33:50.304339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:33:50.308917 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:33:50.310889 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.312976 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:33:50.318932 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:33:50.326114 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:33:50.328650 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:33:50.330308 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:33:50.335966 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:33:50.340286 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:33:50.342831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c85d3227-babc-43f1-a07c-c1d72d1c3492', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50aa8db910>]}
[0m06:33:50.345320 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2416[0m in 0.17s]
[0m06:33:50.348229 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:33:50.353195 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:50.354721 [debug] [MainThread]: On master: BEGIN
[0m06:33:50.356057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:33:50.361773 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:33:50.364222 [debug] [MainThread]: On master: COMMIT
[0m06:33:50.366503 [debug] [MainThread]: Using postgres connection "master"
[0m06:33:50.370067 [debug] [MainThread]: On master: COMMIT
[0m06:33:50.371907 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:33:50.373660 [debug] [MainThread]: On master: Close
[0m06:33:50.376104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:33:50.378700 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:33:50.380908 [info ] [MainThread]: 
[0m06:33:50.385739 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m06:33:50.393375 [debug] [MainThread]: Command end result
[0m06:33:50.465360 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:33:50.474149 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:33:50.499715 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:33:50.502998 [info ] [MainThread]: 
[0m06:33:50.505999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:33:50.508596 [info ] [MainThread]: 
[0m06:33:50.511143 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:33:50.514287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.941845, "process_in_blocks": "0", "process_kernel_time": 0.783924, "process_mem_max_rss": "108176", "process_out_blocks": "0", "process_user_time": 8.27141}
[0m06:33:50.517545 [debug] [MainThread]: Command `dbt run` succeeded at 06:33:50.516219 after 4.94 seconds
[0m06:33:50.520080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ad8500a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50ab5bc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50add26880>]}
[0m06:33:50.522020 [debug] [MainThread]: Flushing usage events
[0m06:33:51.883021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:12.663000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6c770d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b5db59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b5db5a30>]}


============================== 14:29:12.676137 | 670d0ce7-1036-42e8-b508-d02c9e590e07 ==============================
[0m14:29:12.676137 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:29:12.678519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:29:13.223519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b7c149d0>]}
[0m14:29:13.404327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b5582f70>]}
[0m14:29:13.407756 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:29:13.693797 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:29:14.369887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:14.371566 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:14.473744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499bf40>]}
[0m14:29:14.712042 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:29:14.723421 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:29:14.763039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499bf70>]}
[0m14:29:14.765414 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m14:29:14.767194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b71aa460>]}
[0m14:29:14.772096 [info ] [MainThread]: 
[0m14:29:14.774122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:29:14.775655 [info ] [MainThread]: 
[0m14:29:14.777538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:14.790675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:29:14.866709 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:29:14.868659 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:29:14.870735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:14.880698 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m14:29:14.884233 [debug] [ThreadPool]: On list_airflow: Close
[0m14:29:14.888741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m14:29:14.904575 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m14:29:14.906737 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m14:29:14.908552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:14.914987 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:29:14.916832 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m14:29:14.919357 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m14:29:14.926878 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.006 seconds
[0m14:29:14.931693 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m14:29:14.933735 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m14:29:14.947427 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.949120 [debug] [MainThread]: On master: BEGIN
[0m14:29:14.950503 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:14.955997 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:29:14.957493 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.958926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:29:14.965730 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m14:29:14.969177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b49a5d60>]}
[0m14:29:14.970861 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:14.972480 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.973828 [debug] [MainThread]: On master: BEGIN
[0m14:29:14.975768 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:29:14.977277 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.979450 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:14.981650 [debug] [MainThread]: On master: COMMIT
[0m14:29:14.983914 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:14.985736 [debug] [MainThread]: On master: Close
[0m14:29:14.991617 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m14:29:14.993678 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m14:29:14.995566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m14:29:14.997453 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m14:29:15.030552 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.045539 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m14:29:15.156423 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.166522 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.168594 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m14:29:15.170420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.176410 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m14:29:15.178148 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.180250 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m14:29:15.269116 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 0.087 seconds
[0m14:29:15.284033 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.285799 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m14:29:15.288338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.297024 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.299162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m14:29:15.301350 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:15.357150 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m14:29:15.358849 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.360377 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m14:29:15.364688 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m14:29:15.384164 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m14:29:15.396141 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m14:29:15.398615 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m14:29:15.403668 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:15.410130 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m14:29:15.415843 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b40b5700>]}
[0m14:29:15.417954 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7770[0m in 0.42s]
[0m14:29:15.420107 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m14:29:15.421707 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.423433 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m14:29:15.425313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m14:29:15.426787 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.437017 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.447597 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.457257 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.468142 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.469897 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m14:29:15.471593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.478236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:29:15.480744 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.483038 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m14:29:15.524896 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 0.040 seconds
[0m14:29:15.533210 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.535254 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m14:29:15.538069 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.548496 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.550432 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m14:29:15.552655 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:15.557398 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m14:29:15.559297 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.561155 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m14:29:15.566636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m14:29:15.574662 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m14:29:15.577706 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m14:29:15.579591 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m14:29:15.585233 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:15.588744 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m14:29:15.591074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6e32580>]}
[0m14:29:15.593430 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7770[0m in 0.17s]
[0m14:29:15.596419 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m14:29:15.598740 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.600895 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m14:29:15.603198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m14:29:15.605348 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.615506 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.626448 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.696082 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.706458 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.708147 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m14:29:15.709792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.716808 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m14:29:15.718868 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.720845 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m14:29:15.771823 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.049 seconds
[0m14:29:15.779891 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.781705 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m14:29:15.784038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.791728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.793418 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m14:29:15.796280 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.801575 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m14:29:15.803413 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.805366 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m14:29:15.809087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:15.816141 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m14:29:15.818496 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m14:29:15.820181 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m14:29:15.824220 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:29:15.827818 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m14:29:15.830727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6e32580>]}
[0m14:29:15.833045 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.23s]
[0m14:29:15.835136 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m14:29:15.836775 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m14:29:15.838459 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m14:29:15.840169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m14:29:15.841603 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m14:29:15.849772 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.858750 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m14:29:15.868972 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.878750 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.880881 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m14:29:15.882524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:15.888174 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m14:29:15.890035 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.891823 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m14:29:15.928602 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.035 seconds
[0m14:29:15.941461 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.943406 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m14:29:15.945954 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.954831 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.956586 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m14:29:15.958753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:15.962996 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m14:29:15.965556 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.967358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m14:29:15.970520 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:15.977242 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m14:29:15.980646 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m14:29:15.982429 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m14:29:15.986265 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:29:15.989923 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m14:29:15.991981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b51e8940>]}
[0m14:29:15.994141 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.15s]
[0m14:29:15.996727 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m14:29:15.998782 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m14:29:16.000721 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m14:29:16.002555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m14:29:16.004273 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m14:29:16.012601 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.022378 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m14:29:16.033174 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.043746 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.045670 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m14:29:16.047911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:16.054432 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m14:29:16.056078 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.057982 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m14:29:16.094620 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.035 seconds
[0m14:29:16.103497 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.105307 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m14:29:16.107297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:16.115329 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.116926 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m14:29:16.118950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:16.122864 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m14:29:16.124565 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.126117 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m14:29:16.129974 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:16.138869 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m14:29:16.141591 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m14:29:16.143384 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m14:29:16.148465 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:16.152147 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m14:29:16.154609 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b51e8940>]}
[0m14:29:16.157087 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.15s]
[0m14:29:16.159339 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m14:29:16.161166 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m14:29:16.163320 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m14:29:16.165655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m14:29:16.167414 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m14:29:16.174958 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.185400 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m14:29:16.194805 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.209519 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.212168 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m14:29:16.215168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:29:16.222954 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m14:29:16.225054 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.226857 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m14:29:16.242424 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.014 seconds
[0m14:29:16.252336 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.254813 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m14:29:16.261510 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:29:16.272158 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.274014 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m14:29:16.276166 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:16.281492 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m14:29:16.283222 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.285043 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m14:29:16.288275 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m14:29:16.296006 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m14:29:16.299413 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m14:29:16.301336 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m14:29:16.305950 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m14:29:16.309508 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m14:29:16.311608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '670d0ce7-1036-42e8-b508-d02c9e590e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b48ddd90>]}
[0m14:29:16.314885 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.15s]
[0m14:29:16.317900 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m14:29:16.321263 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:16.322693 [debug] [MainThread]: On master: BEGIN
[0m14:29:16.324018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:16.329941 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:29:16.331709 [debug] [MainThread]: On master: COMMIT
[0m14:29:16.333179 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:16.334687 [debug] [MainThread]: On master: COMMIT
[0m14:29:16.336401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:16.337794 [debug] [MainThread]: On master: Close
[0m14:29:16.339397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:16.340694 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m14:29:16.342125 [info ] [MainThread]: 
[0m14:29:16.343720 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m14:29:16.348475 [debug] [MainThread]: Command end result
[0m14:29:16.418410 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m14:29:16.426381 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m14:29:16.449812 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m14:29:16.451946 [info ] [MainThread]: 
[0m14:29:16.453936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:16.455844 [info ] [MainThread]: 
[0m14:29:16.458239 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:29:16.463686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.06171, "process_in_blocks": "16360", "process_kernel_time": 0.418592, "process_mem_max_rss": "107896", "process_out_blocks": "0", "process_user_time": 6.348655}
[0m14:29:16.466393 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:16.465888 after 4.06 seconds
[0m14:29:16.468667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b6c770d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b499cd30>]}
[0m14:29:16.470611 [debug] [MainThread]: Flushing usage events
[0m14:29:18.462300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:17:26.001297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ef02040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675e045550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675e0454f0>]}


============================== 06:17:26.047090 | 824cb69d-f2a9-4a74-b710-e00594454ad1 ==============================
[0m06:17:26.047090 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:17:26.058771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:17:28.336686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675d7c7ee0>]}
[0m06:17:28.893644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675d7d9100>]}
[0m06:17:28.910202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:17:29.544619 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:17:32.749788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:17:32.751964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:17:33.068350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce5beb0>]}
[0m06:17:33.843667 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:17:33.903575 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:17:34.208804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce9b850>]}
[0m06:17:34.211672 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:17:34.214288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce98e20>]}
[0m06:17:34.226005 [info ] [MainThread]: 
[0m06:17:34.245337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:17:34.247770 [info ] [MainThread]: 
[0m06:17:34.250730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:17:34.302008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:17:35.092185 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:17:35.109373 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:17:35.115499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:17:35.661439 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.546 seconds
[0m06:17:35.667612 [debug] [ThreadPool]: On list_airflow: Close
[0m06:17:35.692158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:17:35.737710 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:17:35.744703 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:17:35.746691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:17:35.754128 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m06:17:35.756355 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:17:35.758426 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:17:35.778974 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.018 seconds
[0m06:17:35.787401 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:17:35.790876 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:17:35.819213 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.821331 [debug] [MainThread]: On master: BEGIN
[0m06:17:35.823492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:17:35.847941 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m06:17:35.851103 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.863805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:17:35.879408 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m06:17:35.884287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ce7ce20>]}
[0m06:17:35.887651 [debug] [MainThread]: On master: ROLLBACK
[0m06:17:35.890183 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.894291 [debug] [MainThread]: On master: BEGIN
[0m06:17:35.898359 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:17:35.900873 [debug] [MainThread]: On master: COMMIT
[0m06:17:35.902966 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:35.906224 [debug] [MainThread]: On master: COMMIT
[0m06:17:35.920209 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:17:35.924419 [debug] [MainThread]: On master: Close
[0m06:17:35.936095 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:17:35.939065 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:17:35.944016 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:17:35.948928 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:17:35.997879 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.028982 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:17:36.308546 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.333254 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.335659 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:17:36.338311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:36.346157 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:17:36.348829 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:36.351231 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:17:37.694682 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 1.341 seconds
[0m06:17:37.736531 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:37.754987 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:17:37.758133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:37.773310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:37.786080 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:17:37.788966 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:37.955020 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:17:37.957568 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:37.960442 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:17:37.980823 [debug] [Thread-1  ]: SQL status: COMMIT in 0.018 seconds
[0m06:17:38.035568 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:17:38.060603 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:17:38.065151 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:17:38.093816 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.023 seconds
[0m06:17:38.112768 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:17:38.187631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675c335670>]}
[0m06:17:38.199566 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7770[0m in 2.21s]
[0m06:17:38.220116 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:17:38.225277 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.231131 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:17:38.241727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:17:38.246867 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.268606 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.307514 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.355473 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.411860 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.431618 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:17:38.434978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:38.458250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m06:17:38.484884 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.494579 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:17:38.700076 [debug] [Thread-1  ]: SQL status: SELECT 7770 in 0.189 seconds
[0m06:17:38.721627 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.724083 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:17:38.728293 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:38.757020 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.764101 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:17:38.771733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:38.779326 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:17:38.782341 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.784877 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:17:38.826909 [debug] [Thread-1  ]: SQL status: COMMIT in 0.031 seconds
[0m06:17:38.847788 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:17:38.851633 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:17:38.863965 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:17:38.885112 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.019 seconds
[0m06:17:38.890266 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:17:38.893239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:38.898178 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7770[0m in 0.65s]
[0m06:17:38.908578 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:17:38.913092 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:38.916470 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:17:38.919539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:17:38.922202 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:38.954590 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:38.986937 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:39.256611 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.286067 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.289903 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:17:39.292874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:39.303036 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m06:17:39.305573 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.308409 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:17:39.496301 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.182 seconds
[0m06:17:39.520823 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.524846 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:17:39.534885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:39.574850 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.581088 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:17:39.587070 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:39.605709 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:17:39.608503 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.611734 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:17:39.644372 [debug] [Thread-1  ]: SQL status: COMMIT in 0.021 seconds
[0m06:17:39.659833 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:17:39.673573 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:17:39.676387 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:17:39.689750 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.010 seconds
[0m06:17:39.705630 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:17:39.709191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:39.721738 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.79s]
[0m06:17:39.729502 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:17:39.732705 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:17:39.735657 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:17:39.744962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:17:39.749793 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:17:39.771101 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.803345 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:17:39.840772 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.856031 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.859003 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:17:39.862019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:39.882150 [debug] [Thread-1  ]: SQL status: BEGIN in 0.020 seconds
[0m06:17:39.884976 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:39.887448 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:17:40.055151 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.165 seconds
[0m06:17:40.078212 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.081349 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:17:40.084433 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.103642 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.115568 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:17:40.118775 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.125108 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:17:40.128301 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.130980 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:17:40.151756 [debug] [Thread-1  ]: SQL status: COMMIT in 0.018 seconds
[0m06:17:40.162150 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:17:40.173480 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:17:40.176015 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:17:40.196307 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m06:17:40.201986 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:17:40.207001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:40.216674 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.46s]
[0m06:17:40.224388 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:17:40.234729 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:17:40.238695 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:17:40.257266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:17:40.263487 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:17:40.305590 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.331735 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:17:40.348352 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.379402 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.382029 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:17:40.385036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:40.395337 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m06:17:40.398223 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.401145 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:17:40.541647 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.138 seconds
[0m06:17:40.569891 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.597467 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:17:40.606002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.628112 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.630395 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:17:40.640870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:40.656719 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:17:40.679135 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.682621 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:17:40.701154 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m06:17:40.728575 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:17:40.738071 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:17:40.742678 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:17:40.776120 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.031 seconds
[0m06:17:40.781927 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:17:40.791899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ed709a0>]}
[0m06:17:40.795908 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.53s]
[0m06:17:40.813577 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:17:40.816802 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:17:40.822774 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:17:40.832150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:17:40.867657 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:17:40.892913 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.919160 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:17:40.943070 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.961661 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.964881 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:17:40.969490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:17:40.978575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:17:40.981968 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:40.985246 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:17:41.023391 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.035 seconds
[0m06:17:41.047679 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.050491 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:17:41.053683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:41.070840 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.073169 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:17:41.085806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:17:41.092574 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:17:41.096935 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.107747 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:17:41.118989 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m06:17:41.132439 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:17:41.144356 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:17:41.148274 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:17:41.157412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m06:17:41.163448 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:17:41.166709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824cb69d-f2a9-4a74-b710-e00594454ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675cb50ac0>]}
[0m06:17:41.177900 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.33s]
[0m06:17:41.183143 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:17:41.188439 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:41.190593 [debug] [MainThread]: On master: BEGIN
[0m06:17:41.193820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:17:41.210510 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m06:17:41.215927 [debug] [MainThread]: On master: COMMIT
[0m06:17:41.218882 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:41.221147 [debug] [MainThread]: On master: COMMIT
[0m06:17:41.226507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:17:41.228759 [debug] [MainThread]: On master: Close
[0m06:17:41.236525 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:17:41.243043 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:17:41.250885 [info ] [MainThread]: 
[0m06:17:41.264585 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 7.00 seconds (7.00s).
[0m06:17:41.296626 [debug] [MainThread]: Command end result
[0m06:17:41.534932 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:17:41.564783 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:17:41.609376 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:17:41.612053 [info ] [MainThread]: 
[0m06:17:41.615879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:17:41.620103 [info ] [MainThread]: 
[0m06:17:41.626536 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:17:41.644495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.796707, "process_in_blocks": "84160", "process_kernel_time": 3.207221, "process_mem_max_rss": "108056", "process_out_blocks": "0", "process_user_time": 16.776236}
[0m06:17:41.652881 [debug] [MainThread]: Command `dbt run` succeeded at 06:17:41.651582 after 16.81 seconds
[0m06:17:41.658389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675ef02040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675cbc0370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f675cbc0f70>]}
[0m06:17:41.661710 [debug] [MainThread]: Flushing usage events
[0m06:17:42.770525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:57.447273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069d230a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068e665b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068e66550>]}


============================== 10:03:57.455121 | 854c9374-1a52-46f8-a869-63de084ce50d ==============================
[0m10:03:57.455121 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:03:57.462075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:57.849649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe068e3e8e0>]}
[0m10:03:57.968638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0688671c0>]}
[0m10:03:57.971160 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:58.135030 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:03:58.788942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:58.790170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:58.933791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c9bf10>]}
[0m10:03:59.173723 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:03:59.209556 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:03:59.258728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c86ac0>]}
[0m10:03:59.260309 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m10:03:59.261727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe06a28ca60>]}
[0m10:03:59.267103 [info ] [MainThread]: 
[0m10:03:59.268675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:59.270024 [info ] [MainThread]: 
[0m10:03:59.271953 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:59.283247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:03:59.378270 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:03:59.379927 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:03:59.381350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:59.427800 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.046 seconds
[0m10:03:59.430041 [debug] [ThreadPool]: On list_airflow: Close
[0m10:03:59.433231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:03:59.445678 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:03:59.446719 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:03:59.447613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:59.451555 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:03:59.453069 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:03:59.454414 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:03:59.480560 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.024 seconds
[0m10:03:59.487366 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:03:59.489010 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:03:59.511956 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.515135 [debug] [MainThread]: On master: BEGIN
[0m10:03:59.516196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:59.520231 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:03:59.521997 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.522987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:59.531111 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m10:03:59.534016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067cbc7f0>]}
[0m10:03:59.535324 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:59.536672 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.537998 [debug] [MainThread]: On master: BEGIN
[0m10:03:59.539716 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:03:59.540969 [debug] [MainThread]: On master: COMMIT
[0m10:03:59.542109 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:59.543273 [debug] [MainThread]: On master: COMMIT
[0m10:03:59.548368 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:03:59.551671 [debug] [MainThread]: On master: Close
[0m10:03:59.558859 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.560808 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m10:03:59.563779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m10:03:59.565740 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.584792 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.590449 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.653885 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.662989 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.664528 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m10:03:59.665626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:03:59.670366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:03:59.672084 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.673453 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:03:59.756310 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.082 seconds
[0m10:03:59.771045 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.772797 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m10:03:59.775988 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:03:59.785548 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.786734 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m10:03:59.788437 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:03:59.828158 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:03:59.829509 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.830513 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:03:59.832797 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:03:59.844689 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m10:03:59.851822 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:03:59.852980 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m10:03:59.858414 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m10:03:59.863301 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m10:03:59.872128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0671776d0>]}
[0m10:03:59.876172 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7775[0m in 0.31s]
[0m10:03:59.877995 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m10:03:59.880539 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:03:59.882147 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:03:59.884104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m10:03:59.885475 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:03:59.893311 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.901568 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:03:59.918270 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.930902 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.948131 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:03:59.949722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:03:59.954533 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:03:59.955980 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:03:59.957358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:04:00.010243 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.052 seconds
[0m10:04:00.021692 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.027207 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m10:04:00.029555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:04:00.036330 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.038744 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:04:00.040868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.045491 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:04:00.046875 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.047995 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:04:00.051629 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m10:04:00.057538 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:04:00.059623 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:04:00.061103 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:04:00.069527 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m10:04:00.072087 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:04:00.073585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.075457 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7775[0m in 0.19s]
[0m10:04:00.077205 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:04:00.078435 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.080332 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m10:04:00.081876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m10:04:00.082972 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.089798 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.095524 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.158541 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.165145 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.166497 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m10:04:00.167673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.172167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m10:04:00.173579 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.174964 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m10:04:00.203791 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.028 seconds
[0m10:04:00.208788 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.209751 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m10:04:00.211051 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.216116 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.217151 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m10:04:00.218375 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.221041 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:04:00.222004 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.222929 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:04:00.225157 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:04:00.230363 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m10:04:00.231892 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:04:00.232739 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m10:04:00.235258 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.237521 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m10:04:00.238749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.240093 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.16s]
[0m10:04:00.242387 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m10:04:00.244225 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m10:04:00.245596 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m10:04:00.247214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m10:04:00.248251 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m10:04:00.253170 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.258606 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m10:04:00.265925 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.271325 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.272390 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m10:04:00.273235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.276746 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.278052 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.279633 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m10:04:00.302718 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.022 seconds
[0m10:04:00.310027 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.311525 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m10:04:00.313283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.318175 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.319368 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m10:04:00.320702 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.323132 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:04:00.324030 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.324868 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:04:00.327235 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:04:00.332296 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m10:04:00.333788 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:04:00.334760 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m10:04:00.337804 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.339982 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m10:04:00.341244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.342664 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.09s]
[0m10:04:00.344385 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m10:04:00.345531 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m10:04:00.346953 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m10:04:00.348544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m10:04:00.349465 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m10:04:00.355714 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.361356 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m10:04:00.367790 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.373356 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.374557 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m10:04:00.375473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.378922 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.380252 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.381156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m10:04:00.404412 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.022 seconds
[0m10:04:00.411201 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.413133 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m10:04:00.414961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:04:00.420997 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.422076 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m10:04:00.423471 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.426016 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:04:00.427101 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.428358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:04:00.430931 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:04:00.437309 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m10:04:00.440966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:04:00.442135 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m10:04:00.445304 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.447595 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m10:04:00.448936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069ef5df0>]}
[0m10:04:00.450547 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.10s]
[0m10:04:00.452183 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m10:04:00.453230 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m10:04:00.454321 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m10:04:00.455550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m10:04:00.456506 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m10:04:00.461247 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.467048 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m10:04:00.473779 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.479869 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.480923 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m10:04:00.481784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:04:00.485143 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.486267 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.487161 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m10:04:00.497497 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.009 seconds
[0m10:04:00.502144 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.503158 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m10:04:00.504373 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.512728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.513723 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m10:04:00.515154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:04:00.517537 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:04:00.518381 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.519240 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:04:00.521874 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m10:04:00.525648 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m10:04:00.526832 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:04:00.527642 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m10:04:00.530611 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:04:00.533619 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m10:04:00.535487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854c9374-1a52-46f8-a869-63de084ce50d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe066df4910>]}
[0m10:04:00.537008 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.08s]
[0m10:04:00.538806 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m10:04:00.540853 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.541707 [debug] [MainThread]: On master: BEGIN
[0m10:04:00.542452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:00.545919 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:04:00.547066 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.547937 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.548687 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.549641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:04:00.550382 [debug] [MainThread]: On master: Close
[0m10:04:00.551591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:00.552676 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m10:04:00.554121 [info ] [MainThread]: 
[0m10:04:00.555390 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m10:04:00.558405 [debug] [MainThread]: Command end result
[0m10:04:00.600379 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:04:00.604825 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:04:00.618753 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:04:00.619732 [info ] [MainThread]: 
[0m10:04:00.621023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:04:00.622337 [info ] [MainThread]: 
[0m10:04:00.623590 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:04:00.626339 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3383715, "process_in_blocks": "84864", "process_kernel_time": 0.459427, "process_mem_max_rss": "107988", "process_out_blocks": "0", "process_user_time": 4.951602}
[0m10:04:00.627389 [debug] [MainThread]: Command `dbt run` succeeded at 10:04:00.627252 after 3.34 seconds
[0m10:04:00.628477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe069d230a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c401c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe067c40d00>]}
[0m10:04:00.629487 [debug] [MainThread]: Flushing usage events
[0m10:04:01.553981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:29.714441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639ece100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463900da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463900da90>]}


============================== 10:05:29.719376 | 9280a4d3-021c-4678-8d89-55cba31cd400 ==============================
[0m10:05:29.719376 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:05:29.721048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:05:30.109064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463afb80a0>]}
[0m10:05:30.212259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463966dc70>]}
[0m10:05:30.213931 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:05:30.351891 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:05:30.625075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:05:30.626349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:05:30.702862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bdbf70>]}
[0m10:05:30.895254 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:05:30.903579 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:05:30.943156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bdb790>]}
[0m10:05:30.945151 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m10:05:30.946889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a0cda60>]}
[0m10:05:30.951486 [info ] [MainThread]: 
[0m10:05:30.953310 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:05:30.954782 [info ] [MainThread]: 
[0m10:05:30.956742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:30.967445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:05:31.015301 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:05:31.017021 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:05:31.018133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:31.023134 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m10:05:31.025096 [debug] [ThreadPool]: On list_airflow: Close
[0m10:05:31.028196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:05:31.037915 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:05:31.039091 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:05:31.040342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:05:31.043674 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m10:05:31.044938 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:05:31.045929 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:05:31.049577 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m10:05:31.053160 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:05:31.054551 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:05:31.062905 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.064305 [debug] [MainThread]: On master: BEGIN
[0m10:05:31.065527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:31.071045 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:05:31.072863 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.074319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:05:31.079055 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:05:31.082370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bfc610>]}
[0m10:05:31.084254 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:31.085844 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.086953 [debug] [MainThread]: On master: BEGIN
[0m10:05:31.088332 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:05:31.089619 [debug] [MainThread]: On master: COMMIT
[0m10:05:31.090887 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:31.099400 [debug] [MainThread]: On master: COMMIT
[0m10:05:31.100802 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:05:31.102354 [debug] [MainThread]: On master: Close
[0m10:05:31.106459 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.107965 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m10:05:31.109378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m10:05:31.110746 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.125748 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.130796 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.194076 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.198792 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.200130 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m10:05:31.201093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.204978 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m10:05:31.206506 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.207690 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:05:31.235333 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.026 seconds
[0m10:05:31.243723 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.244741 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m10:05:31.245850 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.250439 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.251621 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m10:05:31.253184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.279278 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:05:31.280533 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.281471 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:05:31.354010 [debug] [Thread-1  ]: SQL status: COMMIT in 0.071 seconds
[0m10:05:31.362065 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m10:05:31.369285 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:05:31.370635 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m10:05:31.385436 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m10:05:31.388961 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m10:05:31.391416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46372f7730>]}
[0m10:05:31.393015 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7775[0m in 0.28s]
[0m10:05:31.394662 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m10:05:31.395738 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.396813 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:05:31.398306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m10:05:31.399968 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.406954 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.412565 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.418515 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.424242 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.425897 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:05:31.426971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.430176 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:05:31.431641 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.433211 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:05:31.479901 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.045 seconds
[0m10:05:31.486261 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.487850 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m10:05:31.489495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.494634 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.495810 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:05:31.497174 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.500096 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:05:31.501957 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.503196 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:05:31.570911 [debug] [Thread-1  ]: SQL status: COMMIT in 0.066 seconds
[0m10:05:31.575046 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:05:31.576370 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:05:31.577267 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:05:31.580266 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:31.582761 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:05:31.584514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a087eb0>]}
[0m10:05:31.586002 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7775[0m in 0.19s]
[0m10:05:31.587652 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:05:31.588696 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.589755 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m10:05:31.591284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m10:05:31.592428 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.598856 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.605229 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.667132 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.676912 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.678288 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m10:05:31.679557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.684407 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:05:31.686426 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.687990 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m10:05:31.740661 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.051 seconds
[0m10:05:31.745679 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.746757 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m10:05:31.748650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:05:31.753845 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.754954 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m10:05:31.756485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.759233 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:05:31.760495 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.761565 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:05:31.763743 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:05:31.768191 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m10:05:31.769766 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:05:31.770742 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m10:05:31.773327 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:31.775513 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m10:05:31.776797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a087eb0>]}
[0m10:05:31.778243 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.19s]
[0m10:05:31.780251 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m10:05:31.781519 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m10:05:31.782700 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m10:05:31.784331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m10:05:31.785597 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m10:05:31.790286 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.796015 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m10:05:31.801847 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.806873 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.807863 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m10:05:31.808974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.813813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:05:31.815471 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.816506 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m10:05:31.866337 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.049 seconds
[0m10:05:31.873044 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.874473 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m10:05:31.876252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.880744 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.881887 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m10:05:31.883275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:31.885746 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:05:31.886839 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.887638 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:05:31.889711 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:05:31.893814 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m10:05:31.895441 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:05:31.896717 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m10:05:31.920903 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.023 seconds
[0m10:05:31.924209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m10:05:31.925687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463730eeb0>]}
[0m10:05:31.927177 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.14s]
[0m10:05:31.928948 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m10:05:31.930206 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m10:05:31.932018 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m10:05:31.934228 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m10:05:31.935786 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m10:05:31.941396 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.947091 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m10:05:31.953054 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.958466 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.959407 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m10:05:31.960220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:31.963427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:05:31.964939 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:31.966190 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m10:05:32.015348 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.048 seconds
[0m10:05:32.020277 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.021589 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m10:05:32.023084 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.028707 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.030171 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m10:05:32.031739 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.034814 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:05:32.036219 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.037490 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:05:32.053263 [debug] [Thread-1  ]: SQL status: COMMIT in 0.014 seconds
[0m10:05:32.059145 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m10:05:32.061103 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:05:32.062329 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m10:05:32.065029 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:32.067590 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m10:05:32.069098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463a087eb0>]}
[0m10:05:32.070580 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.13s]
[0m10:05:32.072236 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m10:05:32.073514 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m10:05:32.074805 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m10:05:32.076403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m10:05:32.077434 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m10:05:32.082083 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.087519 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m10:05:32.092919 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.098061 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.098997 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m10:05:32.099847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:05:32.102997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:05:32.104456 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.105574 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m10:05:32.113930 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.007 seconds
[0m10:05:32.139695 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.141059 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m10:05:32.142562 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.146962 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.148148 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m10:05:32.149418 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:05:32.152244 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:05:32.153574 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.154453 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:05:32.215987 [debug] [Thread-1  ]: SQL status: COMMIT in 0.061 seconds
[0m10:05:32.220216 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m10:05:32.221749 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:05:32.223119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m10:05:32.225823 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:05:32.227900 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m10:05:32.229123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9280a4d3-021c-4678-8d89-55cba31cd400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4636fb7760>]}
[0m10:05:32.230550 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.15s]
[0m10:05:32.232442 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m10:05:32.234807 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:32.235683 [debug] [MainThread]: On master: BEGIN
[0m10:05:32.236484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:05:32.239700 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:05:32.240965 [debug] [MainThread]: On master: COMMIT
[0m10:05:32.241867 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:32.242676 [debug] [MainThread]: On master: COMMIT
[0m10:05:32.243592 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:05:32.244485 [debug] [MainThread]: On master: Close
[0m10:05:32.245680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:32.247066 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m10:05:32.248606 [info ] [MainThread]: 
[0m10:05:32.249803 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m10:05:32.252632 [debug] [MainThread]: Command end result
[0m10:05:32.290971 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:05:32.296834 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:05:32.314249 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:05:32.315458 [info ] [MainThread]: 
[0m10:05:32.317184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:05:32.319032 [info ] [MainThread]: 
[0m10:05:32.320891 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:05:32.323725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7129738, "process_in_blocks": "0", "process_kernel_time": 0.282283, "process_mem_max_rss": "108272", "process_out_blocks": "0", "process_user_time": 4.375398}
[0m10:05:32.325447 [debug] [MainThread]: Command `dbt run` succeeded at 10:05:32.325076 after 2.71 seconds
[0m10:05:32.327060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4639ece100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463afb80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4637bff580>]}
[0m10:05:32.328546 [debug] [MainThread]: Flushing usage events
[0m10:05:33.176368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:16:35.046446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c73910130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c72a4f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c72a4f9d0>]}


============================== 06:16:35.063172 | 661c3ec1-6a2b-403d-9ae3-33a41ef85a6d ==============================
[0m06:16:35.063172 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:16:35.067429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:16:36.039687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c749fa220>]}
[0m06:16:36.284342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c730afa30>]}
[0m06:16:36.289078 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:16:36.599529 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:16:37.455842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:16:37.458460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:16:37.673153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7185bfa0>]}
[0m06:16:38.048041 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:16:38.062793 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:16:38.121441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7189b340>]}
[0m06:16:38.124251 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:16:38.127636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7314f460>]}
[0m06:16:38.135726 [info ] [MainThread]: 
[0m06:16:38.138925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:16:38.142339 [info ] [MainThread]: 
[0m06:16:38.146468 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:16:38.164711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:16:38.295662 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:16:38.297743 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:16:38.299603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:16:38.323045 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m06:16:38.327552 [debug] [ThreadPool]: On list_airflow: Close
[0m06:16:38.336261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:16:38.363387 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:16:38.365758 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:16:38.367840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:16:38.376750 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m06:16:38.380268 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:16:38.382936 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:16:38.394874 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m06:16:38.400817 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:16:38.403795 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:16:38.423962 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:38.427591 [debug] [MainThread]: On master: BEGIN
[0m06:16:38.430981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:16:38.444983 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m06:16:38.449762 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:38.453387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:16:38.470487 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m06:16:38.477990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7214a460>]}
[0m06:16:38.480779 [debug] [MainThread]: On master: ROLLBACK
[0m06:16:38.483678 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:38.485745 [debug] [MainThread]: On master: BEGIN
[0m06:16:38.488965 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:16:38.492544 [debug] [MainThread]: On master: COMMIT
[0m06:16:38.495355 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:38.497875 [debug] [MainThread]: On master: COMMIT
[0m06:16:38.500548 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:16:38.503024 [debug] [MainThread]: On master: Close
[0m06:16:38.524610 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:16:38.529154 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:16:38.537387 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:16:38.541981 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:16:38.582080 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:16:38.595332 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:16:38.719058 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:16:38.734066 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:16:38.736555 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:16:38.739174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:16:38.747652 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:16:38.750571 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:16:38.753298 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:16:38.840804 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.085 seconds
[0m06:16:38.873523 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:16:38.876324 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:16:38.879379 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:38.894212 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:16:38.896661 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:16:38.899447 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:38.972162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:16:38.974598 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:16:38.976728 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:16:38.980957 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:16:39.000179 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:16:39.014389 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:16:39.017046 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:16:39.025540 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:16:39.034070 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:16:39.041647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c70d34760>]}
[0m06:16:39.045037 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7775[0m in 0.50s]
[0m06:16:39.049930 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:16:39.053306 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:16:39.056291 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:16:39.060048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:16:39.063681 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:16:39.075736 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.095848 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:16:39.108373 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.125340 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.128493 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:16:39.130969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:16:39.139886 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:16:39.143756 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.146906 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:16:39.198343 [debug] [Thread-1  ]: SQL status: SELECT 7775 in 0.048 seconds
[0m06:16:39.210203 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.212623 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:16:39.215607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:39.225280 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.227472 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:16:39.230138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:39.235222 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:16:39.237190 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.239111 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:16:39.244249 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:16:39.252940 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:16:39.256106 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:16:39.258425 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:16:39.265232 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:16:39.270283 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:16:39.273256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c73acbe20>]}
[0m06:16:39.276279 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7775[0m in 0.21s]
[0m06:16:39.280162 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:16:39.283401 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:16:39.287070 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:16:39.290995 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:16:39.294622 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:16:39.307385 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.326381 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:16:39.429696 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.445105 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.447328 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:16:39.449694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:16:39.458597 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:16:39.461711 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.464067 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:16:39.518776 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.053 seconds
[0m06:16:39.528631 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.530654 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:16:39.533478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:39.542556 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.545113 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:16:39.547861 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:39.552747 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:16:39.554704 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.556646 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:16:39.562190 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:16:39.578219 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:16:39.583054 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:16:39.587555 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:16:39.597282 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:16:39.604026 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:16:39.607580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c73acbe20>]}
[0m06:16:39.610856 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.32s]
[0m06:16:39.614752 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:16:39.617472 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:16:39.620085 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:16:39.623213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:16:39.626236 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:16:39.639628 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.652711 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:16:39.665541 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.677905 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.680128 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:16:39.682300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:16:39.691428 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:16:39.694379 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.696702 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:16:39.751975 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.052 seconds
[0m06:16:39.767186 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.770187 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:16:39.773745 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:39.786296 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.789119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:16:39.792472 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:39.799166 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:16:39.801974 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.804918 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:16:39.809965 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:16:39.820453 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:16:39.824491 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:16:39.827289 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:16:39.833388 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:16:39.839597 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:16:39.843474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c73acbe20>]}
[0m06:16:39.848940 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.22s]
[0m06:16:39.858105 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:16:39.862175 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:16:39.865654 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:16:39.869175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:16:39.872109 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:16:39.884400 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:16:39.898734 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:16:39.913792 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:16:39.929395 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:16:39.932595 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:16:39.935700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:16:39.947286 [debug] [Thread-1  ]: SQL status: BEGIN in 0.012 seconds
[0m06:16:39.950978 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:16:39.954521 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:16:40.013404 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.056 seconds
[0m06:16:40.023719 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:16:40.026200 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:16:40.029375 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:40.040105 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:16:40.042920 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:16:40.046364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:40.052466 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:16:40.055243 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:16:40.058009 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:16:40.064334 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:16:40.077635 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:16:40.081458 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:16:40.084019 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:16:40.089994 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:16:40.095489 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:16:40.099001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c73acbe20>]}
[0m06:16:40.102679 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.23s]
[0m06:16:40.107414 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:16:40.110576 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:16:40.115842 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:16:40.119840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:16:40.122694 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:16:40.134176 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.150899 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:16:40.165838 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.181629 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.183627 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:16:40.185518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:16:40.193682 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:16:40.196516 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.199068 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:16:40.218752 [debug] [Thread-1  ]: SQL status: SELECT 2417 in 0.017 seconds
[0m06:16:40.230104 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.232972 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:16:40.236330 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:40.247506 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.250198 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:16:40.253419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:16:40.260180 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:16:40.263597 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.266115 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:16:40.270987 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:16:40.281570 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:16:40.286528 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:16:40.289308 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:16:40.296304 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:16:40.302288 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:16:40.305534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661c3ec1-6a2b-403d-9ae3-33a41ef85a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c70c53220>]}
[0m06:16:40.308640 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2417[0m in 0.19s]
[0m06:16:40.312412 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:16:40.317934 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:40.320394 [debug] [MainThread]: On master: BEGIN
[0m06:16:40.322531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:16:40.329487 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:16:40.332277 [debug] [MainThread]: On master: COMMIT
[0m06:16:40.334657 [debug] [MainThread]: Using postgres connection "master"
[0m06:16:40.336561 [debug] [MainThread]: On master: COMMIT
[0m06:16:40.338559 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:16:40.340265 [debug] [MainThread]: On master: Close
[0m06:16:40.342332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:16:40.343937 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:16:40.345956 [info ] [MainThread]: 
[0m06:16:40.349284 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m06:16:40.364887 [debug] [MainThread]: Command end result
[0m06:16:40.463608 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:16:40.476940 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:16:40.505044 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:16:40.507542 [info ] [MainThread]: 
[0m06:16:40.510400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:16:40.513848 [info ] [MainThread]: 
[0m06:16:40.517194 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:16:40.523191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.921195, "process_in_blocks": "84160", "process_kernel_time": 1.123359, "process_mem_max_rss": "108108", "process_out_blocks": "0", "process_user_time": 10.426817}
[0m06:16:40.526527 [debug] [MainThread]: Command `dbt run` succeeded at 06:16:40.525978 after 5.93 seconds
[0m06:16:40.529102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c73910130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c749fa220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7187fd60>]}
[0m06:16:40.531588 [debug] [MainThread]: Flushing usage events
[0m06:16:41.241877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:29:47.463568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3e11a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3d259640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3d2595e0>]}


============================== 06:29:47.475650 | b3eeb8b7-2538-4a3d-be51-1ed6d3796c46 ==============================
[0m06:29:47.475650 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:29:47.478957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:47.988013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3f0b69d0>]}
[0m06:29:48.158579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3c9f1f70>]}
[0m06:29:48.161695 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:29:48.354907 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:29:48.911276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:48.912671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:49.010050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3c05bf40>]}
[0m06:29:49.273484 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:29:49.290282 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:29:49.347790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3c05bf70>]}
[0m06:29:49.349899 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:29:49.357912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3e64d460>]}
[0m06:29:49.368011 [info ] [MainThread]: 
[0m06:29:49.372402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:29:49.374919 [info ] [MainThread]: 
[0m06:29:49.377883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:29:49.391232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:29:49.494135 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:29:49.495439 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:29:49.496934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:49.519647 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m06:29:49.522306 [debug] [ThreadPool]: On list_airflow: Close
[0m06:29:49.526020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:29:49.539524 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:29:49.541334 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:29:49.542910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:49.548346 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:29:49.550359 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:29:49.554819 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:29:49.564977 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m06:29:49.568946 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:29:49.571210 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:29:49.587800 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:49.589398 [debug] [MainThread]: On master: BEGIN
[0m06:29:49.590817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:49.596070 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:29:49.597660 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:49.599078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:29:49.607344 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m06:29:49.610871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3c065d60>]}
[0m06:29:49.612599 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:49.615043 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:49.616412 [debug] [MainThread]: On master: BEGIN
[0m06:29:49.620129 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:29:49.621691 [debug] [MainThread]: On master: COMMIT
[0m06:29:49.623213 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:49.624599 [debug] [MainThread]: On master: COMMIT
[0m06:29:49.626016 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:49.627584 [debug] [MainThread]: On master: Close
[0m06:29:49.636902 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:29:49.638827 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:29:49.640877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:29:49.642526 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:29:49.662355 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:29:49.671408 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:29:49.770927 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:29:49.779107 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:49.780524 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:29:49.782011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:49.788502 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:29:49.791088 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:49.792333 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:29:49.801434 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 18:         CAST(date AS DATE) AS date_day,
                      ^

[0m06:29:49.805488 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: ROLLBACK
[0m06:29:49.807465 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:29:49.816389 [debug] [Thread-1  ]: Database Error in model avg_hum (models/avg_hum.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_hum.sql
[0m06:29:49.821387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3e2d2580>]}
[0m06:29:49.823220 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model pro_raw_api.avg_hum ...................... [[31mERROR[0m in 0.18s]
[0m06:29:49.825490 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:29:49.826739 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:29:49.827669 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.avg_hum' to be skipped because of status 'error'.  Reason: Database Error in model avg_hum (models/avg_hum.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_hum.sql.
[0m06:29:49.829098 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:29:49.831815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:29:49.832967 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:29:49.840808 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:29:49.847823 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:29:49.859961 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:29:49.877320 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:49.878916 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:29:49.880656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:49.887515 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:29:49.889995 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:49.892166 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:29:49.897225 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 18:         CAST(date AS DATE) AS date_day,
                      ^

[0m06:29:49.899291 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: ROLLBACK
[0m06:29:49.902170 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:29:49.905917 [debug] [Thread-1  ]: Database Error in model avg_temp (models/avg_temp.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_temp.sql
[0m06:29:49.907585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3e2d2580>]}
[0m06:29:49.909241 [error] [Thread-1  ]: 2 of 6 ERROR creating sql table model pro_raw_api.avg_temp ..................... [[31mERROR[0m in 0.08s]
[0m06:29:49.911894 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:29:49.913795 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:49.914954 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.avg_temp' to be skipped because of status 'error'.  Reason: Database Error in model avg_temp (models/avg_temp.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_temp.sql.
[0m06:29:49.916740 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:29:49.921479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:29:49.923361 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:49.931900 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:49.941623 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:49.952127 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:49.961485 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:49.963104 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:29:49.964639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:49.971675 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:29:49.975636 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:49.977473 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m06:29:49.979975 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                           ^

[0m06:29:49.987218 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m06:29:49.989792 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:29:49.992746 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m06:29:49.994903 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3b56cee0>]}
[0m06:29:49.996828 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.07s]
[0m06:29:49.999837 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:50.003046 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:29:50.004353 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m06:29:50.005804 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:29:50.009023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:29:50.010613 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:29:50.019481 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.028045 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:29:50.038346 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.046918 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.048455 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:29:50.050152 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:50.056636 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:29:50.058356 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.060057 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:29:50.121756 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.060 seconds
[0m06:29:50.140278 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.142240 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:29:50.145213 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:50.153836 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.155642 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:29:50.157922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:50.208610 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:29:50.210913 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.213366 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:29:50.218431 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:29:50.295668 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:29:50.307164 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:50.308650 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:29:50.314888 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m06:29:50.321742 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:29:50.324250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3e2d2580>]}
[0m06:29:50.326535 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.32s]
[0m06:29:50.329028 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:29:50.330707 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:29:50.332379 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:29:50.337271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:29:50.339011 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:29:50.346151 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.355325 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:29:50.370605 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.379033 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.380623 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:29:50.381907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:50.388865 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:29:50.391192 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.392909 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:29:50.435908 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.041 seconds
[0m06:29:50.445532 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.447229 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:29:50.449759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:50.457477 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.458880 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:29:50.460492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:50.463403 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:29:50.464782 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.466199 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:29:50.470111 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:29:50.477359 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:29:50.480627 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:50.482185 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:29:50.488018 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:29:50.491071 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:29:50.492888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3c065fd0>]}
[0m06:29:50.495025 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.16s]
[0m06:29:50.497180 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:29:50.498853 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:29:50.502776 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:29:50.505230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:29:50.507232 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:29:50.514335 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.525384 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:29:50.540560 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.547866 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.549352 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:29:50.551365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:50.556837 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:29:50.558565 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.559958 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:29:50.571720 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.011 seconds
[0m06:29:50.578194 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.579618 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:29:50.581943 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:50.589332 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.590582 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:29:50.592040 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:50.594971 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:29:50.596161 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.597029 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:29:50.599129 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:29:50.606570 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:29:50.608291 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:50.609616 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:29:50.614745 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:29:50.618618 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:29:50.620247 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3eeb8b7-2538-4a3d-be51-1ed6d3796c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3c065fd0>]}
[0m06:29:50.621653 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.12s]
[0m06:29:50.623888 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:29:50.626372 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:50.627436 [debug] [MainThread]: On master: BEGIN
[0m06:29:50.628366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:50.632661 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:29:50.636673 [debug] [MainThread]: On master: COMMIT
[0m06:29:50.637837 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:50.638753 [debug] [MainThread]: On master: COMMIT
[0m06:29:50.640060 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:50.641230 [debug] [MainThread]: On master: Close
[0m06:29:50.642674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:50.643788 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:29:50.644853 [info ] [MainThread]: 
[0m06:29:50.646180 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m06:29:50.651650 [debug] [MainThread]: Command end result
[0m06:29:50.694007 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:29:50.698474 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:29:50.716638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:29:50.718407 [info ] [MainThread]: 
[0m06:29:50.720438 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m06:29:50.722421 [info ] [MainThread]: 
[0m06:29:50.724356 [error] [MainThread]:   Database Error in model avg_hum (models/avg_hum.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_hum.sql
[0m06:29:50.726094 [info ] [MainThread]: 
[0m06:29:50.727931 [error] [MainThread]:   Database Error in model avg_temp (models/avg_temp.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_temp.sql
[0m06:29:50.729718 [info ] [MainThread]: 
[0m06:29:50.732140 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m06:29:50.737338 [info ] [MainThread]: 
[0m06:29:50.739108 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m06:29:50.742072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4897757, "process_in_blocks": "84824", "process_kernel_time": 0.740751, "process_mem_max_rss": "109192", "process_out_blocks": "0", "process_user_time": 5.854979}
[0m06:29:50.744007 [debug] [MainThread]: Command `dbt run` failed at 06:29:50.743590 after 3.49 seconds
[0m06:29:50.745572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3e11a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3e64d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3b51e1c0>]}
[0m06:29:50.746948 [debug] [MainThread]: Flushing usage events
[0m06:29:51.555639 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:25:14.354702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1aec640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1adda29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1adda2a30>]}


============================== 07:25:14.361384 | 8cc039c3-e14d-4a97-976a-cb7f844d376b ==============================
[0m07:25:14.361384 [info ] [MainThread]: Running with dbt=1.9.3
[0m07:25:14.363359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:25:14.634317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1afc019d0>]}
[0m07:25:14.735823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ad572f70>]}
[0m07:25:14.738491 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:25:14.849462 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m07:25:15.126424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:25:15.128107 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/avg_hum.sql
[0m07:25:15.500521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ac59d130>]}
[0m07:25:15.618744 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:25:15.625612 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:25:15.651179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ac5b7a90>]}
[0m07:25:15.652618 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m07:25:15.654093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1afc01ee0>]}
[0m07:25:15.657550 [info ] [MainThread]: 
[0m07:25:15.659285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:25:15.660914 [info ] [MainThread]: 
[0m07:25:15.662801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:25:15.670772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:25:15.752710 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:25:15.753884 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:25:15.754874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:15.780436 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m07:25:15.782750 [debug] [ThreadPool]: On list_airflow: Close
[0m07:25:15.785283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m07:25:15.793964 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m07:25:15.795124 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m07:25:15.796024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:15.799573 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m07:25:15.800833 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m07:25:15.801726 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m07:25:15.804841 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m07:25:15.806990 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m07:25:15.808003 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m07:25:15.815842 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:15.819130 [debug] [MainThread]: On master: BEGIN
[0m07:25:15.822201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:25:15.828643 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:25:15.831183 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:15.833318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:25:15.838680 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:25:15.841631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ac5f3580>]}
[0m07:25:15.843115 [debug] [MainThread]: On master: ROLLBACK
[0m07:25:15.844203 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:15.845022 [debug] [MainThread]: On master: BEGIN
[0m07:25:15.846107 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:25:15.847264 [debug] [MainThread]: On master: COMMIT
[0m07:25:15.848496 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:15.849793 [debug] [MainThread]: On master: COMMIT
[0m07:25:15.851097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:25:15.852256 [debug] [MainThread]: On master: Close
[0m07:25:15.908321 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m07:25:15.909854 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m07:25:15.911463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m07:25:15.912674 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m07:25:15.925604 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m07:25:15.932332 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m07:25:15.981196 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m07:25:15.987315 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:25:15.988213 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m07:25:15.989271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:15.993199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m07:25:15.994576 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:25:15.995481 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_date AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m07:25:15.996938 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "local_date" does not exist
LINE 18:         CAST(local_date AS DATE) AS date_day,
                      ^
HINT:  Perhaps you meant to reference the column "daily_weather.local_time".

[0m07:25:15.998467 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: ROLLBACK
[0m07:25:15.999686 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m07:25:16.011035 [debug] [Thread-1  ]: Database Error in model avg_hum (models/avg_hum.sql)
  column "local_date" does not exist
  LINE 18:         CAST(local_date AS DATE) AS date_day,
                        ^
  HINT:  Perhaps you meant to reference the column "daily_weather.local_time".
  compiled code at target/run/mi_proyecto_dbt/models/avg_hum.sql
[0m07:25:16.013590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1add8fa00>]}
[0m07:25:16.014752 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model pro_raw_api.avg_hum ...................... [[31mERROR[0m in 0.10s]
[0m07:25:16.016207 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m07:25:16.017239 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m07:25:16.017840 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.avg_hum' to be skipped because of status 'error'.  Reason: Database Error in model avg_hum (models/avg_hum.sql)
  column "local_date" does not exist
  LINE 18:         CAST(local_date AS DATE) AS date_day,
                        ^
  HINT:  Perhaps you meant to reference the column "daily_weather.local_time".
  compiled code at target/run/mi_proyecto_dbt/models/avg_hum.sql.
[0m07:25:16.018658 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m07:25:16.020846 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m07:25:16.021820 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m07:25:16.026694 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m07:25:16.031622 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m07:25:16.037078 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m07:25:16.043957 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:25:16.044990 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m07:25:16.045878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:16.049353 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:25:16.050699 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:25:16.051688 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(date AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m07:25:16.053109 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 18:         CAST(date AS DATE) AS date_day,
                      ^

[0m07:25:16.054535 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: ROLLBACK
[0m07:25:16.055922 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m07:25:16.058178 [debug] [Thread-1  ]: Database Error in model avg_temp (models/avg_temp.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_temp.sql
[0m07:25:16.059341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1aee1c580>]}
[0m07:25:16.060502 [error] [Thread-1  ]: 2 of 6 ERROR creating sql table model pro_raw_api.avg_temp ..................... [[31mERROR[0m in 0.04s]
[0m07:25:16.062014 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m07:25:16.063012 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m07:25:16.063595 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.avg_temp' to be skipped because of status 'error'.  Reason: Database Error in model avg_temp (models/avg_temp.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_temp.sql.
[0m07:25:16.064449 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m07:25:16.066410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m07:25:16.067336 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m07:25:16.073260 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m07:25:16.078138 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m07:25:16.083307 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m07:25:16.088087 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:25:16.089224 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m07:25:16.090241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:16.093763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:25:16.095205 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:25:16.096108 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m07:25:16.097420 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                           ^

[0m07:25:16.098809 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m07:25:16.100298 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m07:25:16.101885 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m07:25:16.103042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ad5b8fd0>]}
[0m07:25:16.104176 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.04s]
[0m07:25:16.105782 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m07:25:16.106849 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m07:25:16.107444 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m07:25:16.108330 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m07:25:16.110272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m07:25:16.111200 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m07:25:16.115733 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.120477 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m07:25:16.125848 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.131019 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.131975 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m07:25:16.132824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:16.136171 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:25:16.137558 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.138567 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m07:25:16.167528 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.028 seconds
[0m07:25:16.176585 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.178043 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m07:25:16.180718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:25:16.185182 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.186173 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m07:25:16.187588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:25:16.212562 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m07:25:16.213872 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.215066 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m07:25:16.217717 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m07:25:16.227133 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m07:25:16.233265 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:25:16.234564 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m07:25:16.237548 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m07:25:16.241562 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m07:25:16.243137 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1afd98730>]}
[0m07:25:16.244317 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.13s]
[0m07:25:16.245861 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m07:25:16.246905 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m07:25:16.248058 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m07:25:16.249372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m07:25:16.250313 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m07:25:16.255037 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.260388 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m07:25:16.265730 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.270654 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.271600 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m07:25:16.272569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:16.276072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:25:16.277436 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.278327 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m07:25:16.296876 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.018 seconds
[0m07:25:16.301513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.302502 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m07:25:16.303663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:25:16.308007 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.309092 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m07:25:16.310381 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:25:16.312837 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m07:25:16.313971 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.314839 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m07:25:16.316716 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m07:25:16.320291 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m07:25:16.321475 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:25:16.322360 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m07:25:16.325037 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m07:25:16.327100 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m07:25:16.328217 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1acc71d60>]}
[0m07:25:16.329741 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.08s]
[0m07:25:16.331722 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m07:25:16.332859 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m07:25:16.333847 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m07:25:16.335124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m07:25:16.336102 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m07:25:16.340792 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.345861 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m07:25:16.352782 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.358641 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.359690 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m07:25:16.360555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:16.364064 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:25:16.365286 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.366221 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m07:25:16.374889 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.008 seconds
[0m07:25:16.379412 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.380265 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m07:25:16.381303 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:25:16.385372 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.386243 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m07:25:16.387227 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:25:16.389488 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m07:25:16.390445 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.391193 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m07:25:16.393636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:25:16.397195 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m07:25:16.398328 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:25:16.399109 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m07:25:16.402681 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m07:25:16.404638 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m07:25:16.405942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc039c3-e14d-4a97-976a-cb7f844d376b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1abc9ed30>]}
[0m07:25:16.407360 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.07s]
[0m07:25:16.408890 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m07:25:16.411105 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:16.411983 [debug] [MainThread]: On master: BEGIN
[0m07:25:16.412685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:25:16.415965 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:25:16.417143 [debug] [MainThread]: On master: COMMIT
[0m07:25:16.417954 [debug] [MainThread]: Using postgres connection "master"
[0m07:25:16.418696 [debug] [MainThread]: On master: COMMIT
[0m07:25:16.419703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:25:16.420478 [debug] [MainThread]: On master: Close
[0m07:25:16.421433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:16.422382 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m07:25:16.423452 [info ] [MainThread]: 
[0m07:25:16.424539 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m07:25:16.427347 [debug] [MainThread]: Command end result
[0m07:25:16.463256 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:25:16.467483 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:25:16.479982 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m07:25:16.481052 [info ] [MainThread]: 
[0m07:25:16.482294 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m07:25:16.483864 [info ] [MainThread]: 
[0m07:25:16.485232 [error] [MainThread]:   Database Error in model avg_hum (models/avg_hum.sql)
  column "local_date" does not exist
  LINE 18:         CAST(local_date AS DATE) AS date_day,
                        ^
  HINT:  Perhaps you meant to reference the column "daily_weather.local_time".
  compiled code at target/run/mi_proyecto_dbt/models/avg_hum.sql
[0m07:25:16.486677 [info ] [MainThread]: 
[0m07:25:16.488296 [error] [MainThread]:   Database Error in model avg_temp (models/avg_temp.sql)
  column "date" does not exist
  LINE 18:         CAST(date AS DATE) AS date_day,
                        ^
  compiled code at target/run/mi_proyecto_dbt/models/avg_temp.sql
[0m07:25:16.490135 [info ] [MainThread]: 
[0m07:25:16.491532 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m07:25:16.492964 [info ] [MainThread]: 
[0m07:25:16.494188 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=3 SKIP=0 TOTAL=6
[0m07:25:16.496924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2473114, "process_in_blocks": "480", "process_kernel_time": 0.977954, "process_mem_max_rss": "113988", "process_out_blocks": "0", "process_user_time": 3.690015}
[0m07:25:16.497920 [debug] [MainThread]: Command `dbt run` failed at 07:25:16.497788 after 2.25 seconds
[0m07:25:16.498758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1aec640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ac5d88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ac5d8ac0>]}
[0m07:25:16.499608 [debug] [MainThread]: Flushing usage events
[0m07:25:17.617327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:26:50.896666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b146f9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b13838580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b13838520>]}


============================== 07:26:50.900764 | d097238a-0a9e-42c5-8884-07bad62a8ad7 ==============================
[0m07:26:50.900764 [info ] [MainThread]: Running with dbt=1.9.3
[0m07:26:50.902386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:26:51.137965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b12ff0f40>]}
[0m07:26:51.217129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b12f80220>]}
[0m07:26:51.219260 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:26:51.354076 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m07:26:51.637292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:26:51.639414 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/avg_temp.sql
[0m07:26:51.641830 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/avg_hum.sql
[0m07:26:52.056972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1225b130>]}
[0m07:26:52.181638 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:26:52.187313 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:26:52.209563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b122780d0>]}
[0m07:26:52.211301 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m07:26:52.213824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b122a1a30>]}
[0m07:26:52.217274 [info ] [MainThread]: 
[0m07:26:52.219200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:26:52.221015 [info ] [MainThread]: 
[0m07:26:52.225208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:26:52.235107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:26:52.292335 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:26:52.293501 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:26:52.294330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:52.298988 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m07:26:52.301108 [debug] [ThreadPool]: On list_airflow: Close
[0m07:26:52.304205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m07:26:52.313109 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m07:26:52.314677 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m07:26:52.316143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:52.319424 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m07:26:52.321153 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m07:26:52.322352 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m07:26:52.326347 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m07:26:52.328679 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m07:26:52.329774 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m07:26:52.338090 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:52.339624 [debug] [MainThread]: On master: BEGIN
[0m07:26:52.341136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:26:52.345134 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:26:52.346557 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:52.347610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:26:52.350945 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m07:26:52.352944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b15723220>]}
[0m07:26:52.353985 [debug] [MainThread]: On master: ROLLBACK
[0m07:26:52.355106 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:52.356559 [debug] [MainThread]: On master: BEGIN
[0m07:26:52.358704 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:26:52.360131 [debug] [MainThread]: On master: COMMIT
[0m07:26:52.361208 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:52.362288 [debug] [MainThread]: On master: COMMIT
[0m07:26:52.363350 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:26:52.364232 [debug] [MainThread]: On master: Close
[0m07:26:52.418843 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m07:26:52.420317 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m07:26:52.422483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m07:26:52.424230 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m07:26:52.437425 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m07:26:52.444573 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m07:26:52.496072 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m07:26:52.502118 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:26:52.503158 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m07:26:52.504090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:52.507897 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m07:26:52.509478 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:26:52.510493 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m07:26:52.536193 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.025 seconds
[0m07:26:52.545758 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:26:52.547081 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m07:26:52.548400 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:52.571555 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m07:26:52.573347 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:26:52.575024 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m07:26:52.578984 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:26:52.587203 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m07:26:52.596363 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:26:52.597691 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m07:26:52.600201 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m07:26:52.603977 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m07:26:52.608035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1582d6d0>]}
[0m07:26:52.609843 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7795[0m in 0.18s]
[0m07:26:52.611806 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m07:26:52.612967 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m07:26:52.614110 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m07:26:52.615656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m07:26:52.616719 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m07:26:52.621466 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.627073 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m07:26:52.632678 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.638097 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.639730 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m07:26:52.641162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:52.645548 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m07:26:52.647188 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.648333 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m07:26:52.667180 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.018 seconds
[0m07:26:52.672294 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.673726 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m07:26:52.675155 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:52.679672 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.680957 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m07:26:52.682405 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:52.687135 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m07:26:52.688442 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.689836 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m07:26:52.693136 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:26:52.697294 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m07:26:52.698691 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:26:52.699790 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m07:26:52.703447 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m07:26:52.705898 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m07:26:52.707323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b148cbdc0>]}
[0m07:26:52.708695 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7795[0m in 0.09s]
[0m07:26:52.710286 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m07:26:52.711428 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m07:26:52.712629 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m07:26:52.714356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m07:26:52.715589 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m07:26:52.720569 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m07:26:52.727132 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m07:26:52.734097 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m07:26:52.740070 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:26:52.741338 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m07:26:52.742359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:52.745830 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:26:52.747293 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:26:52.748307 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(date AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(date AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m07:26:52.749825 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date" does not exist
LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                           ^

[0m07:26:52.751695 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m07:26:52.754453 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m07:26:52.758369 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m07:26:52.759656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b169b9a30>]}
[0m07:26:52.761006 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.05s]
[0m07:26:52.763316 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m07:26:52.766201 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m07:26:52.767243 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m07:26:52.768410 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m07:26:52.770724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m07:26:52.771802 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m07:26:52.776951 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.782446 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m07:26:52.787957 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.794187 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.795187 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m07:26:52.796045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:52.799355 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:26:52.800801 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.801808 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m07:26:52.822297 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.020 seconds
[0m07:26:52.827789 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.828879 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m07:26:52.830045 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:52.834528 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.835556 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m07:26:52.836819 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:52.840066 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m07:26:52.841444 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.842584 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m07:26:52.844405 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m07:26:52.848365 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m07:26:52.849787 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:26:52.850671 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m07:26:52.853683 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m07:26:52.856577 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m07:26:52.858039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b116bbc70>]}
[0m07:26:52.859533 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.09s]
[0m07:26:52.861156 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m07:26:52.862295 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m07:26:52.863430 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m07:26:52.864982 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m07:26:52.866202 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m07:26:52.870898 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.876748 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m07:26:52.883807 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.889853 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.890910 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m07:26:52.891769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:52.895415 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m07:26:52.896723 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.897775 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m07:26:52.917311 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.019 seconds
[0m07:26:52.923342 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.924437 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m07:26:52.925600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:52.929930 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.931158 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m07:26:52.932458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:52.935007 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m07:26:52.936021 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.936902 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m07:26:52.939286 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m07:26:52.943804 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m07:26:52.945206 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:26:52.946139 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m07:26:52.948687 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m07:26:52.950977 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m07:26:52.952353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b116bbc70>]}
[0m07:26:52.953727 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.09s]
[0m07:26:52.955654 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m07:26:52.957715 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m07:26:52.959165 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m07:26:52.960818 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m07:26:52.962211 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m07:26:52.967178 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m07:26:52.973240 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m07:26:52.979082 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m07:26:52.984841 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:26:52.985828 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m07:26:52.986688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:52.991262 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m07:26:52.993157 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:26:52.994337 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m07:26:53.003147 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.008 seconds
[0m07:26:53.009092 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:26:53.010561 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m07:26:53.012141 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:53.019054 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:26:53.020248 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m07:26:53.021988 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:26:53.025694 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m07:26:53.027047 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:26:53.028213 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m07:26:53.030939 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:26:53.035483 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m07:26:53.037289 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:26:53.038597 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m07:26:53.043676 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m07:26:53.046357 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m07:26:53.047882 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd097238a-0a9e-42c5-8884-07bad62a8ad7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b156ddc10>]}
[0m07:26:53.049416 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.09s]
[0m07:26:53.051569 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m07:26:53.054178 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:53.055384 [debug] [MainThread]: On master: BEGIN
[0m07:26:53.057149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:26:53.061611 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:26:53.063146 [debug] [MainThread]: On master: COMMIT
[0m07:26:53.064314 [debug] [MainThread]: Using postgres connection "master"
[0m07:26:53.065370 [debug] [MainThread]: On master: COMMIT
[0m07:26:53.066484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:26:53.067448 [debug] [MainThread]: On master: Close
[0m07:26:53.068593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:53.069544 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m07:26:53.070652 [info ] [MainThread]: 
[0m07:26:53.072891 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m07:26:53.076767 [debug] [MainThread]: Command end result
[0m07:26:53.117179 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:26:53.123292 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:26:53.136430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m07:26:53.137433 [info ] [MainThread]: 
[0m07:26:53.139484 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:26:53.141352 [info ] [MainThread]: 
[0m07:26:53.143599 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column "date" does not exist
  LINE 17:     WHERE EXTRACT(MONTH FROM CAST(date AS timestamp)) IN (6,...
                                             ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m07:26:53.145285 [info ] [MainThread]: 
[0m07:26:53.147074 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m07:26:53.149663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3454916, "process_in_blocks": "0", "process_kernel_time": 0.322151, "process_mem_max_rss": "114920", "process_out_blocks": "0", "process_user_time": 4.369173}
[0m07:26:53.151167 [debug] [MainThread]: Command `dbt run` failed at 07:26:53.150981 after 2.35 seconds
[0m07:26:53.152186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b146f9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1450bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b12fb9e50>]}
[0m07:26:53.153202 [debug] [MainThread]: Flushing usage events
[0m07:26:53.972407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:55:18.190532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad9c9b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad8dde5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad8dde580>]}


============================== 07:55:18.201760 | bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b ==============================
[0m07:55:18.201760 [info ] [MainThread]: Running with dbt=1.9.3
[0m07:55:18.205171 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:55:18.654906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2adad850a0>]}
[0m07:55:18.800284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad9439c70>]}
[0m07:55:18.803075 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m07:55:18.982864 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m07:55:19.465285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:55:19.467739 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m07:55:19.960154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad759e130>]}
[0m07:55:20.140225 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:55:20.152010 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:55:20.186034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad75b7100>]}
[0m07:55:20.188251 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m07:55:20.190923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad857a490>]}
[0m07:55:20.196257 [info ] [MainThread]: 
[0m07:55:20.199635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:55:20.203396 [info ] [MainThread]: 
[0m07:55:20.206958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:55:20.219582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:55:20.312696 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:55:20.315781 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:55:20.317879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:55:20.326368 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m07:55:20.329853 [debug] [ThreadPool]: On list_airflow: Close
[0m07:55:20.334444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m07:55:20.348397 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m07:55:20.350376 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m07:55:20.351997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:55:20.358260 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:55:20.360654 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m07:55:20.362806 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m07:55:20.368474 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m07:55:20.372649 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m07:55:20.374408 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m07:55:20.389679 [debug] [MainThread]: Using postgres connection "master"
[0m07:55:20.391376 [debug] [MainThread]: On master: BEGIN
[0m07:55:20.392881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:55:20.400009 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:55:20.402431 [debug] [MainThread]: Using postgres connection "master"
[0m07:55:20.405068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:55:20.412561 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:55:20.417079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2adacc50d0>]}
[0m07:55:20.419901 [debug] [MainThread]: On master: ROLLBACK
[0m07:55:20.422256 [debug] [MainThread]: Using postgres connection "master"
[0m07:55:20.423966 [debug] [MainThread]: On master: BEGIN
[0m07:55:20.426841 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:55:20.430537 [debug] [MainThread]: On master: COMMIT
[0m07:55:20.432513 [debug] [MainThread]: Using postgres connection "master"
[0m07:55:20.434416 [debug] [MainThread]: On master: COMMIT
[0m07:55:20.437284 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:55:20.439101 [debug] [MainThread]: On master: Close
[0m07:55:20.507678 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m07:55:20.509972 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m07:55:20.512826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m07:55:20.515486 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m07:55:20.534040 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.548039 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m07:55:20.634035 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.645825 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.647863 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m07:55:20.649632 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:55:20.655478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m07:55:20.657893 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.659908 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m07:55:20.695558 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.034 seconds
[0m07:55:20.716040 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.718182 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m07:55:20.720276 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:20.729008 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.731327 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m07:55:20.734233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:20.784721 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m07:55:20.787371 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.789472 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m07:55:20.794181 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:55:20.816303 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m07:55:20.825564 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m07:55:20.828510 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m07:55:20.834378 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m07:55:20.840169 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m07:55:20.845706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2adadcf430>]}
[0m07:55:20.848499 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7795[0m in 0.33s]
[0m07:55:20.852118 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m07:55:20.854333 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m07:55:20.856509 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m07:55:20.859100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m07:55:20.861700 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m07:55:20.870495 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m07:55:20.882572 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m07:55:20.892768 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m07:55:20.908139 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:55:20.909956 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m07:55:20.911873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:55:20.917610 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m07:55:20.920442 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:55:20.922505 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m07:55:20.954090 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.030 seconds
[0m07:55:20.962491 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:55:20.964903 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m07:55:20.968138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:20.975514 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:55:20.978122 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m07:55:20.981054 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:55:20.984856 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m07:55:20.986962 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:55:20.989135 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m07:55:20.993521 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:55:21.001535 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m07:55:21.004258 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m07:55:21.006303 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m07:55:21.011657 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m07:55:21.015983 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m07:55:21.018480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2adbf21d00>]}
[0m07:55:21.020874 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7795[0m in 0.16s]
[0m07:55:21.024106 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m07:55:21.026825 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m07:55:21.029571 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m07:55:21.032192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m07:55:21.034849 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m07:55:21.043270 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m07:55:21.052751 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m07:55:21.063745 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m07:55:21.076423 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:55:21.078196 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m07:55:21.079792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:55:21.085515 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m07:55:21.087918 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:55:21.089885 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(local_time AS TIMESTAMP)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(local_time AS TIMESTAMP))
)

SELECT 
    b.city,
    CAST(b.local_time AS DATE) AS date,
    b.temperature,
    m.year,
    m.max_temp
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.local_time AS TIMESTAMP)) = m.year
    AND b.temperature = m.max_temp
ORDER BY b.city, m.year
  );
  
[0m07:55:21.116319 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.025 seconds
[0m07:55:21.123945 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:55:21.125801 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m07:55:21.128384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:21.132995 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m07:55:21.135087 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:55:21.137039 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m07:55:21.140878 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:55:21.148275 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m07:55:21.151303 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m07:55:21.153370 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m07:55:21.155792 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m07:55:21.159873 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m07:55:21.162511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2adbf4d4c0>]}
[0m07:55:21.165063 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.13s]
[0m07:55:21.167755 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m07:55:21.170694 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m07:55:21.172910 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m07:55:21.175414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m07:55:21.177263 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m07:55:21.185530 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.197960 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m07:55:21.206123 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.222073 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.224092 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m07:55:21.225960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:55:21.234014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m07:55:21.236331 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.238287 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m07:55:21.269797 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.030 seconds
[0m07:55:21.277690 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.279725 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m07:55:21.282171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:21.289319 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.291291 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m07:55:21.293728 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:21.300042 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m07:55:21.301952 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.303928 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m07:55:21.309236 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m07:55:21.317475 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m07:55:21.320639 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m07:55:21.323278 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m07:55:21.329719 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m07:55:21.335021 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m07:55:21.338599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad9eeabe0>]}
[0m07:55:21.341954 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.16s]
[0m07:55:21.346196 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m07:55:21.348457 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m07:55:21.351224 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m07:55:21.354599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m07:55:21.356971 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m07:55:21.367782 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.382551 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m07:55:21.393950 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.408030 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.409953 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m07:55:21.412084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:55:21.418886 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m07:55:21.421616 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.424311 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m07:55:21.472278 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.046 seconds
[0m07:55:21.483028 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.485486 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m07:55:21.488546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:21.502569 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.505396 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m07:55:21.508828 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:55:21.514966 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m07:55:21.517469 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.519964 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m07:55:21.524116 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m07:55:21.533412 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m07:55:21.536190 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m07:55:21.538081 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m07:55:21.542376 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m07:55:21.547582 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m07:55:21.550049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad79cf3d0>]}
[0m07:55:21.552582 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.20s]
[0m07:55:21.556373 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m07:55:21.558881 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m07:55:21.561875 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m07:55:21.564526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m07:55:21.566356 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m07:55:21.575913 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.587909 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m07:55:21.603710 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.615966 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.618057 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m07:55:21.620257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:55:21.627429 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m07:55:21.630026 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.632030 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m07:55:21.652752 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.019 seconds
[0m07:55:21.663152 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.665716 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m07:55:21.668151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:55:21.675952 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.677972 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m07:55:21.680308 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:55:21.684634 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m07:55:21.686460 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.688100 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m07:55:21.690836 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m07:55:21.698595 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m07:55:21.701104 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m07:55:21.703124 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m07:55:21.707389 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m07:55:21.711224 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m07:55:21.713928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd56d2c1-afb7-46a3-a9fa-4ebec017bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad7c64850>]}
[0m07:55:21.716529 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.15s]
[0m07:55:21.720477 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m07:55:21.724644 [debug] [MainThread]: Using postgres connection "master"
[0m07:55:21.726500 [debug] [MainThread]: On master: BEGIN
[0m07:55:21.728266 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:55:21.734637 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:55:21.737101 [debug] [MainThread]: On master: COMMIT
[0m07:55:21.739370 [debug] [MainThread]: Using postgres connection "master"
[0m07:55:21.741450 [debug] [MainThread]: On master: COMMIT
[0m07:55:21.743931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:55:21.746724 [debug] [MainThread]: On master: Close
[0m07:55:21.748803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:55:21.750369 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m07:55:21.752141 [info ] [MainThread]: 
[0m07:55:21.755089 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m07:55:21.761318 [debug] [MainThread]: Command end result
[0m07:55:21.830384 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m07:55:21.838999 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m07:55:21.859258 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m07:55:21.861788 [info ] [MainThread]: 
[0m07:55:21.864801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:55:21.867322 [info ] [MainThread]: 
[0m07:55:21.870646 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m07:55:21.874358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8896286, "process_in_blocks": "0", "process_kernel_time": 0.370532, "process_mem_max_rss": "115952", "process_out_blocks": "0", "process_user_time": 6.258999}
[0m07:55:21.876949 [debug] [MainThread]: Command `dbt run` succeeded at 07:55:21.876477 after 3.89 seconds
[0m07:55:21.880114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad9c9b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2adc71afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada170880>]}
[0m07:55:21.882146 [debug] [MainThread]: Flushing usage events
[0m07:55:23.010803 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:03:45.938787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cf5610a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ce69fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ce69fac0>]}


============================== 08:03:45.947048 | 9a2f8a43-1674-4f41-9db3-17c079545513 ==============================
[0m08:03:45.947048 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:03:45.951148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:03:46.416265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ce67c8e0>]}
[0m08:03:46.588006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ce0a11c0>]}
[0m08:03:46.591837 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:03:46.871223 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m08:03:47.305829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:03:47.308457 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m08:03:47.811386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cd0dd130>]}
[0m08:03:47.985683 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:03:47.997743 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:03:48.033038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cd50e730>]}
[0m08:03:48.035872 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m08:03:48.038650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cdd4cb50>]}
[0m08:03:48.043822 [info ] [MainThread]: 
[0m08:03:48.046443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:03:48.049748 [info ] [MainThread]: 
[0m08:03:48.052992 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:03:48.064323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:03:48.149457 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:03:48.152608 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:03:48.154945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:48.164842 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m08:03:48.169182 [debug] [ThreadPool]: On list_airflow: Close
[0m08:03:48.174561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m08:03:48.189325 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m08:03:48.191219 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m08:03:48.192945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:48.198538 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:03:48.201133 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m08:03:48.203499 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m08:03:48.209637 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m08:03:48.213085 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m08:03:48.214965 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m08:03:48.226499 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:48.228384 [debug] [MainThread]: On master: BEGIN
[0m08:03:48.230062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:03:48.236466 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:03:48.239477 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:48.242175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:03:48.248973 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:03:48.308408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cf2c6190>]}
[0m08:03:48.310436 [debug] [MainThread]: On master: ROLLBACK
[0m08:03:48.312344 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:48.314435 [debug] [MainThread]: On master: BEGIN
[0m08:03:48.316656 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:03:48.319176 [debug] [MainThread]: On master: COMMIT
[0m08:03:48.321046 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:48.322618 [debug] [MainThread]: On master: COMMIT
[0m08:03:48.324206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:48.325428 [debug] [MainThread]: On master: Close
[0m08:03:48.330138 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m08:03:48.332035 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m08:03:48.334938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m08:03:48.336591 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m08:03:48.356586 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.368907 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m08:03:48.450563 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.469468 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.471760 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m08:03:48.473991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:48.480318 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:03:48.483109 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.485575 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m08:03:48.525077 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.037 seconds
[0m08:03:48.538163 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.540813 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m08:03:48.543711 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:48.550404 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.552345 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m08:03:48.554628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:48.599865 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m08:03:48.602397 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.605773 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m08:03:48.613970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m08:03:48.629798 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m08:03:48.639401 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:03:48.641162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m08:03:48.645939 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:03:48.651907 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m08:03:48.656290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d0695130>]}
[0m08:03:48.658565 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7795[0m in 0.32s]
[0m08:03:48.662024 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m08:03:48.664422 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m08:03:48.667192 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m08:03:48.670284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m08:03:48.672432 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m08:03:48.680371 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.695493 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m08:03:48.712007 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.726349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.728264 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m08:03:48.730176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:48.736451 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:03:48.738963 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.740831 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m08:03:48.768115 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.026 seconds
[0m08:03:48.775032 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.777048 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m08:03:48.780017 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:48.789344 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.791655 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m08:03:48.794318 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:48.798917 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m08:03:48.801436 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.803524 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m08:03:48.810298 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m08:03:48.817936 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m08:03:48.820857 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:03:48.823006 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m08:03:48.827788 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:03:48.831293 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m08:03:48.833649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d0695130>]}
[0m08:03:48.836145 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7795[0m in 0.16s]
[0m08:03:48.838977 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m08:03:48.841655 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m08:03:48.844325 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m08:03:48.846764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m08:03:48.848644 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m08:03:48.857183 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m08:03:48.866048 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m08:03:48.876958 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m08:03:48.887778 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:03:48.889602 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m08:03:48.891600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:48.898338 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m08:03:48.901465 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:03:48.904140 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(local_time AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(local_time AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m08:03:48.907725 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column b.date does not exist
LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                        ^

[0m08:03:48.911293 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m08:03:48.920640 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m08:03:48.926860 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column b.date does not exist
  LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                          ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m08:03:48.929586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d0695130>]}
[0m08:03:48.931942 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.08s]
[0m08:03:48.934768 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m08:03:48.936992 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m08:03:48.938184 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column b.date does not exist
  LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                          ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m08:03:48.940068 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m08:03:48.943859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m08:03:48.945894 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m08:03:48.954058 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m08:03:48.965450 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m08:03:48.973783 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m08:03:48.987515 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:03:48.989034 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m08:03:48.990397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:48.995759 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m08:03:48.998532 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:03:49.001022 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m08:03:49.065869 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.057 seconds
[0m08:03:49.078116 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:03:49.080499 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m08:03:49.083095 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.094157 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:03:49.096011 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m08:03:49.098121 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.102540 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m08:03:49.104440 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:03:49.106507 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m08:03:49.110582 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m08:03:49.122328 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m08:03:49.128596 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:03:49.131193 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m08:03:49.136059 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:03:49.139731 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m08:03:49.141670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cc5cd880>]}
[0m08:03:49.143821 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.20s]
[0m08:03:49.146239 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m08:03:49.147938 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m08:03:49.149706 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m08:03:49.151927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m08:03:49.153920 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m08:03:49.161715 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.169879 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m08:03:49.180679 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.189639 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.191480 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m08:03:49.193205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:49.198882 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:03:49.201972 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.204001 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m08:03:49.241436 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.036 seconds
[0m08:03:49.247802 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.249687 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m08:03:49.251923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:49.258464 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.260117 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m08:03:49.262165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.266183 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m08:03:49.267836 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.269513 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m08:03:49.274114 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m08:03:49.280237 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m08:03:49.282931 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:03:49.284633 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m08:03:49.288962 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:03:49.292617 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m08:03:49.294964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cc5cd880>]}
[0m08:03:49.297144 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.14s]
[0m08:03:49.300026 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m08:03:49.301987 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m08:03:49.304264 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m08:03:49.306819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m08:03:49.308632 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m08:03:49.318589 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.329501 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m08:03:49.338271 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.348204 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.350029 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m08:03:49.351553 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:03:49.357305 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:03:49.359693 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.361635 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m08:03:49.376767 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.013 seconds
[0m08:03:49.387175 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.389352 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m08:03:49.391912 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.399808 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.402002 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m08:03:49.404518 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:49.408816 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m08:03:49.410780 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.412755 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m08:03:49.417507 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m08:03:49.425549 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m08:03:49.428497 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:03:49.430770 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m08:03:49.436080 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:03:49.440596 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m08:03:49.443184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a2f8a43-1674-4f41-9db3-17c079545513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cd4e4ac0>]}
[0m08:03:49.445954 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.14s]
[0m08:03:49.449399 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m08:03:49.454604 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.456476 [debug] [MainThread]: On master: BEGIN
[0m08:03:49.458338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:03:49.465019 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m08:03:49.467510 [debug] [MainThread]: On master: COMMIT
[0m08:03:49.469400 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:49.470885 [debug] [MainThread]: On master: COMMIT
[0m08:03:49.472530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:49.473952 [debug] [MainThread]: On master: Close
[0m08:03:49.475557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:49.476944 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m08:03:49.478425 [info ] [MainThread]: 
[0m08:03:49.480168 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m08:03:49.485244 [debug] [MainThread]: Command end result
[0m08:03:49.564046 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:03:49.574226 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:03:49.595054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:03:49.596879 [info ] [MainThread]: 
[0m08:03:49.599354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:03:49.601878 [info ] [MainThread]: 
[0m08:03:49.605084 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column b.date does not exist
  LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                          ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m08:03:49.608095 [info ] [MainThread]: 
[0m08:03:49.611226 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:03:49.615382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.879913, "process_in_blocks": "0", "process_kernel_time": 0.496266, "process_mem_max_rss": "114196", "process_out_blocks": "0", "process_user_time": 5.884304}
[0m08:03:49.617864 [debug] [MainThread]: Command `dbt run` failed at 08:03:49.617624 after 3.88 seconds
[0m08:03:49.620122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15cf5610a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ce67c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d089fa00>]}
[0m08:03:49.622186 [debug] [MainThread]: Flushing usage events
[0m08:03:51.028675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:04:17.555796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914e0f8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914d237a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914d237af0>]}


============================== 08:04:17.562682 | c3b8c39e-6006-4b08-b684-f76651e55db9 ==============================
[0m08:04:17.562682 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:04:17.565569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:04:17.992241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914c9f1f40>]}
[0m08:04:18.186426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914c980220>]}
[0m08:04:18.189634 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:04:18.367431 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m08:04:18.854955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:04:18.857020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:04:18.927010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914c05aee0>]}
[0m08:04:19.101023 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:04:19.112606 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:04:19.144079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914c09b550>]}
[0m08:04:19.146667 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m08:04:19.149247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914e349b80>]}
[0m08:04:19.155698 [info ] [MainThread]: 
[0m08:04:19.158635 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:19.160967 [info ] [MainThread]: 
[0m08:04:19.164164 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:04:19.177605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:04:19.248606 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:04:19.250456 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:04:19.252453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:19.263195 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m08:04:19.268007 [debug] [ThreadPool]: On list_airflow: Close
[0m08:04:19.274337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m08:04:19.294237 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m08:04:19.296227 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m08:04:19.299458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:19.308984 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m08:04:19.312014 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m08:04:19.314537 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m08:04:19.322847 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m08:04:19.327739 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m08:04:19.329811 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m08:04:19.346709 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:19.348944 [debug] [MainThread]: On master: BEGIN
[0m08:04:19.351168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:04:19.358918 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m08:04:19.363663 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:19.366385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:04:19.374493 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:04:19.377933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914c07b730>]}
[0m08:04:19.379880 [debug] [MainThread]: On master: ROLLBACK
[0m08:04:19.382063 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:19.383937 [debug] [MainThread]: On master: BEGIN
[0m08:04:19.399312 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:04:19.403324 [debug] [MainThread]: On master: COMMIT
[0m08:04:19.407496 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:19.409823 [debug] [MainThread]: On master: COMMIT
[0m08:04:19.414636 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:04:19.418085 [debug] [MainThread]: On master: Close
[0m08:04:19.429338 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m08:04:19.432500 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m08:04:19.438599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m08:04:19.440826 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m08:04:19.473338 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.486609 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m08:04:19.588244 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.598182 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.600370 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m08:04:19.602002 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:19.607885 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:04:19.610112 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.611912 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m08:04:19.648288 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.035 seconds
[0m08:04:19.666133 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.669419 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m08:04:19.672853 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:19.680675 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.682729 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m08:04:19.686119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:19.732699 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m08:04:19.734542 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.736230 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m08:04:19.739364 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m08:04:19.752727 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m08:04:19.762565 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:04:19.764476 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m08:04:19.768949 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:04:19.775123 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m08:04:19.779550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914f22d6d0>]}
[0m08:04:19.782026 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7795[0m in 0.34s]
[0m08:04:19.785222 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m08:04:19.788431 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m08:04:19.790742 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m08:04:19.793289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m08:04:19.796210 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m08:04:19.804936 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.815564 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m08:04:19.826241 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.835064 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.836682 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m08:04:19.838088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:19.843594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m08:04:19.845911 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.847635 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m08:04:19.876229 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.027 seconds
[0m08:04:19.888830 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.891499 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m08:04:19.894759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:19.905313 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.907512 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m08:04:19.910097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:19.914341 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m08:04:19.916213 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.918360 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m08:04:19.922546 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m08:04:19.927572 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m08:04:19.929679 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:04:19.932035 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m08:04:19.937180 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:04:19.941209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m08:04:19.943335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914e2cbdc0>]}
[0m08:04:19.945406 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7795[0m in 0.15s]
[0m08:04:19.948343 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m08:04:19.950911 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m08:04:19.952854 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m08:04:19.955566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m08:04:19.957314 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m08:04:19.967669 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m08:04:19.977347 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m08:04:20.040713 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m08:04:20.050649 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:04:20.052285 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m08:04:20.053816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:20.059134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m08:04:20.061703 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:04:20.063540 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS timestamp)) IN (6, 7, 8)
),
max_temp AS (
    SELECT 
        city,
        EXTRACT(YEAR FROM CAST(local_time AS timestamp)) AS year,
        MAX(temperature) AS max_temp
    FROM base
    GROUP BY city, EXTRACT(YEAR FROM CAST(local_time AS timestamp))
)

SELECT b.*
FROM base b
JOIN max_temp m 
    ON b.city = m.city 
    AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.year
    AND b.temperature = m.max_temp
  );
  
[0m08:04:20.066737 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column b.date does not exist
LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                        ^

[0m08:04:20.069119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: ROLLBACK
[0m08:04:20.071688 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m08:04:20.076772 [debug] [Thread-1  ]: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column b.date does not exist
  LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                          ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m08:04:20.079282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914e2cbdc0>]}
[0m08:04:20.081621 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model pro_raw_api.max_temp_summer .............. [[31mERROR[0m in 0.12s]
[0m08:04:20.084392 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m08:04:20.086427 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m08:04:20.087616 [debug] [Thread-4  ]: Marking all children of 'model.mi_proyecto_dbt.max_temp_summer' to be skipped because of status 'error'.  Reason: Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column b.date does not exist
  LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                          ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql.
[0m08:04:20.089465 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m08:04:20.093857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m08:04:20.096265 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m08:04:20.105784 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.117367 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m08:04:20.127303 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.144910 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.147150 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m08:04:20.149282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:20.155180 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:04:20.157793 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.159829 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m08:04:20.190251 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.029 seconds
[0m08:04:20.197165 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.199358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m08:04:20.202248 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:20.211063 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.213296 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m08:04:20.215825 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:20.221235 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m08:04:20.223318 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.225163 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m08:04:20.231110 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m08:04:20.238411 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m08:04:20.241310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:04:20.243210 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m08:04:20.248267 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:04:20.252174 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m08:04:20.254610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914b1eab50>]}
[0m08:04:20.257115 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.16s]
[0m08:04:20.259989 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m08:04:20.262341 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m08:04:20.264525 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m08:04:20.267754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m08:04:20.270497 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m08:04:20.280878 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.290897 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m08:04:20.298913 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.312409 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.314005 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m08:04:20.315412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:20.322212 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:04:20.325065 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.326889 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m08:04:20.356514 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.028 seconds
[0m08:04:20.365265 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.367308 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m08:04:20.370143 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:20.376953 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.378679 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m08:04:20.380968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:04:20.385193 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m08:04:20.387181 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.388943 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m08:04:20.393104 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m08:04:20.399146 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m08:04:20.401667 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:04:20.403465 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m08:04:20.407823 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m08:04:20.411570 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m08:04:20.413854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914b1eab50>]}
[0m08:04:20.416637 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.15s]
[0m08:04:20.419468 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m08:04:20.422098 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m08:04:20.425859 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m08:04:20.428854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m08:04:20.431075 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m08:04:20.440919 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.455663 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m08:04:20.463252 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.476888 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.478834 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m08:04:20.480436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:04:20.486147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:04:20.488957 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.491034 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m08:04:20.506289 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.013 seconds
[0m08:04:20.514434 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.516612 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m08:04:20.519193 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:20.526476 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.528581 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m08:04:20.532118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:04:20.538153 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m08:04:20.540543 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.542503 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m08:04:20.546261 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m08:04:20.554269 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m08:04:20.557445 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:04:20.559653 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m08:04:20.564627 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:04:20.568539 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m08:04:20.571297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3b8c39e-6006-4b08-b684-f76651e55db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914b1eab50>]}
[0m08:04:20.574002 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.14s]
[0m08:04:20.577727 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m08:04:20.583072 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:20.585389 [debug] [MainThread]: On master: BEGIN
[0m08:04:20.587225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:04:20.592884 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:04:20.595266 [debug] [MainThread]: On master: COMMIT
[0m08:04:20.597146 [debug] [MainThread]: Using postgres connection "master"
[0m08:04:20.598810 [debug] [MainThread]: On master: COMMIT
[0m08:04:20.600743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:04:20.602550 [debug] [MainThread]: On master: Close
[0m08:04:20.604600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:20.606203 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m08:04:20.607895 [info ] [MainThread]: 
[0m08:04:20.610079 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m08:04:20.615197 [debug] [MainThread]: Command end result
[0m08:04:20.697001 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:04:20.708618 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:04:20.729216 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:04:20.731379 [info ] [MainThread]: 
[0m08:04:20.733983 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:04:20.736313 [info ] [MainThread]: 
[0m08:04:20.739287 [error] [MainThread]:   Database Error in model max_temp_summer (models/max_temp_summer.sql)
  column b.date does not exist
  LINE 32:     AND EXTRACT(YEAR FROM CAST(b.date AS timestamp)) = m.yea...
                                          ^
  compiled code at target/run/mi_proyecto_dbt/models/max_temp_summer.sql
[0m08:04:20.742676 [info ] [MainThread]: 
[0m08:04:20.745820 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:04:20.751566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3695729, "process_in_blocks": "0", "process_kernel_time": 0.421679, "process_mem_max_rss": "108816", "process_out_blocks": "0", "process_user_time": 5.752912}
[0m08:04:20.754567 [debug] [MainThread]: Command `dbt run` failed at 08:04:20.754289 after 3.37 seconds
[0m08:04:20.756383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914e0f8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914c09b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914c5e7610>]}
[0m08:04:20.758241 [debug] [MainThread]: Flushing usage events
[0m08:04:21.842472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:05:45.986602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f037066c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036f7aaa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036f7aaac0>]}


============================== 08:05:45.994808 | 8769a5fd-c944-4432-89b0-e95a6f14f37e ==============================
[0m08:05:45.994808 [info ] [MainThread]: Running with dbt=1.9.3
[0m08:05:45.997438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:05:46.468552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036f7878e0>]}
[0m08:05:46.622495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036ef201c0>]}
[0m08:05:46.626142 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:05:46.836390 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m08:05:47.205241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:05:47.208397 [debug] [MainThread]: Partial parsing: updated file: mi_proyecto_dbt://models/max_temp_summer.sql
[0m08:05:47.682577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036df5e130>]}
[0m08:05:47.871349 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:05:47.883630 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:05:47.916167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e38f730>]}
[0m08:05:47.918260 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m08:05:47.921160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036eb0fb50>]}
[0m08:05:47.927626 [info ] [MainThread]: 
[0m08:05:47.931720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:05:47.934990 [info ] [MainThread]: 
[0m08:05:47.938736 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:05:47.952311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:05:48.015152 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:05:48.017207 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:05:48.019379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:48.027472 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m08:05:48.031013 [debug] [ThreadPool]: On list_airflow: Close
[0m08:05:48.036405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m08:05:48.050619 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m08:05:48.052544 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m08:05:48.054669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:48.062020 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m08:05:48.064533 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m08:05:48.066702 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m08:05:48.072567 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m08:05:48.076173 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m08:05:48.078221 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m08:05:48.090484 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:48.092511 [debug] [MainThread]: On master: BEGIN
[0m08:05:48.094255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:05:48.100498 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m08:05:48.102839 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:48.104860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:05:48.111597 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m08:05:48.115022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036dfb9430>]}
[0m08:05:48.116954 [debug] [MainThread]: On master: ROLLBACK
[0m08:05:48.118990 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:48.121036 [debug] [MainThread]: On master: BEGIN
[0m08:05:48.123368 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m08:05:48.125825 [debug] [MainThread]: On master: COMMIT
[0m08:05:48.127891 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:48.129644 [debug] [MainThread]: On master: COMMIT
[0m08:05:48.131414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:05:48.133028 [debug] [MainThread]: On master: Close
[0m08:05:48.196214 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m08:05:48.198546 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m08:05:48.200985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m08:05:48.203286 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m08:05:48.222638 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.234640 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m08:05:48.313893 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.330569 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.332584 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m08:05:48.334448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:48.340415 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:05:48.343009 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.345187 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m08:05:48.384887 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.038 seconds
[0m08:05:48.403803 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.405972 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m08:05:48.408430 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:48.415038 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.416794 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m08:05:48.419096 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:48.452964 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m08:05:48.455157 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.457062 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m08:05:48.463757 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m08:05:48.479117 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m08:05:48.487594 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m08:05:48.489771 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m08:05:48.494985 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:05:48.500794 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m08:05:48.505404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03717a0130>]}
[0m08:05:48.508037 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7795[0m in 0.30s]
[0m08:05:48.511494 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m08:05:48.514428 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m08:05:48.517460 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m08:05:48.520106 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m08:05:48.522710 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m08:05:48.532133 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.545957 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m08:05:48.554214 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.568513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.570140 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m08:05:48.571583 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:48.577735 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:05:48.580547 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.582906 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m08:05:48.612470 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.028 seconds
[0m08:05:48.620056 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.622199 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m08:05:48.624436 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:48.630962 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.632737 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m08:05:48.634971 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:05:48.639190 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m08:05:48.641080 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.642914 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m08:05:48.647636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m08:05:48.654232 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m08:05:48.656693 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m08:05:48.658496 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m08:05:48.663455 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:05:48.667403 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m08:05:48.669642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0372934250>]}
[0m08:05:48.672129 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7795[0m in 0.15s]
[0m08:05:48.674846 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m08:05:48.676869 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m08:05:48.678936 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m08:05:48.681652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m08:05:48.683642 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m08:05:48.693271 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m08:05:48.703237 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m08:05:48.714401 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m08:05:48.727890 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:05:48.729606 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m08:05:48.731317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:48.737849 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m08:05:48.740383 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:05:48.742572 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m08:05:48.772562 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.028 seconds
[0m08:05:48.779076 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:05:48.781183 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m08:05:48.783811 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:48.788268 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m08:05:48.790549 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:05:48.792904 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m08:05:48.797179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m08:05:48.806446 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m08:05:48.810735 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m08:05:48.813866 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m08:05:48.817059 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m08:05:48.823728 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m08:05:48.827984 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03728f2e50>]}
[0m08:05:48.831414 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.15s]
[0m08:05:48.834882 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m08:05:48.837379 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m08:05:48.839619 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m08:05:48.842328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m08:05:48.845100 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m08:05:48.854332 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.868122 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m08:05:48.878393 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.894740 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.896801 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m08:05:48.899404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:48.907192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m08:05:48.909734 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.911662 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m08:05:48.940869 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.028 seconds
[0m08:05:48.947994 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.949892 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m08:05:48.952122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:05:48.959521 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.961521 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m08:05:48.963943 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:05:48.970404 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m08:05:48.972406 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.974407 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m08:05:48.978093 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m08:05:48.984858 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m08:05:48.987398 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m08:05:48.989333 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m08:05:48.993796 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m08:05:48.997289 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m08:05:48.999650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03708bbca0>]}
[0m08:05:49.003151 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.16s]
[0m08:05:49.006284 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m08:05:49.009505 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m08:05:49.012847 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m08:05:49.015644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m08:05:49.018562 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m08:05:49.028907 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.044759 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m08:05:49.052247 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.064827 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.066415 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m08:05:49.068066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:49.073440 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m08:05:49.075519 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.077387 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m08:05:49.106763 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.028 seconds
[0m08:05:49.115148 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.117940 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m08:05:49.120963 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:49.129369 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.131495 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m08:05:49.133860 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:49.138461 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m08:05:49.140511 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.142380 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m08:05:49.147906 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m08:05:49.154577 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m08:05:49.157150 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m08:05:49.159049 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m08:05:49.163408 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m08:05:49.166964 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m08:05:49.169252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03708bbca0>]}
[0m08:05:49.172502 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.15s]
[0m08:05:49.175934 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m08:05:49.178993 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m08:05:49.181430 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m08:05:49.184307 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m08:05:49.187380 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m08:05:49.195305 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.206545 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m08:05:49.216076 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.230386 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.232186 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m08:05:49.233980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:49.240866 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m08:05:49.243551 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.245922 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m08:05:49.261612 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.014 seconds
[0m08:05:49.270606 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.272299 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m08:05:49.274538 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:49.283281 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.285693 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m08:05:49.288694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:05:49.292825 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m08:05:49.294961 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.296897 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m08:05:49.301514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m08:05:49.309564 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m08:05:49.313363 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m08:05:49.316175 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m08:05:49.322342 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m08:05:49.326414 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m08:05:49.329203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8769a5fd-c944-4432-89b0-e95a6f14f37e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03708bbca0>]}
[0m08:05:49.332580 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.15s]
[0m08:05:49.337170 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m08:05:49.343417 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:49.345703 [debug] [MainThread]: On master: BEGIN
[0m08:05:49.347630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:05:49.356363 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m08:05:49.358959 [debug] [MainThread]: On master: COMMIT
[0m08:05:49.361266 [debug] [MainThread]: Using postgres connection "master"
[0m08:05:49.363637 [debug] [MainThread]: On master: COMMIT
[0m08:05:49.366153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:05:49.368003 [debug] [MainThread]: On master: Close
[0m08:05:49.370210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:49.372124 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m08:05:49.374193 [info ] [MainThread]: 
[0m08:05:49.376378 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m08:05:49.382014 [debug] [MainThread]: Command end result
[0m08:05:49.459773 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m08:05:49.470077 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m08:05:49.491158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m08:05:49.493212 [info ] [MainThread]: 
[0m08:05:49.495797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:05:49.498416 [info ] [MainThread]: 
[0m08:05:49.502224 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:05:49.506417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7427785, "process_in_blocks": "0", "process_kernel_time": 0.502272, "process_mem_max_rss": "114592", "process_out_blocks": "0", "process_user_time": 6.224233}
[0m08:05:49.508727 [debug] [MainThread]: Command `dbt run` succeeded at 08:05:49.508484 after 3.75 seconds
[0m08:05:49.511809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f037066c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e3430d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036ef201c0>]}
[0m08:05:49.514008 [debug] [MainThread]: Flushing usage events
[0m08:05:50.927084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:30:04.418017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8348070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f7486a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f7486af0>]}


============================== 06:30:04.431559 | d45881b2-0e80-40a4-bf4e-df8b0198529f ==============================
[0m06:30:04.431559 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:30:04.435969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:30:05.167722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f6eb0f40>]}
[0m06:30:05.366699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f6bc0220>]}
[0m06:30:05.370223 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:30:05.735608 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:30:07.444697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:30:07.446838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:30:07.697871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f629bee0>]}
[0m06:30:08.205930 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:30:08.245762 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:30:08.438931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f62db550>]}
[0m06:30:08.441620 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:30:08.446707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8598b80>]}
[0m06:30:08.454571 [info ] [MainThread]: 
[0m06:30:08.457096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:30:08.459911 [info ] [MainThread]: 
[0m06:30:08.465777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:30:08.484242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:30:08.706946 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:30:08.709387 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:30:08.712100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:08.786977 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.075 seconds
[0m06:30:08.791972 [debug] [ThreadPool]: On list_airflow: Close
[0m06:30:08.799673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:30:08.831502 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:30:08.837256 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:30:08.855782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:08.865259 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m06:30:08.873827 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:30:08.876085 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:30:08.938085 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.059 seconds
[0m06:30:08.945427 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:30:08.950009 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:30:08.988057 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:08.998374 [debug] [MainThread]: On master: BEGIN
[0m06:30:09.000393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:30:09.007757 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:30:09.013355 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:09.015946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:30:09.093256 [debug] [MainThread]: SQL status: SELECT 0 in 0.058 seconds
[0m06:30:09.100192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f62bc730>]}
[0m06:30:09.104141 [debug] [MainThread]: On master: ROLLBACK
[0m06:30:09.107049 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:09.109029 [debug] [MainThread]: On master: BEGIN
[0m06:30:09.113268 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:30:09.115948 [debug] [MainThread]: On master: COMMIT
[0m06:30:09.118101 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:09.120362 [debug] [MainThread]: On master: COMMIT
[0m06:30:09.123026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:30:09.125050 [debug] [MainThread]: On master: Close
[0m06:30:09.136780 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:30:09.139298 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:30:09.144049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:30:09.147468 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:30:09.182728 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:30:09.196400 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:30:09.448082 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:30:09.491817 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:30:09.510416 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:30:09.513517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:09.532101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m06:30:09.534675 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:30:09.536964 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:30:10.332134 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.785 seconds
[0m06:30:10.351714 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:30:10.353913 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:30:10.371723 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.016 seconds
[0m06:30:10.383110 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:30:10.386049 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:30:10.388862 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:10.448139 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:30:10.450368 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:30:10.452559 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:30:10.561846 [debug] [Thread-1  ]: SQL status: COMMIT in 0.108 seconds
[0m06:30:10.594266 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:30:10.618721 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:30:10.621477 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:30:10.635383 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.011 seconds
[0m06:30:10.646683 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:30:10.666263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f57756a0>]}
[0m06:30:10.670177 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7795[0m in 1.51s]
[0m06:30:10.677180 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:30:10.683023 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:30:10.687011 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:30:10.694208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:30:10.710530 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:30:10.742463 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:30:10.758189 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:30:10.780237 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:30:10.790072 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:30:10.791780 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:30:10.793790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:10.801322 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:30:10.803558 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:30:10.805719 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:30:10.871179 [debug] [Thread-1  ]: SQL status: SELECT 7795 in 0.063 seconds
[0m06:30:10.879108 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:30:10.881147 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:30:10.884145 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:10.895399 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:30:10.897609 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:30:10.900257 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:10.906129 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:30:10.908377 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:30:10.910603 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:30:11.033079 [debug] [Thread-1  ]: SQL status: COMMIT in 0.120 seconds
[0m06:30:11.043888 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:30:11.048006 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:30:11.050380 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:30:11.073811 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.021 seconds
[0m06:30:11.079052 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:30:11.083943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f851adc0>]}
[0m06:30:11.090453 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7795[0m in 0.39s]
[0m06:30:11.097344 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:30:11.100084 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:30:11.102826 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:30:11.105567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:30:11.107550 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:30:11.121681 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.132427 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:30:11.223553 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.265072 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.266942 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:30:11.269109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:11.276709 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:30:11.279153 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.281682 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m06:30:11.409883 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.126 seconds
[0m06:30:11.419168 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.421058 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:30:11.423857 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:11.438599 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.444509 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:30:11.448007 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:11.455729 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:30:11.459500 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.462728 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:30:11.469262 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:30:11.482088 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:30:11.501660 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:30:11.503964 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:30:11.508621 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:30:11.514030 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:30:11.517056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f851adc0>]}
[0m06:30:11.520025 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.41s]
[0m06:30:11.523068 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:30:11.525223 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:30:11.527613 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:30:11.530385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:30:11.532055 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:30:11.541785 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.579364 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:30:11.601161 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.611721 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.613865 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:30:11.616227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:11.625485 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:30:11.627970 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.630127 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:30:11.735912 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.104 seconds
[0m06:30:11.748987 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.751287 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:30:11.754672 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:11.772120 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.777697 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:30:11.783048 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:11.790101 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:30:11.792816 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.796063 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:30:11.800143 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:30:11.806825 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:30:11.809520 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:30:11.811416 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:30:11.815543 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:30:11.819097 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:30:11.821310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f851adc0>]}
[0m06:30:11.823891 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.29s]
[0m06:30:11.827048 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:30:11.828751 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:30:11.830794 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:30:11.833328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:30:11.835123 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:30:11.842774 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.850859 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:30:11.864474 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.874728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.876779 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:30:11.878264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:11.885524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:30:11.887838 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.889880 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:30:11.924091 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.032 seconds
[0m06:30:11.932038 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.933760 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:30:11.936188 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:11.945386 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.947538 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:30:11.950307 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:11.956262 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:30:11.957895 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.959508 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:30:11.962399 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:30:11.974347 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:30:11.977409 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:30:11.979065 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:30:11.983735 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:30:11.988796 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:30:11.991607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f851adc0>]}
[0m06:30:11.994655 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.16s]
[0m06:30:11.997834 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:30:12.000243 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:30:12.002680 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:30:12.005749 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:30:12.008167 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:30:12.019258 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.029103 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:30:12.042465 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.054513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.057535 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:30:12.060087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:12.066718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:30:12.069126 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.071307 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:30:12.118047 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.045 seconds
[0m06:30:12.126591 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.128306 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:30:12.130389 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:12.140130 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.142268 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:30:12.144919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:30:12.148860 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:30:12.150829 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.153132 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:30:12.210704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.056 seconds
[0m06:30:12.219909 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:30:12.224727 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:30:12.226836 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:30:12.233586 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m06:30:12.238610 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:30:12.241608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd45881b2-0e80-40a4-bf4e-df8b0198529f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f578ecd0>]}
[0m06:30:12.244888 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.24s]
[0m06:30:12.249531 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:30:12.253508 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:12.255380 [debug] [MainThread]: On master: BEGIN
[0m06:30:12.257342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:30:12.264146 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:30:12.267456 [debug] [MainThread]: On master: COMMIT
[0m06:30:12.269077 [debug] [MainThread]: Using postgres connection "master"
[0m06:30:12.270511 [debug] [MainThread]: On master: COMMIT
[0m06:30:12.272226 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:30:12.273605 [debug] [MainThread]: On master: Close
[0m06:30:12.275141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:30:12.276955 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:30:12.278746 [info ] [MainThread]: 
[0m06:30:12.280558 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m06:30:12.285234 [debug] [MainThread]: Command end result
[0m06:30:12.351260 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:30:12.358479 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:30:12.411616 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:30:12.413567 [info ] [MainThread]: 
[0m06:30:12.431905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:30:12.436697 [info ] [MainThread]: 
[0m06:30:12.440855 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:30:12.455442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.570782, "process_in_blocks": "84160", "process_kernel_time": 1.172457, "process_mem_max_rss": "110300", "process_out_blocks": "0", "process_user_time": 9.061703}
[0m06:30:12.457345 [debug] [MainThread]: Command `dbt run` succeeded at 06:30:12.457077 after 8.57 seconds
[0m06:30:12.459427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8348070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8864ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f886c3d0>]}
[0m06:30:12.461480 [debug] [MainThread]: Flushing usage events
[0m06:30:14.750678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:38.710924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2cefe100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2c03ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2c03ca90>]}


============================== 11:44:38.742892 | ac63e000-b270-490a-9e33-4af2760c54a5 ==============================
[0m11:44:38.742892 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:44:38.747522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:39.745864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2dfe80a0>]}
[0m11:44:39.967160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2c69cc70>]}
[0m11:44:39.980805 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:44:40.301044 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:44:41.202018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:41.204989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:41.382387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2ae5bf70>]}
[0m11:44:41.767095 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:44:41.792380 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:44:41.863277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2ae5b790>]}
[0m11:44:41.868381 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m11:44:41.878922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2d0fca60>]}
[0m11:44:41.886725 [info ] [MainThread]: 
[0m11:44:41.890303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:41.893433 [info ] [MainThread]: 
[0m11:44:41.896392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:44:41.910683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:44:42.015028 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:44:42.016852 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:44:42.018213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:42.049842 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m11:44:42.053745 [debug] [ThreadPool]: On list_airflow: Close
[0m11:44:42.059682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m11:44:42.078153 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:44:42.080141 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m11:44:42.081726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:42.088990 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:44:42.091458 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m11:44:42.093519 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m11:44:42.105896 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m11:44:42.111209 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m11:44:42.113701 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m11:44:42.140236 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:42.142630 [debug] [MainThread]: On master: BEGIN
[0m11:44:42.144783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:42.153680 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:44:42.158096 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:42.160730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:44:42.179092 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m11:44:42.183356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2ae7c610>]}
[0m11:44:42.185948 [debug] [MainThread]: On master: ROLLBACK
[0m11:44:42.188356 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:42.190778 [debug] [MainThread]: On master: BEGIN
[0m11:44:42.197060 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:44:42.200628 [debug] [MainThread]: On master: COMMIT
[0m11:44:42.202432 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:42.205013 [debug] [MainThread]: On master: COMMIT
[0m11:44:42.207586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:44:42.209436 [debug] [MainThread]: On master: Close
[0m11:44:42.225312 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m11:44:42.228127 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m11:44:42.231196 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m11:44:42.233423 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m11:44:42.278801 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.296074 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m11:44:42.429277 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.442716 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.444970 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m11:44:42.446924 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:42.454136 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:44:42.457087 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.459233 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m11:44:42.595944 [debug] [Thread-1  ]: SQL status: SELECT 7800 in 0.135 seconds
[0m11:44:42.615696 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.617916 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m11:44:42.622580 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:44:42.635979 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.645039 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m11:44:42.648252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:42.710038 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m11:44:42.712152 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.714063 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m11:44:42.719839 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m11:44:42.741775 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m11:44:42.754888 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m11:44:42.756912 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m11:44:42.768546 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.010 seconds
[0m11:44:42.776351 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m11:44:42.781849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2a337730>]}
[0m11:44:42.784918 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7800[0m in 0.55s]
[0m11:44:42.789959 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m11:44:42.792492 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m11:44:42.795259 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m11:44:42.797720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m11:44:42.800093 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m11:44:42.812015 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m11:44:42.825599 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m11:44:42.835919 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m11:44:42.852983 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:44:42.857014 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m11:44:42.859875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:42.869872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m11:44:42.876511 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:44:42.881157 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m11:44:42.960036 [debug] [Thread-1  ]: SQL status: SELECT 7800 in 0.076 seconds
[0m11:44:42.973924 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:44:42.975917 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m11:44:42.978388 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:42.987259 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:44:42.989627 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m11:44:42.992115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:42.997870 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m11:44:43.000094 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:44:43.002510 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m11:44:43.008141 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m11:44:43.015167 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m11:44:43.018467 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m11:44:43.021399 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m11:44:43.027347 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:44:43.031042 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m11:44:43.033488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2d0b6eb0>]}
[0m11:44:43.036238 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7800[0m in 0.24s]
[0m11:44:43.040996 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m11:44:43.043102 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m11:44:43.045729 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m11:44:43.048929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m11:44:43.051124 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m11:44:43.065861 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.087172 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m11:44:43.197091 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.210025 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.212324 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m11:44:43.214307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:43.221996 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:44:43.224817 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.227280 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m11:44:43.273065 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.043 seconds
[0m11:44:43.281660 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.283537 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m11:44:43.286376 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:43.301109 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.304292 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m11:44:43.308579 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:43.314166 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m11:44:43.316498 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.318334 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m11:44:43.323242 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:44:43.333336 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m11:44:43.336251 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m11:44:43.338404 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m11:44:43.343682 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:44:43.348079 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m11:44:43.352089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2d0b6eb0>]}
[0m11:44:43.357068 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.30s]
[0m11:44:43.361167 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m11:44:43.364035 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m11:44:43.366234 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m11:44:43.368693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m11:44:43.371511 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m11:44:43.380184 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.391573 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m11:44:43.401897 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.414726 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.416856 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m11:44:43.419054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:43.428995 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m11:44:43.431801 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.434202 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m11:44:43.484221 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.047 seconds
[0m11:44:43.499618 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.501396 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m11:44:43.505386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:43.514120 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.515932 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m11:44:43.517997 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:44:43.523040 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:44:43.524858 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.526283 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m11:44:43.529385 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:44:43.535865 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m11:44:43.539620 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m11:44:43.541563 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m11:44:43.545975 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:44:43.549618 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m11:44:43.551787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2a34eeb0>]}
[0m11:44:43.555711 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.18s]
[0m11:44:43.559266 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m11:44:43.561661 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m11:44:43.564012 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m11:44:43.566483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m11:44:43.568442 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m11:44:43.581932 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.593976 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m11:44:43.605020 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.622345 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.625162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m11:44:43.627475 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:43.634730 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:44:43.638097 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.641720 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m11:44:43.713115 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.069 seconds
[0m11:44:43.733373 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.735782 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m11:44:43.740202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:43.753844 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.756711 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m11:44:43.759656 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:43.767175 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:44:43.769643 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.773209 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m11:44:43.776665 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:44:43.794120 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m11:44:43.797516 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m11:44:43.799667 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m11:44:43.805269 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:44:43.810304 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m11:44:43.813382 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2a34eeb0>]}
[0m11:44:43.815964 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.25s]
[0m11:44:43.818970 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m11:44:43.822794 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m11:44:43.825373 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m11:44:43.828493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m11:44:43.830255 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m11:44:43.840377 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.850373 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m11:44:43.860511 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.871417 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.873248 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m11:44:43.874838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:44:43.881758 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m11:44:43.885247 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.888658 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m11:44:43.906067 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.015 seconds
[0m11:44:43.914075 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.916502 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m11:44:43.918667 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:43.927261 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.929408 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m11:44:43.931889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:44:43.936775 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:44:43.939887 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.942105 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m11:44:43.946616 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:44:43.956702 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m11:44:43.960614 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m11:44:43.963619 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m11:44:43.971076 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:44:43.979051 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m11:44:43.983470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac63e000-b270-490a-9e33-4af2760c54a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2ab5beb0>]}
[0m11:44:43.991143 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.15s]
[0m11:44:43.999130 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m11:44:44.009888 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:44.015642 [debug] [MainThread]: On master: BEGIN
[0m11:44:44.026810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:44.036034 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:44:44.039735 [debug] [MainThread]: On master: COMMIT
[0m11:44:44.042523 [debug] [MainThread]: Using postgres connection "master"
[0m11:44:44.046095 [debug] [MainThread]: On master: COMMIT
[0m11:44:44.048748 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:44:44.056101 [debug] [MainThread]: On master: Close
[0m11:44:44.059144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:44.062192 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m11:44:44.064312 [info ] [MainThread]: 
[0m11:44:44.066565 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m11:44:44.075031 [debug] [MainThread]: Command end result
[0m11:44:44.146408 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m11:44:44.156296 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m11:44:44.193630 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m11:44:44.195538 [info ] [MainThread]: 
[0m11:44:44.198064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:44.200542 [info ] [MainThread]: 
[0m11:44:44.204151 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m11:44:44.210688 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.122122, "process_in_blocks": "12424", "process_kernel_time": 2.642307, "process_mem_max_rss": "109844", "process_out_blocks": "0", "process_user_time": 10.648998}
[0m11:44:44.212986 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:44.212586 after 6.12 seconds
[0m11:44:44.215292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2cefe100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2d0b0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea2ae5ccd0>]}
[0m11:44:44.217230 [debug] [MainThread]: Flushing usage events
[0m11:44:45.077212 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:25:44.691533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da62aa100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da53e8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da53e8a90>]}


============================== 06:25:44.700939 | 2130f3f7-dfee-459d-ba3a-8fa486d6a077 ==============================
[0m06:25:44.700939 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:25:44.704415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:25:45.140222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da73940a0>]}
[0m06:25:45.259941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da5a48c70>]}
[0m06:25:45.262732 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:25:45.402817 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:25:45.966086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:25:45.967599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:25:46.041716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3fdbf70>]}
[0m06:25:46.229562 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:25:46.238994 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:25:46.283887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3fdb790>]}
[0m06:25:46.285766 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:25:46.291988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da64a8a60>]}
[0m06:25:46.297335 [info ] [MainThread]: 
[0m06:25:46.299531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:25:46.302271 [info ] [MainThread]: 
[0m06:25:46.304733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:25:46.315872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:25:46.419382 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:25:46.420671 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:25:46.421935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:25:46.439491 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m06:25:46.442774 [debug] [ThreadPool]: On list_airflow: Close
[0m06:25:46.446686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:25:46.463284 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:25:46.464714 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:25:46.466062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:25:46.471027 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:25:46.472746 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:25:46.474333 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:25:46.484790 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m06:25:46.488865 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:25:46.490621 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:25:46.507552 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:46.521136 [debug] [MainThread]: On master: BEGIN
[0m06:25:46.522556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:25:46.528018 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:25:46.529766 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:46.531432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:25:46.541088 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m06:25:46.544391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3ffc610>]}
[0m06:25:46.546223 [debug] [MainThread]: On master: ROLLBACK
[0m06:25:46.547969 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:46.551159 [debug] [MainThread]: On master: BEGIN
[0m06:25:46.552923 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:25:46.554490 [debug] [MainThread]: On master: COMMIT
[0m06:25:46.556123 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:46.557623 [debug] [MainThread]: On master: COMMIT
[0m06:25:46.559320 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:46.560757 [debug] [MainThread]: On master: Close
[0m06:25:46.569235 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:25:46.571498 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:25:46.573604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:25:46.575367 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:25:46.593112 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.601546 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:25:46.675389 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.682850 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.684178 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:25:46.685614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:46.690254 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:25:46.692051 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.693594 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:25:46.750261 [debug] [Thread-1  ]: SQL status: SELECT 7800 in 0.055 seconds
[0m06:25:46.763575 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.765563 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:25:46.767864 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:46.774303 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.775717 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:25:46.777638 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:46.822147 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:25:46.823799 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.825192 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:25:46.831087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:25:46.844965 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:25:46.855057 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:25:46.856568 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:25:46.862500 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:25:46.868516 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:25:46.873765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da36f7730>]}
[0m06:25:46.875827 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7800[0m in 0.30s]
[0m06:25:46.878380 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:25:46.880230 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:25:46.882263 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:25:46.884826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:25:46.886314 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:25:46.897847 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:25:46.905466 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:25:46.914688 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:25:46.923432 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:46.925316 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:25:46.927165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:46.933762 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:46.935471 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:46.937045 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:25:46.965322 [debug] [Thread-1  ]: SQL status: SELECT 7800 in 0.026 seconds
[0m06:25:46.973719 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:46.975360 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:25:46.977600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:46.985986 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:46.987597 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:25:46.989559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:46.992623 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:25:46.993993 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:46.995117 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:25:46.998295 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:25:47.005339 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:25:47.007281 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:25:47.008683 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:25:47.011907 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:25:47.015153 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:25:47.017595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da6462eb0>]}
[0m06:25:47.019734 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7800[0m in 0.13s]
[0m06:25:47.021830 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:25:47.023516 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:47.025140 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:25:47.027268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:25:47.028974 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:47.037289 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.043857 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:47.113291 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.120896 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.122480 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:25:47.124095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:47.130025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:25:47.132341 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.135619 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m06:25:47.168441 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.031 seconds
[0m06:25:47.174129 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.175311 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:25:47.176743 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:47.182060 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.183454 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:25:47.185095 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:47.189682 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:25:47.191340 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.193129 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:25:47.196343 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:25:47.202979 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:25:47.205075 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:25:47.206453 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:25:47.210774 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:47.215051 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:25:47.217739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da6462eb0>]}
[0m06:25:47.220584 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.19s]
[0m06:25:47.224123 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:25:47.226142 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:25:47.227986 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:25:47.229995 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:25:47.231725 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:25:47.238019 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.244823 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:25:47.253142 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.261835 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.263813 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:25:47.265764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:47.271053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:25:47.272872 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.274449 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:25:47.299429 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.023 seconds
[0m06:25:47.307889 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.309098 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:25:47.310600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:47.317487 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.319107 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:25:47.320712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:47.324324 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:25:47.325577 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.326585 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:25:47.328551 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:25:47.332892 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:25:47.334981 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:25:47.336135 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:25:47.338810 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:25:47.341185 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:25:47.342547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da370deb0>]}
[0m06:25:47.343949 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.11s]
[0m06:25:47.345835 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:25:47.347137 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:25:47.348507 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:25:47.350244 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:25:47.351745 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:25:47.356473 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.362708 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:25:47.371102 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.378435 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.380163 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:25:47.383304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:47.390027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:25:47.391651 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.392840 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:25:47.425364 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.031 seconds
[0m06:25:47.430731 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.432108 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:25:47.433893 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:47.441153 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.442586 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:25:47.444322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:47.448508 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:25:47.450058 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.451715 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:25:47.454255 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:25:47.460710 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:25:47.462749 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:25:47.464076 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:25:47.467109 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:25:47.470265 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:25:47.471968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da37a6520>]}
[0m06:25:47.473572 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.12s]
[0m06:25:47.475409 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:25:47.476759 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:25:47.478008 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:25:47.479673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:25:47.481042 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:25:47.486486 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.492616 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:25:47.498396 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.505120 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.506347 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:25:47.507397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:47.511644 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:25:47.513282 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.514921 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:25:47.528725 [debug] [Thread-1  ]: SQL status: SELECT 2427 in 0.012 seconds
[0m06:25:47.536619 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.538103 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:25:47.539962 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:25:47.548332 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.550018 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:25:47.552276 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:25:47.555358 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:25:47.556624 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.557803 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:25:47.561178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:25:47.566708 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:25:47.568927 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:25:47.570432 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:25:47.574498 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:25:47.577452 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:25:47.579490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2130f3f7-dfee-459d-ba3a-8fa486d6a077', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3347700>]}
[0m06:25:47.581437 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2427[0m in 0.10s]
[0m06:25:47.583858 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:25:47.587164 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:47.588499 [debug] [MainThread]: On master: BEGIN
[0m06:25:47.589597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:25:47.594202 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m06:25:47.595797 [debug] [MainThread]: On master: COMMIT
[0m06:25:47.597126 [debug] [MainThread]: Using postgres connection "master"
[0m06:25:47.598424 [debug] [MainThread]: On master: COMMIT
[0m06:25:47.599844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:25:47.601151 [debug] [MainThread]: On master: Close
[0m06:25:47.602787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:47.604058 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:25:47.605545 [info ] [MainThread]: 
[0m06:25:47.606997 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m06:25:47.610554 [debug] [MainThread]: Command end result
[0m06:25:47.661608 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:25:47.667054 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:25:47.682510 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:25:47.683917 [info ] [MainThread]: 
[0m06:25:47.686010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:25:47.687943 [info ] [MainThread]: 
[0m06:25:47.689689 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:25:47.693154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.186806, "process_in_blocks": "83984", "process_kernel_time": 0.545804, "process_mem_max_rss": "108536", "process_out_blocks": "0", "process_user_time": 5.356967}
[0m06:25:47.694870 [debug] [MainThread]: Command `dbt run` succeeded at 06:25:47.694604 after 3.19 seconds
[0m06:25:47.696637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da62aa100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3fc6220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5da3fdccd0>]}
[0m06:25:47.698362 [debug] [MainThread]: Flushing usage events
[0m06:25:49.689400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:29:15.036639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3581a2e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3580b6ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3580b6ca90>]}


============================== 06:29:15.043149 | c9cd6086-1027-4c7b-a30e-65929ffc9a4e ==============================
[0m06:29:15.043149 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:29:15.045599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:29:15.463786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3582b180a0>]}
[0m06:29:15.588033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35811ccc70>]}
[0m06:29:15.590600 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:29:15.741906 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:29:16.206621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:29:16.207916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:29:16.312873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357f71bf70>]}
[0m06:29:16.519134 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:29:16.529864 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:29:16.571184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357f71b790>]}
[0m06:29:16.572883 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:29:16.575646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3581c2da60>]}
[0m06:29:16.580950 [info ] [MainThread]: 
[0m06:29:16.583247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:29:16.584898 [info ] [MainThread]: 
[0m06:29:16.587438 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:29:16.599493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:29:16.680991 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:29:16.682189 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:29:16.683503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:29:16.701768 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m06:29:16.705433 [debug] [ThreadPool]: On list_airflow: Close
[0m06:29:16.712236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:29:16.728686 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:29:16.730204 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:29:16.731433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:29:16.736035 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m06:29:16.737720 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:29:16.739451 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:29:16.752366 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.011 seconds
[0m06:29:16.756394 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:29:16.758089 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:29:16.776020 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:16.777539 [debug] [MainThread]: On master: BEGIN
[0m06:29:16.778978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:29:16.785136 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:29:16.786823 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:16.788442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:29:16.799139 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m06:29:16.802469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357f73c610>]}
[0m06:29:16.804357 [debug] [MainThread]: On master: ROLLBACK
[0m06:29:16.806166 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:16.807575 [debug] [MainThread]: On master: BEGIN
[0m06:29:16.810263 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:29:16.811992 [debug] [MainThread]: On master: COMMIT
[0m06:29:16.813626 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:16.815139 [debug] [MainThread]: On master: COMMIT
[0m06:29:16.816849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:16.818310 [debug] [MainThread]: On master: Close
[0m06:29:16.824591 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:29:16.826103 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:29:16.828489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:29:16.830186 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:29:16.850894 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:29:16.859879 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:29:16.931813 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:29:16.941564 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:16.942915 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:29:16.944379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:16.951396 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:29:16.953051 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:16.954599 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:29:17.009140 [debug] [Thread-1  ]: SQL status: SELECT 7805 in 0.053 seconds
[0m06:29:17.023920 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:17.025435 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:29:17.027627 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.036842 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:17.038720 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:29:17.041383 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.089157 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:29:17.090683 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:17.092374 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:29:17.095897 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:29:17.107934 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:29:17.118181 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:29:17.119624 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:29:17.127382 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:29:17.133039 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:29:17.139326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357ebf5730>]}
[0m06:29:17.141380 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7805[0m in 0.31s]
[0m06:29:17.143724 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:29:17.145418 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:29:17.147010 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:29:17.149156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:29:17.150704 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:29:17.159125 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.166515 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:29:17.175785 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.183028 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.184428 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:29:17.185817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:17.190939 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:29:17.193060 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.194969 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:29:17.232079 [debug] [Thread-1  ]: SQL status: SELECT 7805 in 0.035 seconds
[0m06:29:17.237951 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.239346 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:29:17.241492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:17.249557 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.252162 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:29:17.254110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:29:17.257144 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:29:17.258280 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.259265 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:29:17.262465 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:29:17.268776 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:29:17.271023 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:29:17.273033 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:29:17.277437 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:29:17.280758 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:29:17.282780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3581be6eb0>]}
[0m06:29:17.284840 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7805[0m in 0.13s]
[0m06:29:17.287353 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:29:17.288804 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:17.290464 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:29:17.292256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:29:17.293683 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:17.301388 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.307868 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:17.364981 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.371754 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.372874 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:29:17.373824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:17.378446 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:29:17.380080 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.381685 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m06:29:17.414322 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.031 seconds
[0m06:29:17.420097 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.421520 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:29:17.422923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.428083 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.429185 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:29:17.430583 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.433119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:29:17.434197 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.435156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:29:17.437389 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:29:17.442382 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:29:17.444530 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:29:17.445886 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:29:17.448777 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:29:17.451315 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:29:17.452893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3581be6eb0>]}
[0m06:29:17.454799 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.16s]
[0m06:29:17.456698 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:29:17.457936 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:29:17.459098 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:29:17.460646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:29:17.461779 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:29:17.466865 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.472554 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:29:17.480340 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.485775 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.487107 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:29:17.488276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:17.492368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:29:17.494004 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.495745 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:29:17.518393 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.022 seconds
[0m06:29:17.527567 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.528913 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:29:17.530499 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.535596 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.537009 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:29:17.538734 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.541669 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:29:17.543015 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.544206 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:29:17.547053 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:29:17.552350 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:29:17.554413 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:29:17.555738 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:29:17.559343 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:29:17.562353 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:29:17.564201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357ee48eb0>]}
[0m06:29:17.565936 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.10s]
[0m06:29:17.568171 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:29:17.569513 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:29:17.571275 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:29:17.573209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:29:17.574890 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:29:17.584517 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.591217 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:29:17.600770 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.607548 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.608710 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:29:17.609729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:17.614767 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:29:17.616253 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.617634 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:29:17.641141 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.022 seconds
[0m06:29:17.646900 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.648056 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:29:17.649519 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.655769 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.657117 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:29:17.658990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.662572 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:29:17.664035 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.665188 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:29:17.668138 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:29:17.677238 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:29:17.678994 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:29:17.680128 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:29:17.683104 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:29:17.685908 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:29:17.687718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357ee48eb0>]}
[0m06:29:17.689258 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.11s]
[0m06:29:17.691384 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:29:17.692841 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:29:17.694290 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:29:17.696016 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:29:17.697271 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:29:17.702960 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.709357 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:29:17.715128 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.721046 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.722083 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:29:17.723063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:29:17.727014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m06:29:17.728737 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.730218 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:29:17.742215 [debug] [Thread-1  ]: SQL status: SELECT 2436 in 0.011 seconds
[0m06:29:17.747080 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.748088 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:29:17.749386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.754006 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.755070 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:29:17.756425 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:29:17.759896 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:29:17.761317 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.762498 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:29:17.765344 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:29:17.772471 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:29:17.774485 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:29:17.775554 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:29:17.779116 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:29:17.782353 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:29:17.784184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9cd6086-1027-4c7b-a30e-65929ffc9a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357f6575e0>]}
[0m06:29:17.785935 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2436[0m in 0.09s]
[0m06:29:17.788309 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:29:17.790722 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:17.791837 [debug] [MainThread]: On master: BEGIN
[0m06:29:17.792834 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:29:17.796579 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m06:29:17.797843 [debug] [MainThread]: On master: COMMIT
[0m06:29:17.798755 [debug] [MainThread]: Using postgres connection "master"
[0m06:29:17.799576 [debug] [MainThread]: On master: COMMIT
[0m06:29:17.800614 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:29:17.801614 [debug] [MainThread]: On master: Close
[0m06:29:17.802683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:29:17.803817 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:29:17.804934 [info ] [MainThread]: 
[0m06:29:17.806256 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m06:29:17.810106 [debug] [MainThread]: Command end result
[0m06:29:17.850304 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:29:17.855272 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:29:17.870227 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:29:17.871271 [info ] [MainThread]: 
[0m06:29:17.872639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:29:17.874515 [info ] [MainThread]: 
[0m06:29:17.876158 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:29:17.879354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.015344, "process_in_blocks": "84256", "process_kernel_time": 0.659801, "process_mem_max_rss": "107912", "process_out_blocks": "0", "process_user_time": 4.987321}
[0m06:29:17.880810 [debug] [MainThread]: Command `dbt run` succeeded at 06:29:17.880530 after 3.02 seconds
[0m06:29:17.882185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3581a2e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357f71b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f357f71ccd0>]}
[0m06:29:17.883741 [debug] [MainThread]: Flushing usage events
[0m06:29:18.776355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:07:25.253856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243d6a00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243c7de9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243c7dea30>]}


============================== 06:07:25.268970 | c949e7eb-c097-4242-8dd2-7fe234d4c70c ==============================
[0m06:07:25.268970 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:07:25.273468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:07:28.592135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243e63d9d0>]}
[0m06:07:28.821245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243bfb2f70>]}
[0m06:07:28.824783 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:07:32.413923 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:07:33.677696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:07:33.679967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:07:33.953162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243b3dbf40>]}
[0m06:07:34.390529 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:07:34.412830 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:07:34.650735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243b3dbf70>]}
[0m06:07:34.653520 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:07:34.655580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243dbd3460>]}
[0m06:07:34.661673 [info ] [MainThread]: 
[0m06:07:34.663874 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:07:34.665809 [info ] [MainThread]: 
[0m06:07:34.668348 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:07:34.681494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:07:39.437733 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:07:39.443295 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:07:39.445005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:39.478780 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m06:07:39.483781 [debug] [ThreadPool]: On list_airflow: Close
[0m06:07:39.489939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:07:39.510434 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:07:39.513100 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:07:39.515227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:39.526967 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m06:07:39.529502 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:07:39.538126 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:07:39.562748 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.020 seconds
[0m06:07:39.567909 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:07:39.570446 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:07:39.597925 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:39.602272 [debug] [MainThread]: On master: BEGIN
[0m06:07:39.604495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:07:39.612266 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:07:39.616653 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:39.622200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:07:39.641874 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m06:07:39.649690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243b3e5d60>]}
[0m06:07:39.651617 [debug] [MainThread]: On master: ROLLBACK
[0m06:07:39.653369 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:39.654837 [debug] [MainThread]: On master: BEGIN
[0m06:07:39.656671 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:07:39.658731 [debug] [MainThread]: On master: COMMIT
[0m06:07:39.660312 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:39.662344 [debug] [MainThread]: On master: COMMIT
[0m06:07:39.664083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:07:39.665739 [debug] [MainThread]: On master: Close
[0m06:07:39.682618 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:07:39.685412 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:07:39.688027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:07:39.690487 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:07:39.721619 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:07:39.739263 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:07:39.889163 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:07:39.906300 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:07:39.909521 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:07:39.913585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:39.922815 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:07:39.925393 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:07:39.928095 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:07:40.125951 [debug] [Thread-1  ]: SQL status: SELECT 7810 in 0.195 seconds
[0m06:07:40.165015 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:07:40.184748 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:07:40.244034 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.057 seconds
[0m06:07:40.254144 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:07:40.256519 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:07:40.259882 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:40.347374 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:07:40.349423 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:07:40.351155 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:07:40.365330 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m06:07:40.404847 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:07:40.428397 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:07:40.433664 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:07:40.504086 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.068 seconds
[0m06:07:40.513316 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:07:40.532123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243e7d4730>]}
[0m06:07:40.535493 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7810[0m in 0.83s]
[0m06:07:40.540792 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:07:40.544308 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:07:40.548660 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:07:40.553711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:07:40.556264 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:07:40.579510 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.639945 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:07:40.664155 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.685158 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.689551 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:07:40.693459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:40.701325 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:07:40.705358 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.710396 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:07:40.807376 [debug] [Thread-1  ]: SQL status: SELECT 7810 in 0.094 seconds
[0m06:07:40.831632 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.838108 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:07:40.845079 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:07:40.856755 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.858525 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:07:40.860479 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:07:40.864541 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:07:40.866695 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.868390 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:07:40.940702 [debug] [Thread-1  ]: SQL status: COMMIT in 0.070 seconds
[0m06:07:40.956685 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:07:40.960528 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:07:40.962565 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:07:40.994740 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.030 seconds
[0m06:07:41.001874 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:07:41.005228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243e7d4730>]}
[0m06:07:41.010015 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7810[0m in 0.45s]
[0m06:07:41.019081 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:07:41.022367 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:07:41.024682 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:07:41.027095 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:07:41.029039 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:07:41.040521 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:41.060338 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:07:41.157421 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:41.594009 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:41.595889 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:07:41.597831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:41.604596 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:07:41.607050 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:41.609461 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m06:07:44.850710 [debug] [Thread-1  ]: SQL status: SELECT 20 in 3.239 seconds
[0m06:07:44.884664 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:44.911302 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:07:44.928680 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:07:44.943870 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:44.946721 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:07:44.951283 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:44.956272 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:07:44.958498 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:44.960703 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:07:45.086894 [debug] [Thread-1  ]: SQL status: COMMIT in 0.123 seconds
[0m06:07:45.150424 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:07:45.161607 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:07:45.171697 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:07:45.203631 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.027 seconds
[0m06:07:45.212224 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:07:45.216906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243e7d4730>]}
[0m06:07:45.225501 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 4.19s]
[0m06:07:45.235411 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:07:45.238597 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:07:45.252068 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:07:45.258085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:07:45.268782 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:07:45.335028 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.414284 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:07:45.445463 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.484180 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.487969 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:07:45.499370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:45.542497 [debug] [Thread-1  ]: SQL status: BEGIN in 0.043 seconds
[0m06:07:45.570313 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.578090 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:07:45.716384 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.133 seconds
[0m06:07:45.740337 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.755041 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:07:45.758217 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:45.779461 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.790357 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:07:45.794913 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:45.809215 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:07:45.832587 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.835709 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:07:45.843152 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m06:07:45.857428 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:07:45.871610 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:07:45.875792 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:07:45.882082 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:07:45.888959 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:07:45.899814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243bf08bb0>]}
[0m06:07:45.903048 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.64s]
[0m06:07:45.909112 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:07:45.919394 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:07:45.922064 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:07:45.925769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:07:45.928670 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:07:45.949418 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:07:45.973777 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:07:45.999957 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:07:46.014396 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:07:46.018146 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:07:46.021488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:46.032203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m06:07:46.035188 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:07:46.037585 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:07:46.145741 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.096 seconds
[0m06:07:46.163762 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:07:46.166208 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:07:46.169359 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:46.186519 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:07:46.189075 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:07:46.194219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:46.203918 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:07:46.206251 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:07:46.209142 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:07:46.218589 [debug] [Thread-1  ]: SQL status: COMMIT in 0.007 seconds
[0m06:07:46.233481 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:07:46.237794 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:07:46.249327 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:07:46.271797 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.017 seconds
[0m06:07:46.278173 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:07:46.289290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243bf08bb0>]}
[0m06:07:46.293272 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.36s]
[0m06:07:46.300488 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:07:46.304751 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:07:46.318018 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:07:46.324343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:07:46.327360 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:07:46.348926 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.379390 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:07:46.405245 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.421631 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.424156 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:07:46.426397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:07:46.434413 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:07:46.443740 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.447243 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:07:46.494828 [debug] [Thread-1  ]: SQL status: SELECT 2442 in 0.035 seconds
[0m06:07:46.509149 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.511632 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:07:46.515801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:46.532447 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.534841 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:07:46.539233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:07:46.545589 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:07:46.547737 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.549827 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:07:46.553837 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:07:46.567077 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:07:46.585783 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:07:46.599769 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:07:46.612269 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:07:46.618897 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:07:46.633536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c949e7eb-c097-4242-8dd2-7fe234d4c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243ab0eeb0>]}
[0m06:07:46.639614 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2442[0m in 0.31s]
[0m06:07:46.648451 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:07:46.668161 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:46.671021 [debug] [MainThread]: On master: BEGIN
[0m06:07:46.673605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:07:46.684930 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m06:07:46.688735 [debug] [MainThread]: On master: COMMIT
[0m06:07:46.691085 [debug] [MainThread]: Using postgres connection "master"
[0m06:07:46.695264 [debug] [MainThread]: On master: COMMIT
[0m06:07:46.698984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:07:46.703526 [debug] [MainThread]: On master: Close
[0m06:07:46.710207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:46.712948 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:07:46.715763 [info ] [MainThread]: 
[0m06:07:46.718358 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 12.05 seconds (12.05s).
[0m06:07:46.735123 [debug] [MainThread]: Command end result
[0m06:07:47.057094 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:07:47.099064 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:07:47.172847 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:07:47.176557 [info ] [MainThread]: 
[0m06:07:47.179591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:07:47.183116 [info ] [MainThread]: 
[0m06:07:47.187861 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:07:47.227293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.408653, "process_in_blocks": "84160", "process_kernel_time": 0.984955, "process_mem_max_rss": "107992", "process_out_blocks": "0", "process_user_time": 9.166115}
[0m06:07:47.238536 [debug] [MainThread]: Command `dbt run` succeeded at 06:07:47.238090 after 22.42 seconds
[0m06:07:47.240603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243d6a00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243b3dbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f243b3dcd30>]}
[0m06:07:47.252313 [debug] [MainThread]: Flushing usage events
[0m06:07:48.170897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:17.961607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b763fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b75539a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b75539ac0>]}


============================== 10:02:17.969468 | 2a9c618a-c7a3-4098-bd86-3c070b656578 ==============================
[0m10:02:17.969468 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:02:17.972396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:02:18.237700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b755168e0>]}
[0m10:02:18.366469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b74f3f1c0>]}
[0m10:02:18.368215 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:02:18.522386 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:02:18.944108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:18.945119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:19.001374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7435af10>]}
[0m10:02:19.133144 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:02:19.140762 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:02:19.158638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b74345ac0>]}
[0m10:02:19.159850 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m10:02:19.161218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b769685e0>]}
[0m10:02:19.164006 [info ] [MainThread]: 
[0m10:02:19.165495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:02:19.166485 [info ] [MainThread]: 
[0m10:02:19.167613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:02:19.175434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:02:19.217698 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:02:19.219041 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:02:19.220034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:02:19.228286 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m10:02:19.230227 [debug] [ThreadPool]: On list_airflow: Close
[0m10:02:19.232637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m10:02:19.243945 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:02:19.245152 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m10:02:19.246183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:02:19.249683 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m10:02:19.250788 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m10:02:19.251825 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m10:02:19.255572 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m10:02:19.258786 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m10:02:19.259983 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m10:02:19.267677 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:19.268696 [debug] [MainThread]: On master: BEGIN
[0m10:02:19.269425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:02:19.274061 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:02:19.275203 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:19.276110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:02:19.279475 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:02:19.282031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7437b7f0>]}
[0m10:02:19.283398 [debug] [MainThread]: On master: ROLLBACK
[0m10:02:19.284510 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:19.285268 [debug] [MainThread]: On master: BEGIN
[0m10:02:19.286283 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:02:19.287046 [debug] [MainThread]: On master: COMMIT
[0m10:02:19.288052 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:19.289703 [debug] [MainThread]: On master: COMMIT
[0m10:02:19.290775 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:02:19.291975 [debug] [MainThread]: On master: Close
[0m10:02:19.294843 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m10:02:19.296176 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m10:02:19.297871 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m10:02:19.299665 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m10:02:19.314989 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.325291 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m10:02:19.392744 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.403255 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.406176 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m10:02:19.409133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:02:19.414096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:02:19.415997 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.417802 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:02:19.449447 [debug] [Thread-1  ]: SQL status: SELECT 7815 in 0.030 seconds
[0m10:02:19.460025 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.461304 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m10:02:19.462877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.468500 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.470246 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m10:02:19.473412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:02:19.502078 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:02:19.503363 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.504362 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m10:02:19.508080 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m10:02:19.516548 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m10:02:19.523110 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m10:02:19.524174 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m10:02:19.527202 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:02:19.531232 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m10:02:19.534401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b73a776d0>]}
[0m10:02:19.535875 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7815[0m in 0.24s]
[0m10:02:19.537076 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m10:02:19.538387 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m10:02:19.539895 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m10:02:19.541365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m10:02:19.542661 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m10:02:19.547136 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.552175 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m10:02:19.558886 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.566716 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.569003 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m10:02:19.570433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:02:19.575379 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m10:02:19.576669 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.578567 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m10:02:19.606434 [debug] [Thread-1  ]: SQL status: SELECT 7815 in 0.026 seconds
[0m10:02:19.611772 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.613236 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m10:02:19.615082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.620349 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.622699 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m10:02:19.625105 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.627876 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:02:19.629353 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.630858 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m10:02:19.634484 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m10:02:19.640126 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m10:02:19.642024 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m10:02:19.643277 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m10:02:19.646821 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:02:19.649458 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m10:02:19.651093 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b73b23a60>]}
[0m10:02:19.652678 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7815[0m in 0.11s]
[0m10:02:19.654305 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m10:02:19.656195 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m10:02:19.657983 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m10:02:19.659294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m10:02:19.660288 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m10:02:19.666569 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.672832 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m10:02:19.727437 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.734627 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.735817 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m10:02:19.736933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:02:19.743224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m10:02:19.744591 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.745762 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m10:02:19.767496 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.021 seconds
[0m10:02:19.772845 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.774266 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m10:02:19.775710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.780212 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.781201 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m10:02:19.782507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.784727 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:02:19.785555 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.786381 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m10:02:19.788451 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:02:19.792871 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m10:02:19.794169 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m10:02:19.794961 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m10:02:19.797397 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:02:19.799710 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m10:02:19.801018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b73b23a60>]}
[0m10:02:19.802423 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.14s]
[0m10:02:19.803604 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m10:02:19.805831 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m10:02:19.807937 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m10:02:19.809320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m10:02:19.810529 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m10:02:19.815523 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.824111 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m10:02:19.831307 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.837623 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.840199 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m10:02:19.841698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:02:19.845520 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m10:02:19.846639 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.847610 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m10:02:19.871147 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.022 seconds
[0m10:02:19.880878 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.882204 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m10:02:19.883780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.889081 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.890307 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m10:02:19.891882 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.894427 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:02:19.895380 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.896422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m10:02:19.898458 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:02:19.902752 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m10:02:19.904802 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m10:02:19.907075 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m10:02:19.909870 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:02:19.912214 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m10:02:19.913836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b73b23a60>]}
[0m10:02:19.915385 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.10s]
[0m10:02:19.916715 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m10:02:19.917634 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m10:02:19.918682 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m10:02:19.919903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m10:02:19.921001 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m10:02:19.926741 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m10:02:19.933151 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m10:02:19.939599 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m10:02:19.945356 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:02:19.946935 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m10:02:19.948025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:02:19.952612 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m10:02:19.953890 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:02:19.955748 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m10:02:19.977035 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.020 seconds
[0m10:02:19.982310 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:02:19.983422 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m10:02:19.984634 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.989311 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:02:19.990420 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m10:02:19.991875 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:19.994386 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:02:19.995237 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:02:19.996061 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m10:02:19.997826 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m10:02:20.002917 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m10:02:20.004410 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m10:02:20.006264 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m10:02:20.009739 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:02:20.011972 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m10:02:20.013580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b73aec700>]}
[0m10:02:20.015001 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.09s]
[0m10:02:20.016460 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m10:02:20.017416 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m10:02:20.018695 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m10:02:20.019721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m10:02:20.020774 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m10:02:20.025792 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.030956 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m10:02:20.036513 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.042995 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.043953 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m10:02:20.045096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:02:20.048570 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m10:02:20.049774 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.050652 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m10:02:20.059483 [debug] [Thread-1  ]: SQL status: SELECT 2449 in 0.008 seconds
[0m10:02:20.063972 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.064890 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m10:02:20.065990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:20.075288 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.076962 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m10:02:20.079581 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:02:20.083440 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:02:20.084878 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.086138 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m10:02:20.090166 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m10:02:20.095098 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m10:02:20.096825 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m10:02:20.097961 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m10:02:20.101368 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m10:02:20.104180 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m10:02:20.106490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a9c618a-c7a3-4098-bd86-3c070b656578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b73a8ee50>]}
[0m10:02:20.108346 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2449[0m in 0.09s]
[0m10:02:20.110215 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m10:02:20.112775 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:20.114316 [debug] [MainThread]: On master: BEGIN
[0m10:02:20.115408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:02:20.119144 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:02:20.120532 [debug] [MainThread]: On master: COMMIT
[0m10:02:20.122147 [debug] [MainThread]: Using postgres connection "master"
[0m10:02:20.123286 [debug] [MainThread]: On master: COMMIT
[0m10:02:20.124481 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:02:20.125362 [debug] [MainThread]: On master: Close
[0m10:02:20.126415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:02:20.127407 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m10:02:20.128606 [info ] [MainThread]: 
[0m10:02:20.129976 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m10:02:20.132765 [debug] [MainThread]: Command end result
[0m10:02:20.176915 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m10:02:20.181940 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m10:02:20.195355 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m10:02:20.196269 [info ] [MainThread]: 
[0m10:02:20.197209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:02:20.198133 [info ] [MainThread]: 
[0m10:02:20.199023 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m10:02:20.200530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.458179, "process_in_blocks": "22320", "process_kernel_time": 0.2017, "process_mem_max_rss": "108528", "process_out_blocks": "0", "process_user_time": 4.302934}
[0m10:02:20.202039 [debug] [MainThread]: Command `dbt run` succeeded at 10:02:20.201850 after 2.46 seconds
[0m10:02:20.202982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b763fb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b743ba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b768d1880>]}
[0m10:02:20.204013 [debug] [MainThread]: Flushing usage events
[0m10:02:20.789864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:23:12.303840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad9b1f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad8c5d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad8c5da30>]}


============================== 06:23:12.329588 | b0f38aea-b3f4-47ea-a0e1-9dc674a691c1 ==============================
[0m06:23:12.329588 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:23:12.338745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:23:13.267103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adaabb9d0>]}
[0m06:23:13.536534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad8685f70>]}
[0m06:23:13.540480 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:23:13.811654 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:23:14.713069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:23:14.716107 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:23:14.886428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad7a9af40>]}
[0m06:23:15.211054 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:23:15.227485 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:23:15.300664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad7a9af70>]}
[0m06:23:15.304305 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:23:15.308008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ada052460>]}
[0m06:23:15.317681 [info ] [MainThread]: 
[0m06:23:15.320806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:23:15.323753 [info ] [MainThread]: 
[0m06:23:15.327463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:23:15.346167 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:23:15.488522 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:23:15.491118 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:23:15.493495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:23:15.517528 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m06:23:15.524313 [debug] [ThreadPool]: On list_airflow: Close
[0m06:23:15.534015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:23:15.557984 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:23:15.560509 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:23:15.562997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:23:15.572761 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m06:23:15.575684 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:23:15.578296 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:23:15.590900 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m06:23:15.597060 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:23:15.600331 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:23:15.622701 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:15.625570 [debug] [MainThread]: On master: BEGIN
[0m06:23:15.628210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:23:15.639327 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m06:23:15.642280 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:15.645529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:23:15.658694 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m06:23:15.665403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad7aa3d60>]}
[0m06:23:15.668647 [debug] [MainThread]: On master: ROLLBACK
[0m06:23:15.671874 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:15.674460 [debug] [MainThread]: On master: BEGIN
[0m06:23:15.677932 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:23:15.681727 [debug] [MainThread]: On master: COMMIT
[0m06:23:15.685463 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:15.688062 [debug] [MainThread]: On master: COMMIT
[0m06:23:15.690664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:23:15.693334 [debug] [MainThread]: On master: Close
[0m06:23:15.704985 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:23:15.707830 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:23:15.711107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:23:15.714288 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:23:15.740722 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:23:15.759196 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:23:15.902390 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:23:15.924225 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:23:15.927288 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:23:15.929969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:23:15.939555 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:23:15.942341 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:23:15.944769 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:23:16.032759 [debug] [Thread-1  ]: SQL status: SELECT 7815 in 0.085 seconds
[0m06:23:16.053821 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:23:16.056338 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:23:16.060390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.071496 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:23:16.074201 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:23:16.077446 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.142001 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:23:16.145140 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:23:16.148253 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:23:16.153140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:23:16.177078 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:23:16.192681 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:23:16.196104 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:23:16.204481 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m06:23:16.214265 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:23:16.221483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adac53730>]}
[0m06:23:16.224798 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7815[0m in 0.51s]
[0m06:23:16.228293 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:23:16.231450 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:23:16.234592 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:23:16.237838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:23:16.240068 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:23:16.250536 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.266679 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:23:16.290936 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.309210 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.311658 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:23:16.314406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:23:16.323835 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:23:16.327040 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.330068 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:23:16.377141 [debug] [Thread-1  ]: SQL status: SELECT 7815 in 0.044 seconds
[0m06:23:16.388896 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.391058 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:23:16.394473 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.406750 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.408906 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:23:16.411844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.418057 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:23:16.420728 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.423333 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:23:16.427785 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:23:16.439341 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:23:16.443068 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:23:16.445404 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:23:16.451371 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:23:16.456423 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:23:16.459455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adac53730>]}
[0m06:23:16.462910 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7815[0m in 0.22s]
[0m06:23:16.467319 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:23:16.470027 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:23:16.472976 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:23:16.476837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:23:16.479815 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:23:16.493175 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.507787 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:23:16.610507 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.623422 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.625758 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:23:16.628192 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:23:16.637103 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:23:16.640791 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.644051 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m06:23:16.692123 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.045 seconds
[0m06:23:16.705439 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.708272 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:23:16.712025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.722691 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.725230 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:23:16.728724 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.734654 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:23:16.736659 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.738441 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:23:16.741556 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:23:16.750046 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:23:16.752731 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:23:16.754583 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:23:16.758955 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:23:16.763854 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:23:16.766647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4adac53730>]}
[0m06:23:16.769532 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.29s]
[0m06:23:16.773260 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:23:16.776292 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:23:16.783845 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:23:16.788878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:23:16.791484 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:23:16.802630 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.815998 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:23:16.830324 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.843795 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.846577 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:23:16.849173 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:23:16.858460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:23:16.861155 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.863683 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:23:16.912529 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.046 seconds
[0m06:23:16.926187 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.928397 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:23:16.932439 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.943303 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.946296 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:23:16.950414 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:16.957320 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:23:16.959692 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.961708 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:23:16.965778 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:23:16.974681 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:23:16.977973 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:23:16.980571 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:23:16.985851 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:23:16.990603 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:23:16.993250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad8c49850>]}
[0m06:23:16.996385 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.20s]
[0m06:23:16.999805 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:23:17.002329 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:23:17.005306 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:23:17.008594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:23:17.011012 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:23:17.022698 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.037944 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:23:17.054827 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.067881 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.070090 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:23:17.072018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:23:17.081419 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:23:17.084513 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.086960 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:23:17.132398 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.043 seconds
[0m06:23:17.143691 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.146247 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:23:17.150269 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:17.161052 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.163869 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:23:17.167192 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:17.173037 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:23:17.175752 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.178223 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:23:17.183315 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:23:17.195731 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:23:17.199885 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:23:17.202716 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:23:17.209309 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:23:17.215261 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:23:17.218354 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad8c49850>]}
[0m06:23:17.221331 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.21s]
[0m06:23:17.224958 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:23:17.227886 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:23:17.231137 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:23:17.234392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:23:17.236979 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:23:17.248955 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.266967 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:23:17.286004 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.310194 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.313227 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:23:17.316037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:23:17.324663 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:23:17.327605 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.330445 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:23:17.350805 [debug] [Thread-1  ]: SQL status: SELECT 2449 in 0.017 seconds
[0m06:23:17.361724 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.364398 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:23:17.367665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:17.379266 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.382000 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:23:17.385278 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:23:17.392230 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:23:17.395228 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.398479 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:23:17.403719 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:23:17.414562 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:23:17.418397 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:23:17.421163 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:23:17.427346 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m06:23:17.432863 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:23:17.436167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0f38aea-b3f4-47ea-a0e1-9dc674a691c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad6e88940>]}
[0m06:23:17.439392 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2449[0m in 0.20s]
[0m06:23:17.443045 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:23:17.449284 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:17.452064 [debug] [MainThread]: On master: BEGIN
[0m06:23:17.454241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:23:17.462226 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m06:23:17.465919 [debug] [MainThread]: On master: COMMIT
[0m06:23:17.469376 [debug] [MainThread]: Using postgres connection "master"
[0m06:23:17.471535 [debug] [MainThread]: On master: COMMIT
[0m06:23:17.473984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:23:17.475699 [debug] [MainThread]: On master: Close
[0m06:23:17.477642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:23:17.479756 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:23:17.482462 [info ] [MainThread]: 
[0m06:23:17.485015 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m06:23:17.491865 [debug] [MainThread]: Command end result
[0m06:23:17.603838 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:23:17.617174 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:23:17.647658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:23:17.650267 [info ] [MainThread]: 
[0m06:23:17.653575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:23:17.656313 [info ] [MainThread]: 
[0m06:23:17.659519 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:23:17.665703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7723923, "process_in_blocks": "84160", "process_kernel_time": 1.11703, "process_mem_max_rss": "108020", "process_out_blocks": "0", "process_user_time": 11.1703}
[0m06:23:17.669210 [debug] [MainThread]: Command `dbt run` succeeded at 06:23:17.668717 after 5.78 seconds
[0m06:23:17.672209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad9b1f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad7a40fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad7a402b0>]}
[0m06:23:17.674789 [debug] [MainThread]: Flushing usage events
[0m06:23:18.861257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:19:48.755090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52822200d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f528135ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f528135eac0>]}


============================== 06:19:48.763945 | 62a7a2e1-af0f-482b-b67b-dd22b7c94b72 ==============================
[0m06:19:48.763945 [info ] [MainThread]: Running with dbt=1.9.3
[0m06:19:48.765812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt_project/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:19:49.285725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52807c79d0>]}
[0m06:19:49.457969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52813900d0>]}
[0m06:19:49.461608 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:19:49.656090 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m06:19:50.347199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:50.348835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:50.448786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527ff1af10>]}
[0m06:19:50.730446 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:19:50.747038 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:19:50.811601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527ff5b250>]}
[0m06:19:50.813484 [info ] [MainThread]: Found 6 models, 1 source, 433 macros
[0m06:19:50.816390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52806f32e0>]}
[0m06:19:50.824289 [info ] [MainThread]: 
[0m06:19:50.826163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:19:50.827971 [info ] [MainThread]: 
[0m06:19:50.830504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:19:50.847401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m06:19:50.975793 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m06:19:50.977194 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m06:19:50.978396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:51.016420 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m06:19:51.020141 [debug] [ThreadPool]: On list_airflow: Close
[0m06:19:51.026554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_pro_raw_api)
[0m06:19:51.042569 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:19:51.044886 [debug] [ThreadPool]: On list_airflow_pro_raw_api: BEGIN
[0m06:19:51.046578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:51.054430 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m06:19:51.057919 [debug] [ThreadPool]: Using postgres connection "list_airflow_pro_raw_api"
[0m06:19:51.059558 [debug] [ThreadPool]: On list_airflow_pro_raw_api: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "list_airflow_pro_raw_api"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'pro_raw_api'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'pro_raw_api'
  
[0m06:19:51.075359 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.014 seconds
[0m06:19:51.079870 [debug] [ThreadPool]: On list_airflow_pro_raw_api: ROLLBACK
[0m06:19:51.081484 [debug] [ThreadPool]: On list_airflow_pro_raw_api: Close
[0m06:19:51.102897 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:51.108276 [debug] [MainThread]: On master: BEGIN
[0m06:19:51.110175 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:19:51.117182 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m06:19:51.122801 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:51.124637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:19:51.151252 [debug] [MainThread]: SQL status: SELECT 0 in 0.025 seconds
[0m06:19:51.154882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527ff3b640>]}
[0m06:19:51.157751 [debug] [MainThread]: On master: ROLLBACK
[0m06:19:51.159608 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:51.161315 [debug] [MainThread]: On master: BEGIN
[0m06:19:51.163383 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m06:19:51.165101 [debug] [MainThread]: On master: COMMIT
[0m06:19:51.166533 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:51.168167 [debug] [MainThread]: On master: COMMIT
[0m06:19:51.173217 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m06:19:51.175755 [debug] [MainThread]: On master: Close
[0m06:19:51.184480 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_hum
[0m06:19:51.186510 [info ] [Thread-1  ]: 1 of 6 START sql table model pro_raw_api.avg_hum ............................... [RUN]
[0m06:19:51.193804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_pro_raw_api, now model.mi_proyecto_dbt.avg_hum)
[0m06:19:51.196136 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_hum
[0m06:19:51.218855 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.231298 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_hum
[0m06:19:51.353101 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.379521 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.381034 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: BEGIN
[0m06:19:51.382111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:51.390054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m06:19:51.395078 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.396960 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_hum__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(humidity AS INT) AS humidity
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    city,
    date_day AS date,
    AVG(humidity) AS humidity
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:19:51.525909 [debug] [Thread-1  ]: SQL status: SELECT 7820 in 0.127 seconds
[0m06:19:51.562224 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.564215 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum" rename to "avg_hum__dbt_backup"
[0m06:19:51.568235 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:19:51.583816 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.586267 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
alter table "airflow"."pro_raw_api"."avg_hum__dbt_tmp" rename to "avg_hum"
[0m06:19:51.592319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:19:51.651310 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:19:51.653421 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.658732 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: COMMIT
[0m06:19:51.663707 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:19:51.677933 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_hum__dbt_backup"
[0m06:19:51.689007 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_hum"
[0m06:19:51.691991 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_hum"} */
drop table if exists "airflow"."pro_raw_api"."avg_hum__dbt_backup" cascade
[0m06:19:51.698544 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m06:19:51.704030 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_hum: Close
[0m06:19:51.708869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527f3f56d0>]}
[0m06:19:51.710950 [info ] [Thread-1  ]: 1 of 6 OK created sql table model pro_raw_api.avg_hum .......................... [[32mSELECT 7820[0m in 0.51s]
[0m06:19:51.713412 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_hum
[0m06:19:51.715280 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.avg_temp
[0m06:19:51.717314 [info ] [Thread-1  ]: 2 of 6 START sql table model pro_raw_api.avg_temp .............................. [RUN]
[0m06:19:51.719324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_hum, now model.mi_proyecto_dbt.avg_temp)
[0m06:19:51.721156 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.avg_temp
[0m06:19:51.730347 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.740372 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.avg_temp
[0m06:19:51.751313 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.764754 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.766454 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: BEGIN
[0m06:19:51.768648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:51.777543 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m06:19:51.779381 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.781520 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."avg_temp__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date_day,
        CAST(temperature AS FLOAT) AS temperature
    FROM "airflow"."pro_raw_api"."daily_weather" 
)

SELECT
    city,
    date_day AS date,
    AVG(temperature) AS avg_temperature
FROM base
GROUP BY
    city,
    date_day
  );
  
[0m06:19:51.847160 [debug] [Thread-1  ]: SQL status: SELECT 7820 in 0.064 seconds
[0m06:19:51.862214 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.865119 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp" rename to "avg_temp__dbt_backup"
[0m06:19:51.867205 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:51.876693 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.878430 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
alter table "airflow"."pro_raw_api"."avg_temp__dbt_tmp" rename to "avg_temp"
[0m06:19:51.880654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:51.884652 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:19:51.886442 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.888423 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: COMMIT
[0m06:19:51.891864 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:19:51.898618 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."avg_temp__dbt_backup"
[0m06:19:51.900983 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.avg_temp"
[0m06:19:51.902861 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.avg_temp"} */
drop table if exists "airflow"."pro_raw_api"."avg_temp__dbt_backup" cascade
[0m06:19:51.911524 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:19:51.915528 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.avg_temp: Close
[0m06:19:51.923000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52823d8580>]}
[0m06:19:51.926201 [info ] [Thread-1  ]: 2 of 6 OK created sql table model pro_raw_api.avg_temp ......................... [[32mSELECT 7820[0m in 0.20s]
[0m06:19:51.928639 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.avg_temp
[0m06:19:51.930185 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_temp_summer
[0m06:19:51.931720 [info ] [Thread-1  ]: 3 of 6 START sql table model pro_raw_api.max_temp_summer ....................... [RUN]
[0m06:19:51.933638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.avg_temp, now model.mi_proyecto_dbt.max_temp_summer)
[0m06:19:51.935369 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_temp_summer
[0m06:19:51.949983 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:51.960260 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_temp_summer
[0m06:19:52.067576 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:52.086318 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:52.088710 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: BEGIN
[0m06:19:52.090567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:52.096789 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:19:52.099050 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:52.101515 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */

  
    

  create  table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        city,
        CAST(local_time AS DATE) AS date,
        CAST(local_time AS TIMESTAMP) AS ts,
        temperature
    FROM "airflow"."pro_raw_api"."daily_weather"
    WHERE EXTRACT(MONTH FROM CAST(local_time AS TIMESTAMP)) IN (6, 7, 8)
),

ranked AS (
    SELECT
        city,
        date,
        temperature,
        EXTRACT(YEAR FROM ts) AS year,
        ROW_NUMBER() OVER (
            PARTITION BY city, EXTRACT(YEAR FROM ts)
            ORDER BY temperature DESC
        ) AS rn
    FROM base
)

SELECT
    city,
    date,
    temperature
FROM ranked
WHERE rn = 1
ORDER BY city, date
  );
  
[0m06:19:52.183401 [debug] [Thread-1  ]: SQL status: SELECT 20 in 0.078 seconds
[0m06:19:52.191072 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:52.194490 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer" rename to "max_temp_summer__dbt_backup"
[0m06:19:52.197032 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:52.206357 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:52.208516 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
alter table "airflow"."pro_raw_api"."max_temp_summer__dbt_tmp" rename to "max_temp_summer"
[0m06:19:52.212266 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:52.216413 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:19:52.217713 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:52.218860 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: COMMIT
[0m06:19:52.224726 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:19:52.232398 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_temp_summer__dbt_backup"
[0m06:19:52.234751 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_temp_summer"
[0m06:19:52.236516 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_temp_summer"} */
drop table if exists "airflow"."pro_raw_api"."max_temp_summer__dbt_backup" cascade
[0m06:19:52.240937 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:19:52.245050 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_temp_summer: Close
[0m06:19:52.247124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52823d8580>]}
[0m06:19:52.249268 [info ] [Thread-1  ]: 3 of 6 OK created sql table model pro_raw_api.max_temp_summer .................. [[32mSELECT 20[0m in 0.31s]
[0m06:19:52.251193 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_temp_summer
[0m06:19:52.252555 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.max_wind
[0m06:19:52.255277 [info ] [Thread-1  ]: 4 of 6 START sql table model pro_raw_api.max_wind .............................. [RUN]
[0m06:19:52.257324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_temp_summer, now model.mi_proyecto_dbt.max_wind)
[0m06:19:52.258763 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.max_wind
[0m06:19:52.271531 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.281596 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.max_wind
[0m06:19:52.292209 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.301285 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.305371 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: BEGIN
[0m06:19:52.307360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:52.314043 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m06:19:52.315853 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.317259 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */

  
    

  create  table "airflow"."pro_raw_api"."max_wind__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
max_wind AS (
    SELECT city, MAX(wind_kph) AS max_wind
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN max_wind m 
    ON b.city = m.city 
    AND b.wind_kph = m.max_wind
  );
  
[0m06:19:52.356105 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.037 seconds
[0m06:19:52.370923 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.372883 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind" rename to "max_wind__dbt_backup"
[0m06:19:52.375273 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:52.382705 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.384086 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
alter table "airflow"."pro_raw_api"."max_wind__dbt_tmp" rename to "max_wind"
[0m06:19:52.385754 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:52.392024 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:19:52.393293 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.394583 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: COMMIT
[0m06:19:52.397078 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m06:19:52.403711 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."max_wind__dbt_backup"
[0m06:19:52.409542 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.max_wind"
[0m06:19:52.411878 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.max_wind"} */
drop table if exists "airflow"."pro_raw_api"."max_wind__dbt_backup" cascade
[0m06:19:52.442305 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.025 seconds
[0m06:19:52.446822 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.max_wind: Close
[0m06:19:52.448530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52823d8580>]}
[0m06:19:52.460071 [info ] [Thread-1  ]: 4 of 6 OK created sql table model pro_raw_api.max_wind ......................... [[32mSELECT 5[0m in 0.19s]
[0m06:19:52.464125 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.max_wind
[0m06:19:52.465736 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.min_temp
[0m06:19:52.467377 [info ] [Thread-1  ]: 5 of 6 START sql table model pro_raw_api.min_temp .............................. [RUN]
[0m06:19:52.469038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.max_wind, now model.mi_proyecto_dbt.min_temp)
[0m06:19:52.479616 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.min_temp
[0m06:19:52.490077 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.499948 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.min_temp
[0m06:19:52.518286 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.526783 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.528068 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: BEGIN
[0m06:19:52.529438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:52.534806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m06:19:52.536740 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.538884 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */

  
    

  create  table "airflow"."pro_raw_api"."min_temp__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT *
    FROM "airflow"."pro_raw_api"."daily_weather"
),
min_temp AS (
    SELECT city, MIN(temperature) AS min_temp
    FROM base
    GROUP BY city
)

SELECT b.*
FROM base b
JOIN min_temp m 
    ON b.city = m.city 
    AND b.temperature = m.min_temp
  );
  
[0m06:19:52.574535 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0.034 seconds
[0m06:19:52.581099 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.582390 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp" rename to "min_temp__dbt_backup"
[0m06:19:52.584071 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:52.591353 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.592602 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
alter table "airflow"."pro_raw_api"."min_temp__dbt_tmp" rename to "min_temp"
[0m06:19:52.594241 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:52.598274 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:19:52.599977 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.601779 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: COMMIT
[0m06:19:52.605780 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m06:19:52.616274 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."min_temp__dbt_backup"
[0m06:19:52.619064 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.min_temp"
[0m06:19:52.622061 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.min_temp"} */
drop table if exists "airflow"."pro_raw_api"."min_temp__dbt_backup" cascade
[0m06:19:52.626117 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m06:19:52.630264 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.min_temp: Close
[0m06:19:52.633153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52823d8580>]}
[0m06:19:52.635580 [info ] [Thread-1  ]: 5 of 6 OK created sql table model pro_raw_api.min_temp ......................... [[32mSELECT 5[0m in 0.16s]
[0m06:19:52.639430 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.min_temp
[0m06:19:52.641116 [debug] [Thread-1  ]: Began running node model.mi_proyecto_dbt.precip_day
[0m06:19:52.642942 [info ] [Thread-1  ]: 6 of 6 START sql table model pro_raw_api.precip_day ............................ [RUN]
[0m06:19:52.645037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.mi_proyecto_dbt.min_temp, now model.mi_proyecto_dbt.precip_day)
[0m06:19:52.646674 [debug] [Thread-1  ]: Began compiling node model.mi_proyecto_dbt.precip_day
[0m06:19:52.656815 [debug] [Thread-1  ]: Writing injected SQL for node "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.666467 [debug] [Thread-1  ]: Began executing node model.mi_proyecto_dbt.precip_day
[0m06:19:52.680654 [debug] [Thread-1  ]: Writing runtime sql for node "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.690700 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.692782 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: BEGIN
[0m06:19:52.695021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:52.701118 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m06:19:52.703606 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.706118 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */

  
    

  create  table "airflow"."pro_raw_api"."precip_day__dbt_tmp"
  
  
    as
  
  (
    


WITH base AS (
    SELECT
        *
    FROM "airflow"."pro_raw_api"."daily_weather"  
)

SELECT
    *
FROM base
WHERE precip_mm > 0
  );
  
[0m06:19:52.722818 [debug] [Thread-1  ]: SQL status: SELECT 2452 in 0.014 seconds
[0m06:19:52.732209 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.734039 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day" rename to "precip_day__dbt_backup"
[0m06:19:52.736779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:52.748355 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.750163 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
alter table "airflow"."pro_raw_api"."precip_day__dbt_tmp" rename to "precip_day"
[0m06:19:52.752556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:52.757926 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:19:52.759849 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.761685 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: COMMIT
[0m06:19:52.767092 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m06:19:52.775717 [debug] [Thread-1  ]: Applying DROP to: "airflow"."pro_raw_api"."precip_day__dbt_backup"
[0m06:19:52.779835 [debug] [Thread-1  ]: Using postgres connection "model.mi_proyecto_dbt.precip_day"
[0m06:19:52.782260 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "mi_perfil", "target_name": "dev", "node_id": "model.mi_proyecto_dbt.precip_day"} */
drop table if exists "airflow"."pro_raw_api"."precip_day__dbt_backup" cascade
[0m06:19:52.788086 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m06:19:52.793099 [debug] [Thread-1  ]: On model.mi_proyecto_dbt.precip_day: Close
[0m06:19:52.795332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62a7a2e1-af0f-482b-b67b-dd22b7c94b72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527fe5e820>]}
[0m06:19:52.797689 [info ] [Thread-1  ]: 6 of 6 OK created sql table model pro_raw_api.precip_day ....................... [[32mSELECT 2452[0m in 0.15s]
[0m06:19:52.801459 [debug] [Thread-1  ]: Finished running node model.mi_proyecto_dbt.precip_day
[0m06:19:52.808614 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:52.810764 [debug] [MainThread]: On master: BEGIN
[0m06:19:52.812485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:19:52.821864 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m06:19:52.825324 [debug] [MainThread]: On master: COMMIT
[0m06:19:52.826805 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:52.828241 [debug] [MainThread]: On master: COMMIT
[0m06:19:52.830046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:19:52.831569 [debug] [MainThread]: On master: Close
[0m06:19:52.835477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:52.838087 [debug] [MainThread]: Connection 'model.mi_proyecto_dbt.precip_day' was properly closed.
[0m06:19:52.840927 [info ] [MainThread]: 
[0m06:19:52.843843 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m06:19:52.848714 [debug] [MainThread]: Command end result
[0m06:19:52.915935 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt_project/target/manifest.json
[0m06:19:52.927420 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt_project/target/semantic_manifest.json
[0m06:19:52.950252 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt_project/target/run_results.json
[0m06:19:52.951830 [info ] [MainThread]: 
[0m06:19:52.953862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:19:52.956362 [info ] [MainThread]: 
[0m06:19:52.959909 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:19:52.963966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.446718, "process_in_blocks": "84120", "process_kernel_time": 0.588743, "process_mem_max_rss": "108012", "process_out_blocks": "0", "process_user_time": 5.999097}
[0m06:19:52.966079 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:52.965676 after 4.45 seconds
[0m06:19:52.968000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52822200d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527ff14790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f527fec0730>]}
[0m06:19:52.969886 [debug] [MainThread]: Flushing usage events
[0m06:19:53.785904 [debug] [MainThread]: An error was encountered while trying to flush usage events
